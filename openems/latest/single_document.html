<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenEMS - Open Energy Management System :: Open Energy Management System</title>
    <link rel="canonical" href="https://openems.github.io/openems.io/openems/latest/single_document.html">
    <meta name="keywords" content="AsciiDoc">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../_/css/site.css">
<link rel="icon" href="../../_/img/feneco.ico" type="image/x-icon">
<link rel="stylesheet" href="../../_/css/vendor/docsearch.min.css">  </head>
  <body class="article">
<header class="header">
  <nav class="navbar" color="#2d8fab">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://github.com/OpenEMS/openems">OpenEMS // Docs</a>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/OpenEMS/openems">
          <span class="gitlink">
          </span>
        </a>
      </div>
    </div>
  </nav>
</header><div class="main-wrapper">
<div class="navigation-container" data-component="openems" data-version="latest">
  <aside class="navigation">
    <div class="panels">
<div class="navigation-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="introduction.html">Open Energy Management System</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="gettingstarted.html">Getting Started</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="coreconcepts.html">Core concepts &amp; terminology</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">OpenEMS Edge</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="edge/architecture.html">Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="edge/configuration.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="edge/nature.html">Nature</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="edge/scheduler.html">Scheduler</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="edge/controller.html">Controller</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="edge/bridge.html">Bridge</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="edge/device_service.html">Device &amp; Service</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="edge/implement.html">Implementing a Device</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="edge/build.html">Build OpenEMS Edge</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="edge/deploy.html">Deploy OpenEMS Edge</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">OpenEMS UI</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ui/architecture.html">Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ui/build.html">Build OpenEMS UI</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">OpenEMS Backend</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="backend/architecture.html">Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="backend/backend-to-backend.html">Backend-to-Backend</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="backend/build.html">Build OpenEMS Backend</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="backend/deploy.html">Deploy OpenEMS Backend</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="component-communication/index.html">Component Communication</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Simulation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="simulation/realtime.html">Real-Time Simulation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="simulation/ui-history.html">UI History Simulation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="documentation.html">Documentation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="randd.html">Research and Development</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://openems.github.io/openems.io/javadoc/">Javadoc</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="navigation-explore" data-panel="explore">
  <div class="context">
    <span class="title">Open Energy Management System</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Open Energy Management System</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="introduction.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
  <main class="main">
<div class="toolbar" role="navigation">
  <button class="navigation-toggle"></button>
  <a href="introduction.html" class="home-link"></a>
<nav class="crumbs" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="introduction.html">Open Energy Management System</a></li>
    <li class="crumb"><a href="single_document.html">OpenEMS - Open Energy Management System</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/OpenEMS/openems/tree/develop/doc/modules/ROOT/pages/single_document.adoc">Edit this Page</a></div>
</div>
<article class="doc">
<h1>OpenEMS - Open Energy Management System</h1>
<div id="toc" class="toc">
<div id="toctitle">Inhalt</div>
<ul class="sectlevel1">
<li><a href="#_introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#_open_energy_management_system">1.1. Open Energy Management System</a></li>
<li><a href="#_openems_iot_stack">1.2. OpenEMS IoT stack</a></li>
<li><a href="#_features">1.3. Features</a></li>
<li><a href="#_openems_ui_screenshots">1.4. OpenEMS UI Screenshots</a></li>
<li><a href="#_system_architecture">1.5. System architecture</a></li>
<li><a href="#_development_guidelines">1.6. Development guidelines</a></li>
<li><a href="#_open_source_philosophy">1.7. Open Source philosophy</a></li>
<li><a href="#_license">1.8. License</a></li>
</ul>
</li>
<li><a href="#_getting_started">2. Getting Started</a>
<ul class="sectlevel2">
<li><a href="#_download_the_source_code">2.1. Download the source code</a></li>
<li><a href="#_setup_eclipse_ide_for_openems_edge_and_backend">2.2. Setup Eclipse IDE for OpenEMS Edge and Backend</a></li>
<li><a href="#_run_openems_edge_and_start_simulator">2.3. Run OpenEMS Edge and start Simulator</a></li>
<li><a href="#_setup_visual_studio_code_for_openems_ui">2.4. Setup Visual Studio Code for OpenEMS UI</a></li>
<li><a href="#_run_openems_ui">2.5. Run OpenEMS UI</a></li>
<li><a href="#_integrate_openems_backend">2.6. Integrate OpenEMS Backend</a></li>
<li><a href="#_next_steps">2.7. Next steps</a></li>
</ul>
</li>
<li><a href="#_core_concepts_terminology">3. Core concepts &amp; terminology</a>
<ul class="sectlevel2">
<li><a href="#_osgi_bundle">3.1. OSGi Bundle</a></li>
<li><a href="#_openems_component">3.2. OpenEMS Component</a></li>
<li><a href="#_channel">3.3. Channel</a></li>
<li><a href="#_nature">3.4. Nature</a></li>
<li><a href="#_channel_address">3.5. Channel Address</a></li>
<li><a href="#_scheduler">3.6. Scheduler</a></li>
<li><a href="#_controller">3.7. Controller</a></li>
</ul>
</li>
<li><a href="#_openems_edge">4. OpenEMS Edge</a>
<ul class="sectlevel2">
<li><a href="#_edge_architecture">4.1. Edge Architecture</a></li>
<li><a href="#_configuration">4.2. Configuration</a></li>
<li><a href="#_nature_2">4.3. Nature</a></li>
<li><a href="#_scheduler_4">4.4. Scheduler</a></li>
<li><a href="#_controller_4">4.5. Controller</a></li>
<li><a href="#_bridge">4.6. Bridge</a></li>
<li><a href="#_controller_5">4.7. Controller</a></li>
<li><a href="#_implementing_a_device">4.8. Implementing a device</a></li>
<li><a href="#_build_openems_edge">4.9. Build OpenEMS Edge</a></li>
<li><a href="#_deploy_openems_edge">4.10. Deploy OpenEMS Edge</a></li>
</ul>
</li>
<li><a href="#_openems_ui">5. OpenEMS UI</a>
<ul class="sectlevel2">
<li><a href="#_ui_architecture">5.1. UI Architecture</a></li>
<li><a href="#_build_openems_ui">5.2. Build OpenEMS UI</a></li>
</ul>
</li>
<li><a href="#_openems_backend">6. OpenEMS Backend</a>
<ul class="sectlevel2">
<li><a href="#_backend_architecture">6.1. Backend Architecture</a></li>
<li><a href="#_backend_to_backend_communication">6.2. Backend-to-Backend communication</a></li>
<li><a href="#_build_openems_backend">6.3. Build OpenEMS Backend</a></li>
<li><a href="#_deploy_openems_backend">6.4. Deploy OpenEMS Backend</a></li>
</ul>
</li>
<li><a href="#_internal_component_communication">7. Internal Component Communication</a>
<ul class="sectlevel2">
<li><a href="#_json_rpc_introduction">7.1. JSON-RPC introduction</a></li>
<li><a href="#_example_communication_messages">7.2. Example communication messages</a></li>
<li><a href="#_communication_schema">7.3. Communication schema</a></li>
</ul>
</li>
<li><a href="#_real_time_simulation">8. Real-Time Simulation</a>
<ul class="sectlevel2">
<li><a href="#_types_of_simulated_components">8.1. Types of Simulated Components</a></li>
<li><a href="#_simulator_components">8.2. Simulator Components</a></li>
<li><a href="#_possible_combinations">8.3. Possible Combinations</a></li>
</ul>
</li>
<li><a href="#_ui_history_simulation">9. UI History Simulation</a></li>
<li><a href="#_documentation">10. Documentation</a>
<ul class="sectlevel2">
<li><a href="#_concept">10.1. Concept</a></li>
<li><a href="#_edit_a_page">10.2. Edit a page</a></li>
<li><a href="#_add_a_page">10.3. Add a page</a></li>
<li><a href="#_build_docs">10.4. Build Docs</a></li>
</ul>
</li>
<li><a href="#_research_and_development">11. Research and Development</a>
<ul class="sectlevel2">
<li><a href="#_easy_res">11.1. EASY-RES</a></li>
<li><a href="#_emsig">11.2. EMSIG</a></li>
<li><a href="#_blogpv">11.3. BloGPV</a></li>
<li><a href="#_memap">11.4. MEMAP</a></li>
</ul>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a>1. Introduction</h2>
<div class="sectionbody">
<div class="imageblock text-left">
<div class="content">
<img src="_images/OpenEMS-Logo.png" alt="the Feneco - OpenEMS Logo" width="400">
</div>
</div>
<div class="sect2">
<h3 id="_open_energy_management_system"><a class="anchor" href="#_open_energy_management_system"></a>1.1. Open Energy Management System</h3>
<div class="paragraph">
<p>OpenEMS&#8201;&#8212;&#8201;the Open Source Energy Management System&#8201;&#8212;&#8201;is a modular platform for energy management applications. It was developed around the requirements of monitoring, controlling, and integrating energy storage together with renewable energy sources and complementary devices and services like electric vehicle charging stations, heat-pumps, electrolysers, time-of-use electricity tariffs and more.</p>
</div>
<div class="paragraph">
<p>If you plan to use OpenEMS for your own projects, please consider joining the <a href="https://openems.io/association">OpenEMS Association e.V. <span class="icon"><i class="fa fa-external-link"></i></span></a>, a network of universities, hardware manufacturers, software companies as well as commercial and private owners, and get in touch in the <a href="https://community.openems.io">OpenEMS Community forum <span class="icon"><i class="fa fa-external-link"></i></span></a>.</p>
</div>
<div class="sect3">
<h4 id="_openems_in_local_energy_management"><a class="anchor" href="#_openems_in_local_energy_management"></a>1.1.1. OpenEMS in »Local Energy Management«</h4>
<div class="imageblock">
<div class="content">
<img src="_images/local-energy-management.png" alt="Local Energy Management">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_openems_in_areal_energy_management"><a class="anchor" href="#_openems_in_areal_energy_management"></a>1.1.2. OpenEMS in »Areal Energy Management«</h4>
<div class="imageblock">
<div class="content">
<img src="_images/areal-energy-management.png" alt="Areal Energy Management">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_openems_iot_stack"><a class="anchor" href="#_openems_iot_stack"></a>1.2. OpenEMS IoT stack</h3>
<div class="paragraph">
<p>The OpenEMS 'Internet of Things' stack contains three main components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>OpenEMS Edge</strong> runs on site, communicates with devices and services, collects data and executes control algorithms</p>
</li>
<li>
<p><strong>OpenEMS UI</strong> is the real-time user interface for web browsers and smartphones</p>
</li>
<li>
<p><strong>OpenEMS Backend</strong> runs on a (cloud) server, connects the decentralized Edge systems and provides aggregation, monitoring and control via internet</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_features"><a class="anchor" href="#_features"></a>1.3. Features</h3>
<div class="paragraph">
<p>The OpenEMS software architecture was designed to leverage some features that are required by a modern and flexible Energy Management System:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Fast, PLC-like control of devices</p>
</li>
<li>
<p>Easily extendable due to the use of modern programming languages and modular architecture</p>
</li>
<li>
<p>Reusable, device independent control algorithms due to clear device abstraction</p>
</li>
<li>
<p>Wide range of supported devices and protocols</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_openems_ui_screenshots"><a class="anchor" href="#_openems_ui_screenshots"></a>1.4. OpenEMS UI Screenshots</h3>
<div class="imageblock">
<div class="content">
<img src="_images/ui-live.png" alt="OpenEMS UI Live View">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/ui-history.png" alt="OpenEMS UI History View">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_system_architecture"><a class="anchor" href="#_system_architecture"></a>1.5. System architecture</h3>
<div class="paragraph">
<p>OpenEMS is generally used in combination with external hardware and software components
(the exception is a simulated development environment - see <a href="gettingstarted.html" class="page">Getting Started</a>).
As a brief overview, this is how OpenEMS is used in production setups:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/system-architecture.png" alt="OpenEMS system architecture">
</div>
<div class="title">Figure 1. OpenEMS system architecture</div>
</div>
</div>
<div class="sect2">
<h3 id="_development_guidelines"><a class="anchor" href="#_development_guidelines"></a>1.6. Development guidelines</h3>
<div class="paragraph">
<p>Development follows the <a href="https://de.wikipedia.org/wiki/Agile_Softwareentwicklung">Agile Manifesto <span class="icon"><i class="fa fa-external-link"></i></span></a> and is driven by the <a href="https://de.wikipedia.org/wiki/Scrum">Scrum <span class="icon"><i class="fa fa-external-link"></i></span></a> methodology.
The source code is available online at <a href="https://openems.io">openems.io</a> and on <a href="https://github.com/OpenEMS/openems">GitHub <span class="icon"><i class="fa fa-github"></i></span></a>.
New versions are released after every Scrum Sprint and <a href="https://github.com/OpenEMS/openems/releases">tagged <span class="icon"><i class="fa fa-github"></i></span></a> accordingly.
Version numbers are built using the pattern <code>year.number of sprint</code>, e.g. version <code>2020.14.0</code> is the result of the 14th sprint in 2020.
Git development follows the <a href="https://www.atlassian.com/git/tutorials/comparing-workflows/gitflow-workflow">Gitflow Workflow</a>, so the <a href="https://github.com/OpenEMS/openems/tree/master/">master branch <span class="icon"><i class="fa fa-github"></i></span></a> always holds the stable release, while active development is happening on the <a href="https://github.com/OpenEMS/openems/tree/develop">develop branch <span class="icon"><i class="fa fa-github"></i></span></a> or in separate feature branches.</p>
</div>
<div class="paragraph">
<p>For Edge and Backend Java development we recommend the <a href="https://www.eclipse.org/ide/">Eclipse IDE <span class="icon"><i class="fa fa-external-link"></i></span></a>.
For the UI (TypeScript + Angular.io) we recommend <a href="https://code.visualstudio.com/">Visual Studio Code <span class="icon"><i class="fa fa-external-link"></i></span></a>.
The documentation is generated using <a href="http://asciidoc.org">AsciiDoc <span class="icon"><i class="fa fa-external-link"></i></span></a>.
For handling git we recommend <a href="https://www.sourcetreeapp.com/">Sourcetree by Atlassian <span class="icon"><i class="fa fa-external-link"></i></span></a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_open_source_philosophy"><a class="anchor" href="#_open_source_philosophy"></a>1.7. Open Source philosophy</h3>
<div class="paragraph">
<p>The OpenEMS project is driven by the <a href="https://openems.io/association">OpenEMS Association e.V.</a>, a network of users, vendors and scientific institutions from all kinds of areas like hardware manufacturers, software companies, grid operators and more. They share the common target of developing a free and open-source platform for energy management, that supports the 100 % energy transition.</p>
</div>
<div class="paragraph">
<p>We are inviting third parties to use OpenEMS for their own projects and are glad to support them with their first steps. In any case if you are interested in OpenEMS we would be glad to hear from you in the <a href="https://community.openems.io">OpenEMS Community forum</a>.</p>
</div>
<div class="paragraph">
<p>OpenEMS development was started by <a href="https://www.fenecon.de">FENECON GmbH</a>, a German company specialized in manufacturing and project development of energy storage systems. It is the software stack behind <a href="https://fenecon.de/page/fems">FEMS - FENECON Energy Management System</a> and widely used in private, commercial and industrial applications.</p>
</div>
<div class="paragraph">
<p>OpenEMS is funded by several federal and EU funding projects. If you are a developer and you would like to get hired by one of the partner companies or universities for working on OpenEMS, please send your motivation letter to <a href="mailto:info@openems.io">info@openems.io</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_license"><a class="anchor" href="#_license"></a>1.8. License</h3>
<div class="ulist">
<ul>
<li>
<p>OpenEMS Edge</p>
</li>
<li>
<p>OpenEMS Backend</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Copyright &#169; 2016-2021 OpenEMS Association e.V., FENECON GmbH.</p>
</div>
<div class="paragraph">
<p>This product includes software developed at FENECON GmbH: you can
redistribute it and/or modify it under the terms of the <a href="https://github.com/OpenEMS/openems/blob/develop/LICENSE-EPL-2.0">Eclipse Public License version 2.0</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>OpenEMS UI</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Copyright &#169; 2016-2021 OpenEMS Association e.V., FENECON GmbH.</p>
</div>
<div class="paragraph">
<p>This product includes software developed at FENECON GmbH: you can
redistribute it and/or modify it under the terms of the <a href="https://github.com/OpenEMS/openems/blob/develop/LICENSE-AGPL-3.0">GNU Affero General Public License version 3</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started"><a class="anchor" href="#_getting_started"></a>2. Getting Started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This quick 'Getting Started' should help you setup a complete development environment. On finishing you will have a working instance of OpenEMS Edge, with simulated energy storage and photovoltaic system, as well as an OpenEMS UI for monitoring the simulator inside your web browser. Finally an instance of OpenEMS Backend is added to simulate a cloud backend that connects UI and Edge.</p>
</div>
<div class="sect2">
<h3 id="_download_the_source_code"><a class="anchor" href="#_download_the_source_code"></a>2.1. Download the source code</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download any <a href="https://git-scm.com">git client <span class="icon"><i class="fa fa-external-link"></i></span></a> and install it. Our recommendation is <a href="https://www.sourcetreeapp.com/">Sourcetree by Atlassian <span class="icon"><i class="fa fa-external-link"></i></span></a></p>
</li>
<li>
<p>Clone the OpenEMS git repository</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In Sourcetree:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>press <b class="button">File</b> &#8594; <b class="button">Clone</b></p>
</li>
<li>
<p>enter the git repository path <code><a href="https://github.com/OpenEMS/openems.git" class="bare">https://github.com/OpenEMS/openems.git</a></code></p>
</li>
<li>
<p>select a target directory, for example <code>C:\Users\your.user\git\openems</code></p>
</li>
<li>
<p>open <b class="button">Advanced Settings</b></p>
</li>
<li>
<p>select the branch <b class="button">develop</b></p>
</li>
<li>
<p>and press <b class="button">Clone</b>.</p>
<div class="imageblock">
<div class="content">
<img src="_images/sourcetree.png" alt="Cloning the git repository using Sourcetree">
</div>
<div class="title">Figure 2. Cloning the git repository using Sourcetree</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Alternatively: with the git command line utility</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>open a console</p>
</li>
<li>
<p>change to the target directory</p>
</li>
<li>
<p>execute <code>git clone <a href="https://github.com/OpenEMS/openems.git" class="bare">https://github.com/OpenEMS/openems.git</a> --branch develop</code></p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Git is downloading the complete source code for you.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_setup_eclipse_ide_for_openems_edge_and_backend"><a class="anchor" href="#_setup_eclipse_ide_for_openems_edge_and_backend"></a>2.2. Setup Eclipse IDE for OpenEMS Edge and Backend</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Prepare Eclipse IDE</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Download <a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html">Java SE Development Kit 8 <span class="icon"><i class="fa fa-external-link"></i></span></a> and install it</p>
</li>
<li>
<p>Download <a href="https://www.eclipse.org">Eclipse for Java <span class="icon"><i class="fa fa-external-link"></i></span></a>, install and start it</p>
</li>
<li>
<p>On first start you will get asked to create a workspace.
Select a directory - for example <code>C:\Users\your.user\git\openems-workspace</code> - and press <b class="button">Launch</b>. <em>The directory needs to be different from your source code directory selected above.</em></p>
<div class="imageblock">
<div class="content">
<img src="_images/eclipse-workspace.png" alt="Creating a workspace in Eclipse IDE">
</div>
<div class="title">Figure 3. Creating a workspace in Eclipse IDE</div>
</div>
</li>
<li>
<p>Install <a href="http://bndtools.org">BndTools <span class="icon"><i class="fa fa-external-link"></i></span></a> in Eclipse:</p>
<div class="paragraph">
<p>Menu: <b class="button">Help</b> →  <b class="button">Eclipse Marketplace&#8230;&#8203;</b> → <b class="button">Find:</b> → enter <b class="button">Bndtools</b> → press <b class="button">Install</b></p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Import OpenEMS component projects (OSGi bundles):</p>
<div class="paragraph">
<p>Menu: <b class="button">File</b> →  <b class="button">Import&#8230;&#8203;</b> → <b class="button">Bndtools</b> → <b class="button">Existing Bnd Workspace</b> → Root directory: <b class="button">Browse&#8230;&#8203;</b> → select the directory with the source code - for example <code>C:\Users\your.user\git\openems</code> → <b class="button">OK</b> → <b class="button">Finish</b> → "Switch to Bndtools perspective?" <b class="button">yes</b></p>
</div>
</li>
<li>
<p>Eclipse should have successfully built OpenEMS Edge and Backend, showing no entry in Problems.</p>
<div class="imageblock">
<div class="content">
<img src="_images/eclipse-no-problems.png" alt="Eclipse IDE showing 'no problems'">
</div>
<div class="title">Figure 4. Eclipse IDE showing 'no problems'</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_run_openems_edge_and_start_simulator"><a class="anchor" href="#_run_openems_edge_and_start_simulator"></a>2.3. Run OpenEMS Edge and start Simulator</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run OpenEMS Edge</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In Eclipse IDE open the project <b class="button">io.openems.edge.application</b> and double click on <b class="button">EdgeApp.bndrun</b>.</p>
<div class="imageblock">
<div class="content">
<img src="_images/eclipse-io.openems.edge.application.png" alt="io.openems.edge.application project in Eclipse IDE">
</div>
<div class="title">Figure 5. io.openems.edge.application project in Eclipse IDE</div>
</div>
</li>
<li>
<p>Click on <b class="button">Run OSGi</b> to run OpenEMS Edge. You should see log outputs on the console inside Eclipse IDE.</p>
<div class="imageblock">
<div class="content">
<img src="_images/eclipse-edge-initial-log-output.png" alt="OpenEMS Edge initial log output">
</div>
<div class="title">Figure 6. OpenEMS Edge initial log output</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Configure and start the Simulator</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Open the <a href="http://localhost:8080/system/console/configMgr">Apache Felix Web Console Configuration <span class="icon"><i class="fa fa-external-link"></i></span></a>.</p>
<div class="paragraph">
<p>Login with username <strong>admin</strong> and password <strong>admin</strong>.</p>
</div>
<div class="paragraph">
<p>Note: <strong>Apache Felix Web Console Configuration</strong> only works with a running console, otherwise you will receive an <strong>error message</strong> on your Browser.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/apache-felix-console-configuration.png" alt="Apache Felix Web Console Configuration">
</div>
<div class="title">Figure 7. Apache Felix Web Console Configuration</div>
</div>
</li>
<li>
<p>Configure a Scheduler</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The Scheduler is responsible for executing the control algorithms (Controllers) and defines the OpenEMS Edge application cycle
</td>
</tr>
</table>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Click on "Scheduler All Alphabetically"</p>
<div class="imageblock">
<div class="content">
<img src="_images/config-scheduler-all-alphabetically.png" alt="Configuration of All Alphabetically Scheduler">
</div>
<div class="title">Figure 8. Configuration of All Alphabetically Scheduler</div>
</div>
</li>
<li>
<p>Accept the default values and click <b class="button">Save</b></p>
</li>
<li>
<p>You created your first instance of an OpenEMS Component with ID "scheduler0". The log shows:</p>
<div class="paragraph">
<p><code>INFO  [onent.AbstractOpenemsComponent] [scheduler0] Activate AllAlphabetically [edge.scheduler.allalphabetically]</code></p>
</div>
<div class="paragraph">
<p>Add any other OpenEMS Components in the same way:</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Configure debug outputs on the console: "Controller Debug Log". The default values can be accepted without changes.</p>
<div class="imageblock">
<div class="content">
<img src="_images/config-controller-debug-log.png" alt="Configuration of Controller Debug Log">
</div>
<div class="title">Figure 9. Configuration of Controller Debug Log</div>
</div>
<div class="paragraph">
<p>The log shows:</p>
</div>
<div class="paragraph">
<p><code>INFO  [onent.AbstractOpenemsComponent] [ctrlDebugLog0] Activate DebugLog [edge.controller.debuglog]</code>,</p>
</div>
<div class="paragraph">
<p>followed once per second by</p>
</div>
<div class="paragraph">
<p><code>INFO  [e.controller.debuglog.DebugLog] [ctrlDebugLog0] _sum[Ess SoC:0 %|L:0 W Grid L:0 W Production L:0 W Consumption L:0 W]</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It is once per second because you accepted the default value of "1000 ms" for "Cycle time" in the Scheduler configuration.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Configure the standard-load-profile datasource using the according input file in the csv-reader: "Simulator DataSource: CSV Predefined". Select "H0_HOUSEHOLD_SUMMER_WEEKDAY_STANDARD_LOAD_PROFILE" as the "Source".</p>
<div class="imageblock">
<div class="content">
<img src="_images/config-simulator-datasource-standard-load-profile.png" alt="Configuration of Simulator DataSource: CSV Predefined as standard load profile datasource">
</div>
<div class="title">Figure 10. Configuration of Simulator DataSource: CSV Predefined as standard load profile datasource</div>
</div>
<div class="paragraph">
<p>The log shows:</p>
</div>
<div class="paragraph">
<p><code>INFO  [onent.AbstractOpenemsComponent] [datasource0] Activate CsvDatasourcePredefined [edge.simulator.datasource.csv]</code>,</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The data source was configured with the OpenEMS Component ID "datasource0" which will be used in the next step as reference.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Configure a simulated grid meter: "Simulator GridMeter Acting". Configure the Datasource-ID "datasource0" to refer to the data source configured above.</p>
<div class="imageblock">
<div class="content">
<img src="_images/config-simulator-grid-meter-acting.png" alt="Configuration of Simulator GridMeter Acting">
</div>
<div class="title">Figure 11. Configuration of Simulator GridMeter Acting</div>
</div>
<div class="paragraph">
<p>This time some more logs will show up. Most importantly they show, that the Grid meter now shows a power value.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>INFO  [onent.AbstractOpenemsComponent] [meter0] Activate GridMeter [edge.simulator.meter.grid.acting]
[onent.AbstractOpenemsComponent] [meter0] Deactivate GridMeter [edge.simulator.meter.grid.acting]
[onent.AbstractOpenemsComponent] [meter0] Activate GridMeter [edge.simulator.meter.grid.acting]
[e.controller.debuglog.DebugLog] [ctrlDebugLog0] _sum[Ess SoC:0 %|L:0 W Grid L:1423 W Production L:0 W Consumption L:1423 W] meter0[1423 W]</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This setup causes the simulated grid-meter to take the standardized load-profiles data as input parameter.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
'Acting' refers to the fact, that this meter actively provides data - in opposite to a 'Reacting' device that is reacting on other components: for example the 'Simulator.EssSymmetric.Reacting' configured below.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Configure a simulated reacting energy storage system: "Simulator EssSymmetric Reacting". The default values can be accepted without changes. (If you choose an other setup as the one described here you may have to create a new Datasource-Component and provide its ID here. The actual data is ignored, but the Datasource&#8217;s Time-Delta value is required to calculate values with time-dependant units.)</p>
<div class="imageblock">
<div class="content">
<img src="_images/config-simulator-esssymmetric-reacting.png" alt="Configuration of Simulator EssSymmetric Reacting">
</div>
<div class="title">Figure 12. Configuration of Simulator EssSymmetric Reacting</div>
</div>
<div class="paragraph">
<p>The log shows:</p>
</div>
<div class="paragraph">
<p><code>INFO  [e.controller.debuglog.DebugLog] [ctrlDebugLog0] _sum[Ess SoC:50 %|L:0 W Grid L:864 W Production L:0 W Consumption L:864 W] ess0[SoC:50 %|L:0 W|OnGrid] meter0[864 W]</code></p>
</div>
<div class="paragraph">
<p>Note, that the DebugLog now shows data for the battery, but the charge/discharge power stays at "0 W" and the state of charge stays at "50 %" as configured. Next step is to configure a control algorithm that tells the battery to charge or discharge.</p>
</div>
</li>
<li>
<p>Configure the self-consumption optimization algorithm: "Controller Balancing Symmetric". Configure the Ess-ID "ess0" and Grid-Meter-ID "meter0" to refer to the components configured above.</p>
<div class="imageblock">
<div class="content">
<img src="_images/config-controller-balancing-symmetric.png" alt="Configuration of Symmetric Balancing Controller">
</div>
<div class="title">Figure 13. Configuration of Symmetric Balancing Controller</div>
</div>
<div class="paragraph">
<p>The log shows:</p>
</div>
<div class="paragraph">
<p><code>INFO  [e.controller.debuglog.DebugLog] [ctrlDebugLog0] _sum[Ess SoC:49 %|L:1167 W Grid L:-39 W Production L:0 W Consumption L:1128 W] ess0[SoC:49 %|L:1167 W|OnGrid] meter0[-39 W]</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Note, how the Controller now tells the battery to discharge (<code>Ess SoC:49 %|L:1167 W</code>), trying to balance the Grid power to "0 W" (<code>Grid L:-39 W</code>):
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Configure the websocket Api Controller: "Controller Api Websocket". The default values can be accepted without changes.</p>
<div class="imageblock">
<div class="content">
<img src="_images/config-controller-api-websocket.png" alt="Configuration of Controller Api Websocket">
</div>
<div class="title">Figure 14. Configuration of Controller Api Websocket</div>
</div>
<div class="paragraph">
<p>The log shows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>INFO  [onent.AbstractOpenemsComponent] [ctrlApiWebsocket0] Activate WebsocketApi [edge.controller.api.websocket]
INFO  [ler.api.websocket.WebsocketApi] [ctrlApiWebsocket0] Websocket-Api started on port [8085].</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The Controller Api Websocket is required to enable access to OpenEMS Edge by a local OpenEMS UI.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_setup_visual_studio_code_for_openems_ui"><a class="anchor" href="#_setup_visual_studio_code_for_openems_ui"></a>2.4. Setup Visual Studio Code for OpenEMS UI</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download <a href="https://nodejs.org">node.js LTS <span class="icon"><i class="fa fa-external-link"></i></span></a> and install it.</p>
</li>
<li>
<p>Download <a href="https://code.visualstudio.com/">Visual Studio Code <span class="icon"><i class="fa fa-external-link"></i></span></a>, install and start it.</p>
</li>
<li>
<p>Open OpenEMS UI source code in Visual Studio Code:</p>
<div class="paragraph">
<p>Menu: <b class="button">File</b> → <b class="button">Open Folder&#8230;&#8203;</b> → Select the <code>ui</code> directory inside the downloaded source code (for example <code>C:\Users\your.user\git\openems\ui</code>) → <b class="button">Select directory</b></p>
</div>
</li>
<li>
<p>Open the integrated terminal:</p>
<div class="paragraph">
<p>Menu: <b class="button">Terminal</b> → <b class="button">New Terminal</b></p>
</div>
</li>
<li>
<p>Install <a href="https://cli.angular.io/">Angular CLI <span class="icon"><i class="fa fa-external-link"></i></span></a>:</p>
<div class="paragraph">
<p><code>npm install -g @angular/cli</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you receive an error message that the command <code>npm</code> could not be found, make sure that node.js is installed and restart Visual Studio Code.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Resolve and download dependencies:</p>
<div class="paragraph">
<p><code>npm install</code></p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_run_openems_ui"><a class="anchor" href="#_run_openems_ui"></a>2.5. Run OpenEMS UI</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In Visual Studios integrated terminal type&#8230;&#8203;</p>
<div class="paragraph">
<p><code>ng serve</code></p>
</div>
<div class="paragraph">
<p>The log shows:</p>
</div>
<div class="paragraph">
<p><code>NG Live Development Server is listening on localhost:4200, open your browser on <a href="http://localhost:4200/" class="bare">http://localhost:4200/</a></code></p>
</div>
</li>
<li>
<p>Open a browser at <a href="http://localhost:4200" class="bare">http://localhost:4200</a></p>
</li>
<li>
<p>You should see OpenEMS UI. Log in as user "guest" by clicking on the tick mark. Alternatively type "admin" in the password field to log in with extended permissions.</p>
<div class="imageblock">
<div class="content">
<img src="_images/openems-ui-login.png" alt="OpenEMS UI Login screen">
</div>
<div class="title">Figure 15. OpenEMS UI Login screen</div>
</div>
</li>
<li>
<p>Change to the Energymonitor by clicking on the arrow.</p>
<div class="imageblock">
<div class="content">
<img src="_images/openems-ui-overview.png" alt="OpenEMS UI Overview screen">
</div>
<div class="title">Figure 16. OpenEMS UI Overview screen</div>
</div>
</li>
<li>
<p>You should see the Energymonitor showing the same data as the DebugLog output on the console.</p>
<div class="imageblock">
<div class="content">
<img src="_images/openems-ui-edge-overview.png" alt="OpenEMS UI Energymonitor screen">
</div>
<div class="title">Figure 17. OpenEMS UI Energymonitor screen</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
OpenEMS UI will complain that "no timedata source is available". Because of this the historic chart is not yet functional.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_integrate_openems_backend"><a class="anchor" href="#_integrate_openems_backend"></a>2.6. Integrate OpenEMS Backend</h3>
<div class="paragraph">
<p>Instead of having Edge and UI talk to each other directly, the communication can also be proxied via Backend.</p>
</div>
<div class="sect3">
<h4 id="_run_and_configure_openems_backend"><a class="anchor" href="#_run_and_configure_openems_backend"></a>2.6.1. Run and configure OpenEMS Backend</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In Eclipse IDE open the project <b class="button">io.openems.backend.application</b> and double click on <b class="button">BackendApp.bndrun</b>.</p>
<div class="imageblock">
<div class="content">
<img src="_images/eclipse-io.openems.backend.application.png" alt="io.openems.backend.application project in Eclipse IDE">
</div>
<div class="title">Figure 18. io.openems.backend.application project in Eclipse IDE</div>
</div>
</li>
<li>
<p>Click on <b class="button">Run OSGi</b> to run OpenEMS Backend. You should see log outputs on the console inside Eclipse IDE.</p>
<div class="imageblock">
<div class="content">
<img src="_images/eclipse-backend-initial-log-output.png" alt="OpenEMS Backend initial log output">
</div>
<div class="title">Figure 19. OpenEMS Backend initial log output</div>
</div>
</li>
<li>
<p>Configure the Backend</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Open the <a href="http://localhost:8079/system/console/configMgr">Apache Felix Web Console Configuration <span class="icon"><i class="fa fa-external-link"></i></span></a>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Apache Felix Web Console for OpenEMS Backend is started on port 8079 by default. This is configured using the <code>org.osgi.service.http.port</code> setting in BackendApp.bndrun.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Login with username <strong>admin</strong> and password <strong>admin</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/apache-felix-console-backend-configuration.png" alt="Apache Felix Web Console Configuration for OpenEMS Backend">
</div>
<div class="title">Figure 20. Apache Felix Web Console Configuration for OpenEMS Backend</div>
</div>
</li>
<li>
<p>Configure Edge.Websocket</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <strong>Edge.Websocket</strong> service is responsible for the communication between OpenEMS Backend and OpenEMS Edge.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the example we are configuring the Port 8081. This port needs to match with what we configure later in OpenEMS Edge.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/config-backend-edge.websocket.png" alt="Configuration of Backend Edge.Websocket">
</div>
<div class="title">Figure 21. Configuration of Backend Edge.Websocket</div>
</div>
</li>
<li>
<p>Configure Ui.Websocket</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <strong>Ui.Websocket</strong> service is responsible for the communication between OpenEMS Backend and OpenEMS UI.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the example we are configuring the Port 8082. This port needs to match with what we configure later in the OpenEMS UI environment file.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/config-backend-ui.websocket.png" alt="Configuration of Backend Ui.Websocket">
</div>
<div class="title">Figure 22. Configuration of Backend Ui.Websocket</div>
</div>
</li>
<li>
<p>Configure Timedata</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <strong>Timedata</strong> service provider is responsible for holding the current and historic data of each connected Edge device.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the example we are configuring the <strong>Timedata.Dummy</strong> service. It takes no configuration parameters, so just press <b class="button">Save</b>. In a production system you would want to use a real implementation like <strong>Timedata.InfluxDB</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/config-backend-timedata.dummy.png" alt="Configuration of Backend Timedata.Dummy">
</div>
<div class="title">Figure 23. Configuration of Backend Timedata.Dummy</div>
</div>
</li>
<li>
<p>Configure Metadata</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <strong>Metadata</strong> service provider is responsible for authentication of Edge devices and Users connecting via UI.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the example we are configuring the <strong>Metadata.Dummy</strong> service. It takes no configuration parameters, so just press <b class="button">Save</b>. In a production system you would want to use a real implementation like <strong>Metadata.File</strong> or <strong>Metadata.Odoo</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/config-backend-metadata.dummy.png" alt="Configuration of Backend Metadata.Dummy">
</div>
<div class="title">Figure 24. Configuration of Backend Metadata.Dummy</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_configure_openems_edge"><a class="anchor" href="#_configure_openems_edge"></a>2.6.2. Configure OpenEMS Edge</h4>
<div class="paragraph">
<p>Next we will configure OpenEMS Edge to connect to the OpenEMS Backend <code>Edge.Websocket</code> service.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Switch back to the <a href="http://localhost:8080/system/console/configMgr">Apache Felix Web Console Configuration for OpenEMS Edge <span class="icon"><i class="fa fa-external-link"></i></span></a>.</p>
</li>
<li>
<p>Configure the "Controller Api Backend" Component. The default values can be accepted without changes right now.</p>
<div class="imageblock">
<div class="content">
<img src="_images/config-controller-api-backend.png" alt="Configuration of Controller Api Backend">
</div>
<div class="title">Figure 25. Configuration of Controller Api Backend</div>
</div>
<div class="paragraph">
<p>Some configuration parameters are still noteworthy here:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>"Apikey" is used to authenticate this Edge at the Backend Metadata service.</p>
</li>
<li>
<p>"Uri" is set to <code>ws://localhost:8081</code>. This defines an unencrypted websocket ("ws://") connection to the local computer on port "8081" like we configured before for the Edge.Websocket.</p>
</li>
<li>
<p>"Cycle Time" defines how often data is sent to Backend</p>
<div class="paragraph">
<p>Once you press <b class="button">save</b> you should see logs in OpenEMS Backend</p>
</div>
<div class="paragraph">
<p><code>[ctrlBackend0] Connected to OpenEMS Backend</code></p>
</div>
<div class="paragraph">
<p>and OpenEMS Edge</p>
</div>
<div class="paragraph">
<p><code>[Edge.Websocket] Edge [edge0] connected</code></p>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_connect_openems_ui_with_backend"><a class="anchor" href="#_connect_openems_ui_with_backend"></a>2.6.3. Connect OpenEMS UI with Backend</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In Visual Studio Code open the file <code>ui/src/environments/environment.ts</code> and configure it as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">import { Environment } from "../app/shared/type/environment";

export const environment: Environment = {
  production: false,
  debugMode: true,
  url: "ws://localhost:8082",
  backend: "OpenEMS Backend",
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is again noteworthy here, that:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>"url" is set to <code>ws://localhost:8082</code>. This defines an unencrypted websocket ("ws://") connection to the local computer on port "8082" like we configured before for the Ui.Websocket.</p>
</li>
<li>
<p>"backend" is set to "OpenEMS Backend". This option is used in certain places inside OpenEMS UI that need to be treated differently for connections to OpenEMS Edge and OpenEMS Backend.</p>
</li>
</ol>
</div>
</li>
<li>
<p>In Visual Studios integrated terminal type&#8230;&#8203;</p>
<div class="paragraph">
<p><code>ng serve</code></p>
</div>
</li>
<li>
<p>Open a browser at <a href="http://localhost:4200" class="bare">http://localhost:4200</a></p>
</li>
<li>
<p>You should see again OpenEMS UI, but this time you are not asked for a login (because Metadata.Dummy does not require any) and are directly forwarded to the Energy Monitor at <code><a href="http://localhost:4200/device/edge0/index" class="bare">http://localhost:4200/device/edge0/index</a></code>. You are now seeing the data from OpenEMS Edge via OpenEMS Backend.</p>
<div class="imageblock">
<div class="content">
<img src="_images/ui-via-backend.png" alt="UI via Backend">
</div>
<div class="title">Figure 26. UI via Backend</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_next_steps"><a class="anchor" href="#_next_steps"></a>2.7. Next steps</h3>
<div class="paragraph">
<p>Now that you setup a complete development environment and have a working instance of OpenEMS Edge, OpenEMS Backend an OpenEMS UI, you can continue implementing your first device driver in OpenEMS. We provide a tutorial that explains the steps to implement an electric meter in OpenEMS Edge that is connected via Modbus/TCP. The meter itself is simulated using a small Modbus slave application, so no external hardware is required for this guide. → <a href="edge/implement.html" class="page">Implementing a Device</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_core_concepts_terminology"><a class="anchor" href="#_core_concepts_terminology"></a>3. Core concepts &amp; terminology</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes some of the core concepts and commonly used terms in OpenEMS:</p>
</div>
<div class="sect2">
<h3 id="_osgi_bundle"><a class="anchor" href="#_osgi_bundle"></a>3.1. OSGi Bundle</h3>
<div class="paragraph">
<p>OpenEMS Edge is using the <a href="https://en.wikipedia.org/wiki/OSGi">OSGi <span class="icon"><i class="fa fa-external-link"></i></span></a> platform to provide a completely modular and dynamic service oriented system.</p>
</div>
<div class="paragraph">
<p>Logical groups of source code are put into one OSGi Bundle. Every directory in the source code root directory starting with <code>io.openems.*`</code> is a bundle.</p>
</div>
<div class="paragraph">
<p>More bundle naming conventions are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Bundle names ending with <code>*.common</code> are for common code that is shared by multiple components. Examples are:</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>io.openems.common</code></dt>
<dd>
<p>for common code between Edge and Backend, like helper utils, JSON-RPC definitions and Abstract Worker implementations</p>
</dd>
<dt class="hdlist1"><code>io.openems.backend.common</code></dt>
<dd>
<p>for common code within Backend.</p>
</dd>
<dt class="hdlist1"><code>io.openems.edge.common</code></dt>
<dd>
<p>for common code within Edge.</p>
</dd>
<dt class="hdlist1"><code>io.openems.edge.controller.api.common</code></dt>
<dd>
<p>for common code used by API Controllers</p>
</dd>
<dt class="hdlist1"><code>&#8230;&#8203;</code></dt>
</dl>
</div>
</li>
<li>
<p>Bundle names ending with <code>*.api</code> are for <a href="#_nature">Natures and APIs</a>. Examples are:</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>io.openems.edge.controller.api</code></dt>
<dd>
<p>for <a href="edge/controller.html" class="page">Controllers</a></p>
</dd>
<dt class="hdlist1"><code>io.openems.edge.scheduler.api</code></dt>
<dd>
<p>for <a href="edge/scheduler.html" class="page">Schedulers</a></p>
</dd>
<dt class="hdlist1"><code>&#8230;&#8203;</code></dt>
</dl>
</div>
</li>
<li>
<p>Bundle names ending with <code>*.core</code> are for shared and helper OSGi services. Examples are:</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>io.openems.edge.core</code></dt>
<dd>
<p>for central singleton services:</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>ComponentManager</strong></dt>
<dd>
<p>handles access to OpenEMS Components and Channels</p>
</dd>
<dt class="hdlist1"><strong>Cycle</strong></dt>
<dd>
<p>is responsible for the process <a href="edge/architecture.html#_cycle" class="page">Cycle</a></p>
</dd>
<dt class="hdlist1"><strong>Host</strong></dt>
<dd>
<p>for accessing the host and operating system</p>
</dd>
<dt class="hdlist1"><strong>Meta</strong></dt>
<dd>
<p>for some Meta information like the version of the running OpenEMS Edge</p>
</dd>
<dt class="hdlist1"><strong>Sum</strong></dt>
<dd>
<p>for summing the values of the entire energy system, all meters, energy storage systems and so on.</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code>io.openems.edge.ess.core</code></dt>
<dd>
<p>for the central <strong>EssPower</strong> service, that distributes power requirements to different energy storage systems</p>
</dd>
</dl>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_openems_component"><a class="anchor" href="#_openems_component"></a>3.2. OpenEMS Component</h3>
<div class="paragraph">
<p>An OpenEMS Component is the fundamental building block in OpenEMS. Within the used OSGi Java framework, an OpenEMS component represents a service with requirements and capabilities.</p>
</div>
<div class="paragraph">
<p>As an example, an OpenEMS Component can declare to have the capabilities of an Energy Storage System (ESS) and as such represents the digital twin of a real device.
A specific control algorithm can be implemented as a separate OpenEMS Component that declares a requirement for an ESS.
Using this metadata, these building blocks are wired together at runtime and form a very flexible system.
OSGi provides the capability to enable, modify or disable an OpenEMS Component at any time, without requiring a restart of the software.
Re-wiring of the building blocks happens transparently in the background by the framework.</p>
</div>
<div class="paragraph">
<p>Every OpenEMS Component is identified by a unique ID, the "Component-ID".
In an ecosystem consisting of a couple of ESS, a power meter at the grid connection point, and a measured photovoltaic system, those Component-IDs can be represented as follows:
*	<code>ess1</code> for the first ESS
*	<code>ess2</code> for the second ESS
*	<code>ess0</code> for a virtual ESS cluster Component that aggregates ess1 and ess2
*	<code>meter0</code> for the power meter at the grid connection point
*	<code>meter1</code> for the measured photovoltaic system
* &#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>To declare an OpenEMS component, the Java class has to <code>implement</code> the <a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.edge.common/src/io/openems/edge/common/component/OpenemsComponent.java">OpenemsComponent interface <span class="icon"><i class="fa fa-code"></i></span></a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_channel"><a class="anchor" href="#_channel"></a>3.3. Channel</h3>
<div class="paragraph">
<p>Each OpenEMS component has a defined set of data points.
These data points are called "Channels".
Each represents a single piece of information about a component.
By definition, each channel has a unique ID, the "Channel-ID", within its parent component.
Channels are defined by metadata like descriptive text, access-mode (<code>read-only</code>, <code>read-write</code>, <code>write-only</code>), data type (<code>string</code>, <code>integer</code>, <code>float</code>, etc.), and unit of measure (<code>Watt</code>, <code>Volt</code>, <code>Degree Celsius</code>, etc.).
It is up to the OpenEMS component to provide the input for its read-channels as well as triggering actions on write-channels.</p>
</div>
<div class="paragraph">
<p><em>Example:</em> An OpenEMS Component that represents a device connected via the Modbus communication protocol continuously reads data, such as the current measured power and provides the data in its Channels.
Other Components in the system can then use the channel data for their application, e.g. as input for a control algorithm, to analyse it, store it locally or publish it via an application programming interface (API).</p>
</div>
<div class="paragraph">
<p>An energy system architecture as depicted in the Introduction is complex: connected to multiple hardware devices - batteries, converters, meters, and others - and an operating system and other software components.
All of these elements are possible sources of errors.
Because of this, measures are implemented in OpenEMS to improve fault tolerance.
The developer needs to be aware, that every Channel value, while it will never change within a cycle, it could always be <code>undefined</code> or <code>null</code>, e.g. because there is no communication (yet) with the external hardware device or service.
Therefore, the programming API for accessing a channel value requires an explicit declaration of what should be done in that case.
It provides the following methods to get the actual value:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>public T getOrError() throws InvalidValueException;</code></p>
</li>
<li>
<p><code>public T orElse(T alternativeValue);</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each Channel implements the <a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.edge.common/src/io/openems/edge/common/channel/Channel.java">Channel interface <span class="icon"><i class="fa fa-code"></i></span></a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_nature"><a class="anchor" href="#_nature"></a>3.4. Nature</h3>
<div class="paragraph">
<p>Certain categories of devices and services provide the same kind of information (i.e. Channels).
To group these similar devices and services, OpenEMS defines "Natures" as sets of characteristics and attributes which need to be provided by each component that implements them.
That is, a Nature extends a normal Java interface with channels.</p>
</div>
<div class="paragraph">
<p>Examples of abstracting physical devices using Natures are:
-	"SymmetricMeter" for power meters
-	"SymmetricEss" for symmetric battery energy storage systems
-	"Evcs" for electric vehicle charging stations.</p>
</div>
<div class="paragraph">
<p>OpenEMS components can declare their service capabilities and requirements as Natures.
In this way, a control algorithm can simply declare a requirement for a controllable energy storage system (“ManagedSymmetricEss”) and will at runtime be wired with a service that provides this capability.
The control algorithm does not need to know anything about the ESS&#8217;s specific communication interface, protocol, or manufacturer.</p>
</div>
<div class="paragraph">
<p>Natures extend normal Java interfaces with 'Channels'.
If a Component implements a Nature it also needs to provide the required Channels.
For example the Energy Storage System (ESS) Simulator <a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.edge.simulator/src/io/openems/edge/simulator/ess/symmetric/reacting/EssSymmetric.java">Simulator.EssSymmetric.Reacting <span class="icon"><i class="fa fa-code"></i></span></a> implements the <a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.edge.ess.api/src/io/openems/edge/ess/api/SymmetricEss.java">Ess interface <span class="icon"><i class="fa fa-code"></i></span></a> and therefor needs to provide a <code>Soc</code> Channel that provides the current 'State of Charge' of the battery.</p>
</div>
<div class="paragraph">
<p><a href="edge/controller.html" class="page">Controllers</a> are written against Nature implementations. Example: A Controller can be used with any ESS, because it can be sure that it provides all the data the Controller requires for its algorithm.</p>
</div>
</div>
<div class="sect2">
<h3 id="_channel_address"><a class="anchor" href="#_channel_address"></a>3.5. Channel Address</h3>
<div class="paragraph">
<p>By combining the unique <strong>Component-ID</strong> and <strong>Channel-ID</strong> each Channel in the system can be addressed by a distinct 'Channel Address' in the form <code>Component-ID/Channel-ID</code>.</p>
</div>
<div class="paragraph">
<p>Example: the state of charge ("Soc") of the first energy storage system ("ess0") has the channel address <code>ess0/Soc</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_scheduler"><a class="anchor" href="#_scheduler"></a>3.6. Scheduler</h3>
<div class="paragraph">
<p>The Scheduler handles the order, in which Controllers are executed. For details see <a href="edge/controller.html" class="page">Scheduler and Controller</a> below.</p>
</div>
</div>
<div class="sect2">
<h3 id="_controller"><a class="anchor" href="#_controller"></a>3.7. Controller</h3>
<div class="paragraph">
<p>The actual business logic or algorithms are wrapped as 'Controllers'. i.e. they implement the <a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.edge.controller.api/src/io/openems/edge/controller/api/Controller.java">Controller interface <span class="icon"><i class="fa fa-code"></i></span></a>. Each Controller holds one specific, encapsulated task.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_openems_edge"><a class="anchor" href="#_openems_edge"></a>4. OpenEMS Edge</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_edge_architecture"><a class="anchor" href="#_edge_architecture"></a>4.1. Edge Architecture</h3>
<div class="paragraph">
<p>OpenEMS is a modular platform for energy management applications.
It was developed around the requirements of controlling, monitoring and integrating energy storage systems together with renewable energy sources and complementary devices and services.</p>
</div>
<div class="paragraph">
<p>The OpenEMS Edge software architecture is carefully designed to abstract device communication and control algorithms in a way to provide maximum flexibility, predictability and stability, while simplifying the process of implementing new components.</p>
</div>
<div class="sect3">
<h4 id="_high_level_programming_language"><a class="anchor" href="#_high_level_programming_language"></a>4.1.1. High-Level programming language</h4>
<div class="paragraph">
<p>OpenEMS Edge and Backend are implemented in the Java programming language and requires a Java Runtime Environment (JRE). This allows convenient development on a personal laptop on any operating system. For productive use, the software typically runs on an Industrial IoT Gateway or a development board like a Raspberry Pi with GNU/Linux Operating System.</p>
</div>
<div class="paragraph">
<p>The usage of a high-level programming language for an EMS leads to a trade-off between easy and efficient software development and loss of hard real-time capabilities.</p>
</div>
<div class="paragraph">
<p>An Energy Management System collects input data, like measured grid power and state of charge of a battery, and processes it with its control algorithms to derive setpoints which are sent to the hardware devices. (see "Input-Process-Output" below).</p>
</div>
<div class="paragraph">
<p>The possible and feasible speed of this execution cycle depends on the performance of the connected devices and the communication paths.
It also means that the EMS has to deal with multi-threading, asynchronous communication and latencies.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A power smoothing algorithm needs to process the current output power of a photovoltaics system. Most external power meters provide measurements approximately only once every second. In this scenario it is not feasible to run the execution cycle more often than once every second.</p>
</li>
<li>
<p>For control algorithms that require high-performance and minimum delay between measurement and action, e.g. providing Virtual Inertia Ancillary Services, the EMS cycle duration is not sufficient and soft real-time behaviour is not suitable. The same point applies for critical safety measures like fire extinguishing and disaster control measures."</p>
</li>
<li>
<p>Due to the asynchronous communication, new data can arrive at every moment, e.g. the value for active power received by the meter can change at any time between the operation of two consecutive lines of code. The EMS needs to provide measures to avoid errors arising from this multi-threading.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_input_process_output"><a class="anchor" href="#_input_process_output"></a>4.1.2. Input-Process-Output</h4>
<div class="paragraph">
<p>OpenEMS Edge is built around the well-known IPO (input-process-output) model which defines the internal execution cycle.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/input-process-output.png" alt="Input-Process-Output model">
</div>
<div class="title">Figure 27. Input-Process-Output model</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Input</dt>
<dd>
<p>During the input phase all relevant information - e.g. the current 'state of charge' of a battery - is collected and provided as a <strong>process image</strong>. This process image is guaranteed to never change during the cycle.</p>
</dd>
<dt class="hdlist1">Process</dt>
<dd>
<p>The process phase runs algorithms and tasks based on the process image - e.g. an algorithm uses the 'state of charge' information to evaluate whether a digital output should be turned on.</p>
</dd>
<dt class="hdlist1">Output</dt>
<dd>
<p>The output phase takes the results from the process phase and applies it - e.g. it turns the digital output on or off.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_controller_2"><a class="anchor" href="#_controller_2"></a>4.1.3. Controller</h4>
<div class="paragraph">
<p>Controllers are consumers of Channel data and hold the actual business logic, e.g. the control algorithm that evaluates input data and defines setpoints for the controlled hardware.</p>
</div>
<div class="paragraph">
<p>Examples for controllers are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Controller.Ess.LimitTotalDischarge</code> maintains a minimum battery level</p>
</li>
<li>
<p><code>Controller.Backend.Api</code> connects to the OpenEMS Backend server</p>
</li>
<li>
<p><code>Controller.Rest.Api</code> provides a JSON/REST-Api for external access</p>
</li>
<li>
<p><code>Controller.Debug.Log</code> logs regular system status messages to the standard output</p>
</li>
<li>
<p><code>Controller.Ess.PeakShaving</code> charges or discharges an ESS in order to cut power peaks at the PCC</p>
</li>
<li>
<p><code>Controller.Ess.Balancing</code> charges or discharges an ESS in order to optimize self-consumption from a local photovoltaics system.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Ideally controller implementations follow the KISS (Keep It Simple Stupid) principle, which means that they carry out only one specific, encapsulated task.
This approach allows very flexible system architectures and avoids duplicated code.
For example, both <code>Ess.PeakShaving</code> and <code>Ess.Balancing</code> controllers do not need to repeat any logic for keeping the battery at a safe state, as this is what the <code>Ess.LimitTotalDischarge</code> controller is responsible for.</p>
</div>
<div class="paragraph">
<p>As can be seen above, controllers are not necessarily restricted to control algorithms.
Even northbound connections to a backend server or SCADA system and alike are implemented as Controllers.
This assures for any setpoint request by an external system being embedded in the local prioritization system and naturally restricted by higher-priority controllers.</p>
</div>
<div class="paragraph">
<p><em>Example:</em> An external request to discharge the battery will be limited by the <code>Ess.LimitTotalDischarge</code> controller just like any other internal control algorithm.</p>
</div>
<div class="paragraph">
<p>Controllers are executed regularly e.g. once per second (see "Cycle" below).</p>
</div>
</div>
<div class="sect3">
<h4 id="_scheduler_2"><a class="anchor" href="#_scheduler_2"></a>4.1.4. Scheduler</h4>
<div class="paragraph">
<p>During the 'process' phase different algorithms (Controllers) might try to access the same resources - e.g. two Controllers try to switch the same digital output.
It is therefore necessary to prioritize their execution and restrict access according to priority.
OpenEMS Edge uses Scheduler implementations to receive a sorted list of Controllers.
The Controllers are then executed in order.
Later executed Controllers are not allowed to overwrite a previously written result.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/input-process-scheduler-output.png" alt="IPO model with Scheduler and Controllers">
</div>
<div class="title">Figure 28. IPO model with Scheduler and Controllers</div>
</div>
<div class="paragraph">
<p><em>Example:</em></p>
</div>
<div class="paragraph">
<p>In the example of energy storage system, the following figure shows, how the interval of possible solutions is reduced by sequentially executed Controllers.
In the example the initial ESS limits from battery and converter allow charging and discharging with <code>50 kW</code>.
The 'Limit Total Discharge' controller then adds a constraint to force charge the ESS, i.e. enforcing a setpoint that is smaller than <code>-5 kW</code>.
No further limitations are applied by the Api controllers.
The 'Balancing' controller then requests discharging the ESS with <code>20 kW</code> but is forced to fulfil the constraints.
Eventually the ESS gets force-charged with <code>5 kW</code>.</p>
</div>
<div class="paragraph">
<p>The scheduler in OpenEMS Edge handles this prioritization and sequential execution of controllers.
In the example of controlling an ESS, a separate <code>Ess.Power</code> component synchronizes with the IPO cycle and manages feasible solutions via a linear equation system that allows constraints on three-phase or single-phase setpoints for active and reactive power.
It is also used for optimizing distribution of setpoints in the case of multiple ESS.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/scheduler-ess-priority.png" alt="Prioritization of ESS power setpoints">
</div>
<div class="title">Figure 29. Prioritization of ESS power setpoints</div>
</div>
</div>
<div class="sect3">
<h4 id="_cycle"><a class="anchor" href="#_cycle"></a>4.1.5. Cycle</h4>
<div class="paragraph">
<p>The input-process-output model in OpenEMS Edge is executed in a Cycle - implemented by the <a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.edge.core/src/io/openems/edge/core/cycle/Cycle.java">Cycle component <span class="icon"><i class="fa fa-code"></i></span></a>. It handles the setting of a process image in the input phase and executes the Controllers in the process phase. Furthermore it emits Cycle Events that can be used in other Components to synchronize with the Cycle.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/edge-cycle.png" alt="OpenEMS Edge Cycle">
</div>
<div class="title">Figure 30. OpenEMS Edge Cycle</div>
</div>
</div>
<div class="sect3">
<h4 id="_process_image"><a class="anchor" href="#_process_image"></a>4.1.6. Process Image</h4>
<div class="paragraph">
<p>Due to asynchronous communication with external devices and services, data can potentially be updated or invalidated at any point in time.
This could lead to confusing situations, e.g. where a Channel value changes between two consecutive controllers that act on its data.
To avoid these situations and relieve the programmer from taking care of all kinds of concurrency problems, OpenEMS uses a "Process Image", a technique well proven in the field of PLC programming.
The idea is to untie the producers and consumers of data and introducing a central buffer for all channel data. This buffer - the Process Image - is updated only once in every computing cycle when it activates the latest data in each Channel.</p>
</div>
<div class="paragraph">
<p>Therefore, the implementation of channel objects in OpenEMS has two data variables:
- The <code>value</code> field keeping the currently active value that should be used by consumers
- The <code>nextValue</code> field representing the latest data that was received, e.g. via Modbus communication.</p>
</div>
<div class="paragraph">
<p>At - and only at - 'Switch Process Image' of the Cycle, the <code>nextValue</code> gets copied to the <code>value</code> field.
This assures, that the data in the Process Image does not change during a computing Cycle.</p>
</div>
</div>
<div class="sect3">
<h4 id="_asynchronous_threads_and_cycle_synchronization"><a class="anchor" href="#_asynchronous_threads_and_cycle_synchronization"></a>4.1.7. Asynchronous threads and Cycle synchronization</h4>
<div class="paragraph">
<p>Communication with external hardware and services needs to be executed in asynchronous threads to not block the system. At the same time, those threads need to synchronize with the Cycle.</p>
</div>
<div class="paragraph">
<p>The following example shows, how the <a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.edge.bridge.modbus/src/io/openems/edge/bridge/modbus/AbstractModbusBridge.java">Modbus implementation <span class="icon"><i class="fa fa-code"></i></span></a> uses Cycle Events to synchronize with the Cycle:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/cycle-modbus.png" alt="Synchronize Cycle with Modbus read/write">
</div>
<div class="title">Figure 31. Synchronize Cycle with Modbus read/write</div>
</div>
</div>
<div class="sect3">
<h4 id="_architecture_scheme"><a class="anchor" href="#_architecture_scheme"></a>4.1.8. Architecture scheme</h4>
<div class="paragraph">
<p>The OpenEMS Edge software architecture is carefully designed to abstract device communication and control algorithms in a way to provide maximum flexibility, predictability and stability while simplifying the process of implementing new components.</p>
</div>
<div class="paragraph">
<p>The following scheme shows the abstraction of hardware via Channels, Natures and Devices as well as the execution of control algorithms via Scheduler and Controllers.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/device-nature-channel-scheduler-controller.png" alt="Architecture scheme">
</div>
<div class="title">Figure 32. Architecture scheme</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration"><a class="anchor" href="#_configuration"></a>4.2. Configuration</h3>
<div class="paragraph">
<p>The actual hardware setup behind an Energy Management System (EMS) usually varies from site to site.
To comply with this, the EMS needs a static, local configuration that declares available hardware components and services and activated control algorithms with their parameters.
This configuration persists locally on the EMS hardware on a storage like an on-board eMMC flash drive or an external SD card.
To reduce writes to local storage and avoid hardware defects, the configuration should not be changed frequently.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"Power meter of type SOCOMEC Diris A40, measuring the power at the grid connection point is connected on interface /dev/ttySC0 via RS485 bus with baudrate 9600. It listens on Modbus Unit-ID 5"</p>
</li>
<li>
<p>"Battery inverter of type KACO 50, connected via Modbus/TCP on IP address 10.4.0.15, port 502"</p>
</li>
<li>
<p>"Algorithm for using an energy storage system to apply power smoothing of a photovoltaics installation to a maximum defined ramp rate. Discharge battery on suddenly reduced DRES power; recharge on suddenly increased DRES power."</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_manage_configuration"><a class="anchor" href="#_manage_configuration"></a>4.2.1. Manage configuration</h4>
<div class="paragraph">
<p>OpenEMS Edge and Backend are configured using the standard OSGi <a href="https://docs.osgi.org/specification/osgi.cmpn/7.0.0/service.cm.html">Configuration Admin Service</a>. There are multiple ways to manage this configuration:</p>
</div>
<div class="sect4">
<h5 id="_via_openems_ui"><a class="anchor" href="#_via_openems_ui"></a>4.2.1.1. Via OpenEMS UI</h5>
<div class="paragraph">
<p>Via the OpenEMS UI it is possible to configure an OpenEMS Edge that is connected directly or via an OpenEMS Backend:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/ui-component-install-overview.png" alt="OpenEMS UI Install Components Overview">
</div>
<div class="title">Figure 33. OpenEMS UI Install Components</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/ui-component-install.png" alt="OpenEMS UI Install Component">
</div>
<div class="title">Figure 34. OpenEMS UI Install Component</div>
</div>
</div>
<div class="sect4">
<h5 id="_via_apache_felix_web_console"><a class="anchor" href="#_via_apache_felix_web_console"></a>4.2.1.2. Via Apache Felix Web Console</h5>
<div class="paragraph">
<p>The 'native way' to manage an OSGi configuration is via the Apache Felix Web Console. By default it listens on port 8080 and can be accessed via <a href="http://localhost:8080/system/console/configMgr" class="bare">http://localhost:8080/system/console/configMgr</a> as described in the <a href="gettingstarted.html" class="page">Getting Started</a> guide.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/apache-felix-console-configuration.png" alt="Apache Felix Web Console Configuration">
</div>
<div class="title">Figure 35. Apache Felix Web Console Configuration</div>
</div>
</div>
<div class="sect4">
<h5 id="_via_json_rpc"><a class="anchor" href="#_via_json_rpc"></a>4.2.1.3. Via JSON-RPC</h5>
<div class="paragraph">
<p>The JSON-RPC protocol is used throughout the project to enable access to functions directly on the OpenEMS Edge or via an OpenEMS Backend. See <a href="component-communication/index.html" class="page">Component Communication</a> for details. Configuration may be adjusted using the following JSON-RPC methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "method": "createComponentConfig",
  "params": {
    "factoryPid": string,
    "properties": [{
      "name": string,
      "value": any
    }]
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "method": "updateComponentConfig",
  "params": {
    "componentId": string,
    "properties": [{
      "name": string,
      "value": any
    }]
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The parameters for updating a component configuration are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>componentId</code>: The unique ID of the Component</p>
</li>
<li>
<p><code>properties</code>: A set of properties with ‘name’ and ‘value</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Example:</em> The "Symmetric Balancing Schedule Controller" charges or discharges an ESS in order to reach a given power target setpoint at the grid connection point. Setpoints are given as a schedule in JSON format. Using an Update Component Config JSON-RPC request, an existing controller can be reconfigured with a new setpoint schedule:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc": "2.0",
  "id": UUID,
  "method": "updateComponentConfig",
  "params": {
    "componentId": "ctrlBalancingSchedule0",
    "properties": [
      {
        "name": "schedule",
        "value": [
          {
            "startTimestamp": 1577836800,
            "duration": 900,
            "activePowerSetPoint": 0
          },
          {
            "startTimestamp": 1577837700,
            "duration": 900,
            "activePowerSetPoint": -2000
          }
        ]
      }
    ]
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this new configuration the algorithm will try to keep the grid connection point at <code>0 W</code> starting from timestamp <code>1577836800</code> (1st January 2020 00:00:00) for <code>900 seconds</code> (15 minutes) and at <code>-2000</code> (2000 W sell-to-grid power) starting from <code>1577837700</code> for another <code>900 seconds</code>. Outside of these two timeslots it sets no setpoint and allows a controller with lower priority to take over.</p>
</div>
</div>
<div class="sect4">
<h5 id="_by_editingpreseeding_configuration_files"><a class="anchor" href="#_by_editingpreseeding_configuration_files"></a>4.2.1.4. By editing/preseeding configuration files</h5>
<div class="paragraph">
<p>The OSGi Configuration Admin stores the configuration in plain text files on the filesystem. See the <code>felix.cm.dir</code> parameter in <a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.edge.application/EdgeApp.bndrun">EdgeApp.bndrun</a> file as an example.</p>
</div>
<div class="paragraph">
<p>This way can be used to conveniently preseed a configuration on an Edge device in productive deployment or for quick changes. Make sure to restart the application afterwards to apply changes.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_edge_config"><a class="anchor" href="#_edge_config"></a>4.2.2. Edge-Config</h4>
<div class="imageblock">
<div class="content">
<img src="_images/config-architecture.png" alt="OpenEMS Edge Configuration Architecture">
</div>
<div class="title">Figure 36. OpenEMS Edge Configuration Architecture</div>
</div>
<div class="paragraph">
<p>The architecture of OpenEMS Edge configuration is shown in the image above. It consists of</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Nature</dt>
<dd>
<p>A Nature defines as set of characteristics and attributes. In OpenEMS Edge a Nature is a Java 'Interface', that defines required channels of an implementing OpenEMS Component.</p>
<div class="paragraph">
<p><em>Example:</em> The Nature for a <code>Battery</code> defines Channels like <code>ChargeMaxVoltage</code>, <code>DischargeMaxVoltage</code> and <code>Soc</code> (state-of-charge) that need to be provided by every Battery implementation.</p>
</div>
</dd>
<dt class="hdlist1">Channel</dt>
<dd>
<p>A Channel represents a single piece of information about a component; enriched with metadata like a description, unit of measure and more.</p>
<div class="paragraph">
<p><em>Example:</em> The <code>ChargeMaxVoltage</code> channel of the Battery nature has a descriptive text "Maximal voltage for charging", is defined as type Integer with the unit Ampere.</p>
</div>
</dd>
<dt class="hdlist1">Factory</dt>
<dd>
<p>A Factory is comparable to a 'Class' in object-oriented software development that is enriched with Java/OSGi metadata like a unique string identifier and defines a set of required configuration parameters.
A factory implements one or more Natures to indicate that it provides all channels defined by the Nature.
Additionally, a factory may define further channels that are specific to the individual implementation.</p>
<div class="paragraph">
<p><em>Example:</em> The OpenEMS Edge "Factory" for BMW battery implements the <code>Battery</code> Nature.
Additionally, it declares channels  like <code>AmbientTemperature</code> that are not available and required by every Battery implementation.</p>
</div>
</dd>
<dt class="hdlist1">Instance</dt>
<dd>
<p>An Instance is comparable to an "Object", i.e. a runtime instantiation of a factory with defined configuration parameters. The Instance is then further referred to as an OpenEMS Component and uniquely identified by its Component-ID.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>OpenEMS Edge provides the specific configuration via its API in the form of a JSON definition referred to as <strong>EdgeConfig</strong>. The following shortened example shows its general structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "components": {
    "ess0": {
      "alias": "Battery Energy Storage System",
      "factoryId": "Ess.Generic.ManagedSymmetric",
      "properties": {
        "enabled": true,
        "battery.id": "battery0",
        "batteryInverter.id": "batteryInverter0"
      },
      "channels": {
        "ActivePower": {
          "type": "INTEGER",
          "accessMode": "RO",
          "text": "Negative values for Charge; positive for Discharge",
          "unit": "W"
        }
      }
    }
  },
  "factories": {
    "Ess.Generic.ManagedSymmetric": {
      "id": "Ess.Generic.ManagedSymmetric",
      "name": "ESS Generic Managed Symmetric",
      "description": "",
      "natureIds": [
        "io.openems.edge.ess.api.SymmetricEss",
      ],
      "properties": [
        {
          "id": "id",
          "name": "Component-ID",
          "description": "Unique ID of this Component",
          "isRequired": true,
          "defaultValue": "ess0"
        }
      ]
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The EdgeConfig may be retrieved using the following JSON-RPC method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc": "2.0",
  "id": "UUID",
  "method": "getEdgeConfig",
  "params": {}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>External services - like OpenEMS UI - can use the EdgeConfig to adapt to the actual configuration of the OpenEMS Edge.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_nature_2"><a class="anchor" href="#_nature_2"></a>4.3. Nature</h3>
<div class="paragraph">
<p>Physical hardware is abstracted in OpenEMS Edge using <em>Natures</em>. A Nature defines a set of characteristics and attributes which need to be provided by each OpenEMS component that implements it. These characteristics are defined by Channels. For example an implementation of an <code>Ess</code> (Energy Storage System), needs to provide an <code>Soc</code>-Channel (State of charge of the battery).</p>
</div>
<div class="paragraph">
<p>Technically Natures are implemented as OSGi API Bundles.</p>
</div>
<div class="sect3">
<h4 id="_battery"><a class="anchor" href="#_battery"></a>4.3.1. Battery</h4>
<div class="paragraph">
<p>A battery that is connected to a battery inverter.</p>
</div>
</div>
<div class="sect3">
<h4 id="_battery_inverter"><a class="anchor" href="#_battery_inverter"></a>4.3.2. Battery-Inverter</h4>
<div class="paragraph">
<p>Together with a battery, a battery-inverter builds an Energy Storage System.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.batteryinverter.api">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_controller_3"><a class="anchor" href="#_controller_3"></a>4.3.3. Controller</h4>
<div class="paragraph">
<p>A Controller; see the Controller chapter for details.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ess_energy_storage_system"><a class="anchor" href="#_ess_energy_storage_system"></a>4.3.4. ESS (Energy Storage System)</h4>
<div class="paragraph">
<p>An Energy Storage System is an integrated system with battery and battery inverter.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.edge.ess.api/src/io/openems/edge/ess/api/SymmetricEss.java">Ess <span class="icon"><i class="fa fa-code"></i></span></a></dt>
<dd>
<p>A generic Energy Storage System</p>
</dd>
<dt class="hdlist1"><a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.edge.ess.api/src/io/openems/edge/ess/api/SymmetricEss.java">SymmetricEssReadonly <span class="icon"><i class="fa fa-code"></i></span></a></dt>
<dd>
<p>A symmetric Energy Storage System in readonly-mode.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>A symmetric, controllable Energy Storage System.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.edge.ess.api/src/io/openems/edge/ess/dccharger/api/EssDcCharger.java">EssDcCharger <span class="icon"><i class="fa fa-code"></i></span></a></dt>
<dd>
<p>A solar charger that is connected to DC side of an energy storage system.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_evcs_electric_vehicle_charging_station"><a class="anchor" href="#_evcs_electric_vehicle_charging_station"></a>4.3.5. EVCS (Electric Vehicle Charging Station)</h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.edge.evcs.api/src/io/openems/edge/evcs/api/Evcs.java">Evcs <span class="icon"><i class="fa fa-code"></i></span></a></dt>
<dd>
<p>A charging station for electric vehicles like e-cars and e-buses.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_io_digital_inputoutput"><a class="anchor" href="#_io_digital_inputoutput"></a>4.3.6. I/O (Digital Input/Output)</h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.edge.io.api/src/io/openems/edge/io/api/DigitalOutput.java">DigitalOutput <span class="icon"><i class="fa fa-code"></i></span></a></dt>
<dd>
<p>One or more digital outputs or relays.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_meter"><a class="anchor" href="#_meter"></a>4.3.7. Meter</h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.edge.meter.api/src/io/openems/edge/meter/api/MeterType.java">Meter <span class="icon"><i class="fa fa-code"></i></span></a></dt>
<dd>
<p>A generic electric power meter.</p>
</dd>
<dt class="hdlist1"><a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.edge.meter.api/src/io/openems/edge/meter/api/SymmetricMeter.java">SymmetricMeter <span class="icon"><i class="fa fa-code"></i></span></a></dt>
<dd>
<p>A power meter for symmetric metering.</p>
</dd>
<dt class="hdlist1"><a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.edge.meter.api/src/io/openems/edge/meter/api/AsymmetricMeter.java">AsymmetricMeter <span class="icon"><i class="fa fa-code"></i></span></a></dt>
<dd>
<p>A power meter for asymmetric metering.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_predictor"><a class="anchor" href="#_predictor"></a>4.3.8. Predictor</h4>
<div class="paragraph">
<p>A Predictor provides abstract access to prediction of production and consumption.</p>
</div>
</div>
<div class="sect3">
<h4 id="_scheduler_3"><a class="anchor" href="#_scheduler_3"></a>4.3.9. Scheduler</h4>
<div class="paragraph">
<p>A Scheduler; see the Scheduler chapter for details.</p>
</div>
</div>
<div class="sect3">
<h4 id="_thermometer"><a class="anchor" href="#_thermometer"></a>4.3.10. Thermometer</h4>
<div class="paragraph">
<p>A Thermometer measures temperature.</p>
</div>
</div>
<div class="sect3">
<h4 id="_timedata"><a class="anchor" href="#_timedata"></a>4.3.11. Timedata</h4>
<div class="paragraph">
<p>A provider for time-series data, like historic recordings of Channels.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_scheduler_4"><a class="anchor" href="#_scheduler_4"></a>4.4. Scheduler</h3>
<div class="paragraph">
<p>A OpenEMS Edge Scheduler plans the execution of Controllers. It defines&#8230;&#8203;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>which Controllers are executed</p>
</li>
<li>
<p>in which priority the Controllers are executed</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_all_alphabetically"><a class="anchor" href="#_all_alphabetically"></a>4.4.1. All-Alphabetically</h4>
<div class="paragraph">
<p>Takes an ordered list of Component IDs. All remaining Controllers are afterwards ordered alphabetically by their ID.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.scheduler.allalphabetically">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_daily"><a class="anchor" href="#_daily"></a>4.4.2. Daily</h4>
<div class="paragraph">
<p>This scheduler can execute different Controllers at different times of the day according to the "Daily Schedule" configuration.
Controllers that need to run regardless of the time of the day like 'ctrlBackend0' and 'ctrlDebugLog0' etc.,
can be specified in the configuration using "Always Run Before" and "Always Run After'.</p>
</div>
<div class="sect4">
<h5 id="_configuration_2"><a class="anchor" href="#_configuration_2"></a>4.4.2.1. Configuration</h5>
<div class="ulist">
<ul>
<li>
<p><code>Component-ID</code> Unique ID of this Component (id), e.g. "scheduler0".</p>
</li>
<li>
<p><code>Alias</code> Human-readable name of this Component; defaults to Component-ID (alias)</p>
</li>
<li>
<p><code>Always Run Before</code> IDs of Controllers that should be executed <em>before</em> other Controllers in the order of the IDs.</p>
</li>
<li>
<p><code>Daily Schedule</code> Execution order of Controllers per time of day.
[{
	"time": "08:00:00",
	"controllers": [
		"ctrlFixActivePower0"
	]
}, {
	"time": "13:45:00"
	"controllers": [""]"
}]</p>
</li>
<li>
<p><code>Always Run After</code> IDs of Controllers that should be executed <em>after</em> other Controllers in the order of the IDs.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.scheduler.daily">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fixed_order"><a class="anchor" href="#_fixed_order"></a>4.4.3. Fixed Order</h4>
<div class="paragraph">
<p>Takes a list of Component IDs and returns the Controllers statically sorted by this order.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.scheduler.fixedorder">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_controller_4"><a class="anchor" href="#_controller_4"></a>4.5. Controller</h3>
<div class="paragraph">
<p>A OpenEMS Edge Controller holds the actual business logic or the actual algorithm that controls hardware. The logic of each active Controller is executed regularly on every Cycle, i.e. once per second.</p>
</div>
<div class="paragraph">
<p>On each execution cycle, e.g. once every second, the EMS can send a control command, which allows two different ways of controlling the hardware:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Control by setpoint</strong></p>
<div class="paragraph">
<p>In “control by setpoint” mode, the EMS calculates setpoint commands and sends them to the hardware for immediate execution.</p>
</div>
<div class="paragraph">
<p><em>Example:</em> A power smoothing algorithm uses the current and previous output power values of a photovoltaics system. By applying its configured maximum defined ramp rate it deduces that the energy storage systems needs to be discharged with 150 kW to compensate a suddenly reduced output power. It therefore sends a setpoint for "discharge with 150 kW" to the ESS for immediate execution.</p>
</div>
</li>
<li>
<p><strong>Control by parameterization</strong></p>
<div class="paragraph">
<p>In “control by parameterization” mode, the EMS sends the configuration parameters for control algorithms embedded into the hardware for internal execution.</p>
</div>
<div class="paragraph">
<p><em>Example:</em> In a Virtual Inertia Ancillary Services application,     the EMS sends the configuration parameters for the control characteristics to the ESS. The ESS uses this parameter set for its internal, high-performance algorithm.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following Controllers are implemented in the OpenEMS standard codebase. The links point directly to the source code.</p>
</div>
<div class="sect3">
<h4 id="_api_backend"><a class="anchor" href="#_api_backend"></a>4.5.1. Api Backend</h4>
<div class="paragraph">
<p>Connects to OpenEMS Backend and sends all Channel data regularly. It is implemented as a Controller, as Channels can be written from OpenEMS Backend.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.api.backend">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_api_modbus"><a class="anchor" href="#_api_modbus"></a>4.5.2. Api Modbus</h4>
<div class="paragraph">
<p>The OpenEMS Edge Modbus-Slave-API is provided by the "Modbus-API Controller".
As the Modbus protocol is widely used in industrial monitoring and automation, this allows for easy access to OpenEMS channels from external systems.</p>
</div>
<div class="paragraph">
<p>The configuration of the Modbus-API controller defines which OpenEMS Components should be exported and made available via the API.
It then generates a dynamic Modbus protocol that is structured in address blocks that map to OpenEMS Components and Modbus register addresses that map to OpenEMS channels.</p>
</div>
<div class="paragraph">
<p>The modbus table is designed in a way that allows dynamic parsing of all available registers.</p>
</div>
<div class="paragraph">
<p>The following example describes a Controller that is configured to export the Sum-Component (<code>_sum</code>). By reading the headers of the individual blocks, the entire Modbus protocol can be parsed dynamically:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Register <code>0</code> identifies the system as an OpenEMS by the hash value <code>0x17ed6201</code>.</p>
</li>
<li>
<p>Register <code>1</code> shows the length of the first block. Adding the length (<code>199</code>) the current address (<code>1</code>) gives the starting address of the next block (<code>200</code>).</p>
</li>
<li>
<p>Register <code>200</code> gives a string with fixed length of 16 characters with the Component-ID.</p>
</li>
<li>
<p>Register <code>216</code> shows the length of the complete block. Adding the length (<code>300</code>) to the starting address of the block (<code>200</code>) gives the starting address of the next block (<code>500</code>) and so forth.</p>
</li>
<li>
<p>Register <code>220</code> identifies the first sub-block as Nature <code>OpenemsComponent</code>. The length of the sub-block follows in Register <code>221</code> and gives the starting address of the next sub-block (<code>300</code>) and so on.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Instead of parsing the Modbus protocol, it is also possible to download the EMS specific Excel file via OpenEMS UI "System Profile" menu. An example export is available in the 'doc' folder of this bundle.</p>
</div>
<div class="paragraph">
<p>To communicate with specific channels, it is then sufficient to read or write to the matching registers, e.g.
- Read register <code>302 _sum/EssSoc</code> to get the total average state of charge of the ESS.
- Write to register <code>806 ess0/SetActivePowerEquals</code> to trigger charging or discharging of the ESS with ID <code>ess0</code>.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.api.modbus">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_api_mqtt"><a class="anchor" href="#_api_mqtt"></a>4.5.3. Api MQTT</h4>
<div class="paragraph">
<p>Publishes OpenEMS Edge data to a MQTT broker.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>edge/{OpenEMS-Edge-ID}/channel/{Component-ID}/{Channel-ID}</code></p>
<div class="ulist">
<ul>
<li>
<p>Data of Channels is published on change and at least every 5 minutes to these topics.</p>
</li>
<li>
<p>Example: <code>edge/edge0/channel/_sum/GridActivePower</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>edge/{OpenEMS-Edge-ID}/channel/lastUpdate</code></p>
<div class="ulist">
<ul>
<li>
<p>Timestamp of the latest data update on any of the Channel topics above.</p>
</li>
<li>
<p>Example: <code>edge/edge0/channel/lastUpdate</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>edge/{OpenEMS-Edge-ID}/edgeConfig</code></p>
<div class="ulist">
<ul>
<li>
<p>Configuration of the OpenEMS Edge instance is published to this topic as a JsonObject.</p>
</li>
<li>
<p>Example: <code>edge/edge0/edgeConfig</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.api.mqtt">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_rest_api_controller"><a class="anchor" href="#_rest_api_controller"></a>4.5.4. REST-Api Controller</h4>
<div class="paragraph">
<p>A REST-Api for external access to OpenEMS Edge. This Controller provides access to Channels and JSON-RPC Requests from an external device via JSON/REST.</p>
</div>
<div class="paragraph">
<p>The default port for the server is <strong>8084</strong>; so the default base address for REST calls is <code><a href="http://x:&lt;PASSWORD&gt;@&lt;IP&gt;:8084/rest" class="bare">http://x:&lt;PASSWORD&gt;@&lt;IP&gt;:8084/rest</a></code>, where</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>http</code> is the protocol</p>
</li>
<li>
<p><code>x</code> is the user. Authentication in OpenEMS is via password only, so the username can be omitted.</p>
</li>
<li>
<p><code>&lt;PASSWORD&gt;</code> is the user password. If no specific settings have been made, try 'user' or 'admin' here.</p>
</li>
<li>
<p><code>8084</code> is the configured port</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A good way to test REST-Api calls is via the Chrome extension <a href="https://chrome.google.com/webstore/detail/restlet-client-rest-api-t/aejoelaoggembcahagimdiliamlcdmfm">Restlet</a></p>
</div>
<div class="paragraph">
<p>For more information find the implementation  <a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.api.rest">Source Code <span class="icon"><i class="fa fa-github"></i></span></a>.</p>
</div>
<div class="paragraph">
<p>Those are the available REST-Api endpoints:</p>
</div>
<div class="sect4">
<h5 id="_endpoint_restchannelcomponent_idchannel_id"><a class="anchor" href="#_endpoint_restchannelcomponent_idchannel_id"></a>4.5.4.1. Endpoint <code>/rest/channel/&lt;Component-ID&gt;/&lt;Channel-ID&gt;</code></h5>
<div class="ulist">
<ul>
<li>
<p><code>Component-ID</code> is the ID of the Component, e.g. "_sum", "ess0", "meter0",&#8230;&#8203;</p>
</li>
<li>
<p><code>Channel-ID</code> is the ID of the Channel, e.g. "ActivePowerL1", "Soc",&#8230;&#8203;</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_get"><a class="anchor" href="#_get"></a>GET</h6>
<div class="paragraph">
<p>Use a HTTP request with method <code>GET</code> to read the current value of a Channel.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong> To read the current state of charge of the battery, send a GET request to <a href="http://x:user@localhost:8084/rest/channel/_sum/EssSoC" class="bare">http://x:user@localhost:8084/rest/channel/_sum/EssSoC</a>. It returns a response like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>{
  "type":"INTEGER",
  "accessMode":"RO",
  "text":"",
  "unit":"%",
  "value":50
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>GET</code> api also understands regular expressions. Send a GET request to <a href="http://x:user@localhost:8084/rest/channel/.*/Active.*Power" class="bare">http://x:user@localhost:8084/rest/channel/.*/Active.*Power</a> to read all <code>ActivePower</code> and <code>ReactivePower</code> channels of all components. It returns a response like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>[
  {
    "address":"pvInverter0/ActivePower",
    "type":"INTEGER",
    "accessMode":"RO",
    "text":"Negative values for Consumption; positive for Production",
    "unit":"W",
    "value":90
  },
  {
    "address":"meter0/ActiveProductionPower",
    "type":"INTEGER",
    "accessMode":"RO",
    "text":"",
    "unit":"W",
    "value":465
  },
  {
    "address":"meter0/ActivePower",
    "type":"INTEGER",
    "accessMode":"RO",
    "text":"Negative values for Consumption; positive for Production",
    "unit":"W",
    "value":465
  },
  {
    "address":"meter0/ActiveConsumptionPower",
    "type":"INTEGER",
    "accessMode":"RO",
    "text":"",
    "unit":"W",
    "value":0
  }
]</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_post"><a class="anchor" href="#_post"></a>POST</h6>
<div class="paragraph">
<p>Use a HTTP request with method <code>POST</code> to write a Channel.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong> To switch a Digital-Output or Relay on, send a POST request to <a href="http://x:user@localhost:8084/rest/channel/io0/Relay1" class="bare">http://x:user@localhost:8084/rest/channel/io0/Relay1</a> with the following body:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>{
  "value": true
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_endpoint_jsonrpc"><a class="anchor" href="#_endpoint_jsonrpc"></a>4.5.4.2. Endpoint '/jsonrpc'</h5>
<div class="paragraph">
<p>This allows remote procedure calls (RPC) using JSON-RPC. The JSON-RPC commands need to be sent as <code>POST</code> requests with the specified body.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
JSON-RPC usually requires the properties 'id' and 'jsonrpc'. Those can be omitted here, as they are not required for HTTP POST calls.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Following JSON-RPC commands are available:</p>
</div>
<div class="sect5">
<h6 id="_getedgeconfig"><a class="anchor" href="#_getedgeconfig"></a>getEdgeConfig</h6>
<div class="paragraph">
<p>Gets the current configuration of the OpenEMS Edge.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>{
  "method": "getEdgeConfig",
  "params": {}
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_componentjsonapi"><a class="anchor" href="#_componentjsonapi"></a>componentJsonApi</h6>
<div class="paragraph">
<p>Forwards a JSON-RPC payload to a given Component, identified by its Component-ID.</p>
</div>
<div class="sect6">
<h7 id="_getmodbusprotocol"><a class="anchor" href="#_getmodbusprotocol"></a>getModbusProtocol</h7>
<div class="paragraph">
<p>Gets the currently active Modbus-TCP protocol definition from the Modbus-TCP-Api Controller with the ID "ctrlModbusTcp0".</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>{
  "method":"componentJsonApi",
  "params":{
    "componentId":"ctrlApiModbusTcp0",
    "payload":{
      "method":"getModbusProtocol",
      "params":{

      }
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_updatecomponentconfig"><a class="anchor" href="#_updatecomponentconfig"></a>updateComponentConfig</h6>
<div class="paragraph">
<p>Updates a Component configuration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>{
	"method": "updateComponentConfig",
	"params": {
		"componentId": "ctrlDebugLog0",
		"properties": [{
 			"name": "enabled",
			"value": true
		}]
	}
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_api_websocket"><a class="anchor" href="#_api_websocket"></a>4.5.5. Api Websocket</h4>
<div class="paragraph">
<p>Provides a JSON/REST implementation via HTTP Websocket for OpenEMS Edge. It provides access to Channels and JSON-RPC Requests from an external device via Websocket. This Controller is used for local connection of OpenEMS UI.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.api.websocket">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_asymmetric_balancing_cos_phi"><a class="anchor" href="#_asymmetric_balancing_cos_phi"></a>4.5.6. Asymmetric Balancing Cos-Phi</h4>
<div class="paragraph">
<p>Controls an asymmetric energy storage system in self-consumption optimization mode while keeping the grid meter on a defined cos-phi.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.asymmetric.balancingcosphi">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_asymmetric_fix_active_power"><a class="anchor" href="#_asymmetric_fix_active_power"></a>4.5.7. Asymmetric Fix Active Power</h4>
<div class="paragraph">
<p>Sets a fixed active power for charging/discharging of an asymmetric energy storage system.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.asymmetric.fixactivepower">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_asymmetric_fix_reactive_power"><a class="anchor" href="#_asymmetric_fix_reactive_power"></a>4.5.8. Asymmetric Fix Reactive Power</h4>
<div class="paragraph">
<p>Sets a fixed reactive power for an asymmetric energy storage system.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.asymmetric.fixreactivepower">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_asymmetric_peak_shaving"><a class="anchor" href="#_asymmetric_peak_shaving"></a>4.5.9. Asymmetric Peak-Shaving</h4>
<div class="paragraph">
<p>Applies asymmetric peak-shaving at the grid meter using a energy storage system. The controller evaluates the grid meter phase with the highest load and discharges the energy storage system accordingly to cut this power peak in order to avoid the fuse to be triggered. On low consumption periods the energy storage system recharges.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.asymmetric.peakshaving">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_asymmetric_phase_rectification"><a class="anchor" href="#_asymmetric_phase_rectification"></a>4.5.10. Asymmetric Phase Rectification</h4>
<div class="paragraph">
<p>Balances the three phases at the grid using an asymmetric energy storage system.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.asymmetric.phaserectification">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_channel_threshold"><a class="anchor" href="#_channel_threshold"></a>4.5.11. Channel-Threshold</h4>
<div class="paragraph">
<p>Generic Controller that sets a digital output according to the value of given Channel - e.g. turn a Relay on, when battery state of charge is above a given threshold.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.channelthreshold">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_chp_control_via_state_of_charge_soc"><a class="anchor" href="#_chp_control_via_state_of_charge_soc"></a>4.5.12. CHP control via State-of-Charge (SoC)</h4>
<div class="paragraph">
<p>Controls a CHP device. Signals the CHP to turn 'ON' when battery SoC is low; signal it to turn 'OFF' when SoC is high. This controller needs four parameters,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>State of Charge(Soc) of the ESS.</p>
</li>
<li>
<p>Low Threshold(LT) Soc</p>
</li>
<li>
<p>High Threshold(HT) Soc</p>
</li>
<li>
<p>Output channel to signal.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Soc of the Ess is compared with the LT and HT, and The following operations or state change is performed.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the Soc is less-than("&lt;") LT, signal is sent to the Output channel which eventually turns the CHP device 'ON'.</p>
</li>
<li>
<p>If the Soc is greater-than("&gt;") HT, signal is sent to the Output channel which turns the CHP device 'OFF'.</p>
</li>
<li>
<p>Any other conditions the there is no change in the State of the CHP device.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_configuration_3"><a class="anchor" href="#_configuration_3"></a>4.5.12.1. Configuration</h5>
<div class="ulist">
<ul>
<li>
<p><code>Component-ID</code> Unique ID of this Component (id), e.g. "ctrlIoAlarm0", "ctrlIoAlarm1"</p>
</li>
<li>
<p><code>Alias</code> Human-readable name of this Component; defaults to Component-ID (alias)</p>
</li>
<li>
<p><code>Input Channels</code> Addresses of the input State-Channels (inputChannelAddress), This is a array of input state channels.</p>
</li>
<li>
<p><code>Output Channel</code> Channel address of the Digital Output that should be switched (outputChannelAddress)</p>
</li>
<li>
<p><code>Low Threshold</code> Low boundary of the threshold</p>
</li>
<li>
<p><code>High Threshold</code> High boundary of the threshold</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_example_configuration"><a class="anchor" href="#_example_configuration"></a>4.5.12.2. Example Configuration</h5>
<div class="ulist">
<ul>
<li>
<p><code>Component-ID</code> : ctrlChpSoc0</p>
</li>
<li>
<p><code>Alias</code> : myChpCtrl</p>
</li>
<li>
<p><code>Input Channels</code> : _sum/EssSoc</p>
</li>
<li>
<p><code>Output Channel</code> : io0/Relay1</p>
</li>
<li>
<p><code>Low Threshold</code> 25</p>
</li>
<li>
<p><code>High Threshold</code> 75</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
_sum/EssSoc - represents the Soc channel of the ESS0,
io0/relay1 - represents the relay 1 of the relay board.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.chp.soc">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_detailed_debug_log"><a class="anchor" href="#_detailed_debug_log"></a>4.5.13. Detailed Debug Log</h4>
<div class="paragraph">
<p>Constantly shows the values of all Channels of a Component on the console. Primarily used for developing and debugging.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.debug.detailedlog">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_debug_log"><a class="anchor" href="#_debug_log"></a>4.5.14. Debug Log</h4>
<div class="paragraph">
<p>Constantly shows the most important values of all Components on the console. This is often activated by default to be able to track the running system easily.</p>
</div>
<div class="paragraph">
<p>The 'most important values' are predefined by the individual OpenEMS Components. The configuration allows to</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>additionalChannels</code></dt>
<dd>
<p>add additional Channels to the log</p>
</dd>
<dt class="hdlist1"><code>ignoreComponents</code></dt>
<dd>
<p>ignore the output of certain Components</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The priority of <code>additionalChannels</code> is higher than <code>ignoreComponents</code>, so an explicitly added Channel will be logged even if the Component has explicitly been ignored.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.debug.log">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_ess_ac_island"><a class="anchor" href="#_ess_ac_island"></a>4.5.15. ESS AC-Island</h4>
<div class="paragraph">
<p>Switches an AC PV inverter to the emergency power on grid outage.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.ess.acisland">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_ess_active_power_voltage_characteristic"><a class="anchor" href="#_ess_active_power_voltage_characteristic"></a>4.5.16. Ess Active Power Voltage Characteristic</h4>
<div class="ulist">
<ul>
<li>
<p>This controller charges/discharges an energy storage system with active power in order to keep the grid voltage within an acceptable range.</p>
</li>
<li>
<p>The active power set-point depends on the ratio of the grid voltage divided by the configured <code>nominalVoltage</code> parameter.</p>
</li>
<li>
<p>The active power per voltage ratio is defined by a poly-line graph in the <code>lineConfig</code> parameter. It takes a Json-Array of the following form:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>[
   {
      "voltageRatio":0.95,
      "power":4000
   },
   {
      "voltageRatio":0.97999,
      "power":1000
   },
   {
      "voltageRatio":0.98,
      "power":0
   },
   {
      "voltageRatio":1.0299,
      "power":0
   },
   {
      "voltageRatio":1.03,
      "power":-1000
   },
   {
      "voltageRatio":1.05,
      "power":-4000
   }
]</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>waitForHysteresis</code> parameter: active power set-point is not updated more often than the hysteresis time in seconds. Default value is 20 seconds. The purpose of this parameter is to avoid oscillation in grid voltage via frequently setting power.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/feature/develop/io.openems.edge.controller.ess.activepowervoltagecharacteristic">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_ess_delay_charge"><a class="anchor" href="#_ess_delay_charge"></a>4.5.17. ESS Delay Charge</h4>
<div class="paragraph">
<p>This Controller delays full charing of an energy storage system (ESS) to a certain hour of the day. If for example configured to delay till 4 pm, the allowed charge power is limited in a way, that 100 % State-of-Charge is reached only at 4 pm. The Controller therefor constantly watches the remaining time and remaining capacity of the ESS.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.ess.delaycharge">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_ess_delayed_sell_to_grid"><a class="anchor" href="#_ess_delayed_sell_to_grid"></a>4.5.18. ESS Delayed Sell-To-Grid</h4>
<div class="paragraph">
<p>Controls an energy storage system so, that it delays the sell-to-grid power e.g. of a photovoltaics system.</p>
</div>
<div class="paragraph">
<p>It charges the battery, when sell-to-grid power exceeds the configured "Sell-To-Grid power limit"
and discharges when sell-to-grid power is falling below "Continuous Sell-To-Grid power".</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.ess.delayedselltogrid">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_symmetric_fix_active_power"><a class="anchor" href="#_symmetric_fix_active_power"></a>4.5.19. Symmetric Fix Active Power</h4>
<div class="paragraph">
<p>Sets a fixed active power for charging/discharging of a symmetric energy storage system.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.symmetric.fixactivepower">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
<div class="paragraph">
<p>Grid Optimized Charge</p>
</div>
<div class="paragraph">
<p>Combination of the PredictiveDelayCharge and the SellToGridPowerLimit controllers:</p>
</div>
<div class="paragraph">
<p>Delays the charging of the AC or DC storage system based on predicted production and consumption given by the PredictorManager.</p>
</div>
<div class="paragraph">
<p>Even during the delayed charging, the battery is able to force charge when the sell-to-grid power exceeds the configured "Sell-To-Grid maximum power limit".
This is mainly used when only 70 percent of the maximum production is allowed to feed in to the grid.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.ess.gridoptimizedcharge">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_hybrid_ess_surplus_feed_to_grid_controller"><a class="anchor" href="#_hybrid_ess_surplus_feed_to_grid_controller"></a>4.5.20. Hybrid-Ess Surplus-Feed-To-Grid Controller</h4>
<div class="paragraph">
<p>Controls a Hybrid Battery Inverter (i.e. integrated Energy Storage System) so, that the surplus DC production of its chargers gets fed to grid.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.ess.hybrid.surplusfeedtogrid">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_ess_limit_total_discharge"><a class="anchor" href="#_ess_limit_total_discharge"></a>4.5.21. ESS Limit Total Discharge</h4>
<div class="paragraph">
<p>Limits the discharge power of an energy storage system according to its State-of-Charge, e.g. to keep energy for emergency power or to avoid deep discharge.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.ess.limittotaldischarge">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_ess_linear_power_band"><a class="anchor" href="#_ess_linear_power_band"></a>4.5.22. ESS Linear Power Band</h4>
<div class="paragraph">
<p>Executes a test cycle for an energy storage system by increasing and decreasing the charging/discharging power in given limits.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.ess.linearpowerband">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_ess_minimum_discharge_period"><a class="anchor" href="#_ess_minimum_discharge_period"></a>4.5.23. ESS Minimum Discharge Period</h4>
<div class="paragraph">
<p>Provides a minimum discharge power of the storage system for a configured time period, if a certain power peak has been reached.</p>
</div>
<div class="paragraph">
<p>This can be used in some systems where the allowed charge power has been set to zero and the storage needs a minimum discharge power for a certain time, to recognize that the storage is not full and the allowed charge power should be higher.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.ess.mindischargeperiod">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_ess_one_full_cycle"><a class="anchor" href="#_ess_one_full_cycle"></a>4.5.24. ESS One Full Cycle</h4>
<div class="paragraph">
<p>Executes a full charge/discharge cycle with an energy storage system. This can be used to let the Battery Management System (BMS) reset its reference points for State-of-Charge calculation.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.ess.onefullcycle">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_ess_predictive_delay_charge"><a class="anchor" href="#_ess_predictive_delay_charge"></a>4.5.25. ESS Predictive Delay Charge</h4>
<div class="paragraph">
<p>Delays the charging of the AC or DC storage system based on predicted production and consumption.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.ess.predictivedelaycharge">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_ess_reactive_power_voltage_characteristic"><a class="anchor" href="#_ess_reactive_power_voltage_characteristic"></a>4.5.26. Ess Reactive Power Voltage Characteristic</h4>
<div class="ulist">
<ul>
<li>
<p>This controller sets reactive power of an energy storage system in order to keep the grid voltage within an acceptable range.</p>
</li>
<li>
<p>The reactive power set-point depends on the ratio of the grid voltage divided by the configured <code>nominalVoltage</code> parameter.</p>
</li>
<li>
<p>The reactive power set-point is defined as percent of the maximum apparent power of the inverter.</p>
</li>
<li>
<p>The reactive power per voltage ratio is defined by a poly-line graph in the <code>lineConfig</code> parameter. It takes a Json-Array of the following form:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>[
   {
      "voltageRatio":0.9,
      "percent":60
   },
   {
      "voltageRatio":0.93,
      "percent":0
   },
   {
      "voltageRatio":1.07
      "percent":0
   },
   {
      "voltageRatio":1.1,
      "percent":-60
   }
]</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>waitForHysteresis</code> parameter: reactive power set-point is not updated more often than the hysteresis time in seconds. Default value is 20 seconds. The purpose of this parameter is to avoid oscillation in grid voltage via frequently setting power.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/feature/develop/io.openems.edge.controller.ess.reactivepowervoltagecharacteristic">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_ess_sell_to_grid_limit"><a class="anchor" href="#_ess_sell_to_grid_limit"></a>4.5.27. ESS Sell-To-Grid Limit</h4>
<div class="paragraph">
<p>Limits the maximum sell-to-grid power by actively charging the Ess.
Can be used to apply a 70 % limit to the sell-to-grid power according to German law.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.ess.selltogridlimit">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_evcs"><a class="anchor" href="#_evcs"></a>4.5.28. EVCS</h4>
<div class="paragraph">
<p>Controls an Electric Vehicle Charging Station (EVCS) in different modes, like "Force-Charge" and "Surplus Energy Charging".</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.evcs">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_evcs_fix_active_power"><a class="anchor" href="#_evcs_fix_active_power"></a>4.5.29. EVCS Fix Active Power</h4>
<div class="paragraph">
<p>Sets a fixed maximum charge power to an Electric Vehicle Charging Station (EVCS).</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.evcs.fixactivepower">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_generic_jsonlogic"><a class="anchor" href="#_generic_jsonlogic"></a>4.5.30. Generic JsonLogic</h4>
<div class="paragraph">
<p>The JsonLogic-Controller is a very generic Controller that allows the definition of a complex logic as a configuration at runtime, e.g. via Apache Felix Web Console.</p>
</div>
<div class="paragraph">
<p>It is based on the JsonLogic specification (<a href="http://jsonlogic.com">jsonlogic.com</a>). Logics can be defined by a rule:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
   "if":[
      {
         "&lt;":[
            {
               "var":"_sum/EssSoc"
            },
            50
         ]
      },
      [
         [
            "ess0/SetActivePowerEquals",
            5000
         ]
      ],
      [
         [
            "ess0/SetActivePowerEquals",
            -2000
         ]
      ]
   ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The input data that is referenced via <code>var</code> is automatically provided from OpenEMS Channels - e.g. as</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
   "_sum/EssSoc": 40
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example would result in:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">[
    "ess0/SetActivePowerEquals",
    5000
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>i.e. the Controller will require a set-point of 5000 W discharge on ess0.</p>
</div>
<div class="paragraph">
<p>It is also possible to write to multiple channels, by adding more arrays to the result.</p>
</div>
<div class="paragraph">
<p>Try yourself: <a href="http://jsonlogic.com/play.html">http://jsonlogic.com/play.html</a></p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.generic.jsonlogic">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_high_load_timeslot"><a class="anchor" href="#_high_load_timeslot"></a>4.5.31. High-Load Timeslot</h4>
<div class="paragraph">
<p>Controls an energy storage system for a High-Load timeslot application (German "Hochlastzeitfenster").</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.highloadtimeslot">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_io_alarm"><a class="anchor" href="#_io_alarm"></a>4.5.32. IO Alarm</h4>
<div class="paragraph">
<p>Switches a digital output, when one or more State-Channels are set. This controller can be used to signal alarms.
This controller is used to check for the State-Channels which are boolean type, which typically represents the error channels. A specific configured digital output channel can be signaled based on the configured input State-Channels(one more channels).</p>
</div>
<div class="sect4">
<h5 id="_configuration_4"><a class="anchor" href="#_configuration_4"></a>4.5.32.1. Configuration</h5>
<div class="ulist">
<ul>
<li>
<p><code>Component-ID</code> Unique ID of this Component (id), e.g. "ctrlIoAlarm0", "ctrlIoAlarm1"</p>
</li>
<li>
<p><code>Alias</code> Human-readable name of this Component; defaults to Component-ID (alias)</p>
</li>
<li>
<p><code>Input Channels</code> Addresses of the input State-Channels (inputChannelAddress), This is a array of input state channels.</p>
</li>
<li>
<p><code>Output Channel</code> Channel address of the Digital Output that should be switched (outputChannelAddress)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Multiple instances can be created in "Apache felix" during the configuration for each Output channel signal.</p>
</div>
</div>
<div class="sect4">
<h5 id="_example_configuration_2"><a class="anchor" href="#_example_configuration_2"></a>4.5.32.2. Example Configuration</h5>
<div class="ulist">
<ul>
<li>
<p><code>Component-ID</code> : ctrlIoAlarm0</p>
</li>
<li>
<p><code>Alias</code> : myIoAlarm</p>
</li>
<li>
<p><code>Input Channels</code> : [ess0/State15, ess0/State33, ess0/State43]</p>
</li>
<li>
<p><code>Output Channel</code> : io0/Relay1</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
ess0/State15 - represents the State15 channels of the ESS0,
io0/relay1 = represents the relay 1 of the KM tronic relay board.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The above example configuration describes, if any of the configured three input channels is set to "True" then a signal "True" is sent to output channel, else the "False" signal is sent to output channel.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.io.alarm">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_io_channel_single_threshold"><a class="anchor" href="#_io_channel_single_threshold"></a>4.5.33. IO Channel-Single-Threshold</h4>
<div class="paragraph">
<p>Generic Controller that sets a digital output according to the value of given Channel - e.g. turn a Relay on or off, when configured input channel/SoC is above or below a given threshold respectively.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.channelsinglethreshold">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_io_fix_digital_output"><a class="anchor" href="#_io_fix_digital_output"></a>4.5.34. IO Fix Digital Output</h4>
<div class="paragraph">
<p>Sets a digital output statically ON or OFF.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.io.fixdigitaloutput">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_io_heating_element"><a class="anchor" href="#_io_heating_element"></a>4.5.35. IO Heating Element</h4>
<div class="paragraph">
<p>Controls a three-phase heating element via Relays, according to grid active power.</p>
</div>
<div class="sect4">
<h5 id="_phase_and_level"><a class="anchor" href="#_phase_and_level"></a>4.5.35.1. Phase and Level</h5>
<div class="paragraph">
<p>The Controller distinguishes the definition of Phase and Level.
<strong>Phase</strong> represents the electrical phase L1, L2 or L3.
<strong>Level</strong> represents how many Phases are active at one point in time:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Level 1: only Phase L1 is active</p>
</li>
<li>
<p>Level 2: Phase L1 and L2 are active</p>
</li>
<li>
<p>Level 3: all three Phases are active</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_channels"><a class="anchor" href="#_channels"></a>4.5.35.2. Channels</h5>
<div class="paragraph">
<p>Example:
* the power of the heating element per phase is 1000 W
* each "x" below represents one hour</p>
</div>
<div class="paragraph">
<p>Assume the Controller was activating Phases L1, L2 and L3 during the day like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>L3|           xxx
L2|        xxxxxxxxx
L1|     xxxxxxxxxxxxxxxx
 t|------------------------</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Channel <em>Phase1Time</em></dt>
<dd>
<p><code>= 16 h = <strong>57600 sec</strong></code></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>        |--------------|</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Channel <em>Phase2Time</em></dt>
<dd>
<p><code>= 9 hours = <strong>32400 sec</strong></code></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>           |-------|</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Channel <em>Phase3Time</em></dt>
<dd>
<p><code>= 3 hours = <strong>10800 sec</strong></code></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>              |-|</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Channel <em>Level1Time</em></dt>
<dd>
<p><code>= Phase1Time - Phase2Time = 7 hours = <strong>25200 sec</strong></code></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>        |-|         |--|</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Channel <em>Level2Time</em></dt>
<dd>
<p><code>= Phase2Time - Phase3Time = 6 hours = <strong>21600 sec</strong></code></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>           |-|   |-|</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Channel <em>Level3Time</em></dt>
<dd>
<p><code>= Phase3Time = 3 hours = <strong>10800 sec</strong></code></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>              |-|</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Channel <em>TotalTime</em></dt>
<dd>
<p><code><strong>28000 Wh</strong> = 28 kWh</code></p>
</dd>
<dt class="hdlist1">Channel <em>TotalPhaseTime</em></dt>
<dd>
<p><code>= Phase1Time + Phase2Time + Phase3Time = 16 + 9 + 3 = 28 h = <strong>100800 sec</strong></code></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.io.heatingelement">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_io_sg_ready_heat_pump"><a class="anchor" href="#_io_sg_ready_heat_pump"></a>4.5.36. IO SG-Ready Heat Pump</h4>
<div class="paragraph">
<p>Controls a heat pump that implements the SG-Ready standard via two Relay contacts, depending on surplus power and battery state-of-charge.</p>
</div>
<div class="sect4">
<h5 id="_states"><a class="anchor" href="#_states"></a>4.5.36.1. States</h5>
<div class="paragraph">
<p>The Controller distinguishes the different States, according to the SG-Ready standard.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lock State</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The lock state blocks everything till an internal maximum time of (default) two hours</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Regular State</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The heat pump runs in energy-efficient standard operation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Recommendation State</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State: The heat pump runs in a more sufficient mode for space heating and hot water production, to use available surplus power</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Force-On State</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The heat pump runs in a definitive start/heat-up mode. Depending on the heat pump, heating is forced and additional heaters may be switched on</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_channels_2"><a class="anchor" href="#_channels_2"></a>4.5.36.2. Channels</h5>
<div class="paragraph">
<p>The Controller has an ongoing time counter for every state, that is started and stopped if the corresponding state is active or not.</p>
</div>
<div class="paragraph">
<p>Minimum switching time:
As an additional preventative, the controller has a minimum switching time. If a state changed, it will wait for this time (default 60 seconds) till the next state can be set.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.io.heatpump.sgready">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_pv_inverter_fix_power_limit"><a class="anchor" href="#_pv_inverter_fix_power_limit"></a>4.5.37. PV-Inverter Fix Power Limit</h4>
<div class="paragraph">
<p>Sets a fixed power limit for PV-Inverter production.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.pvinverter.fixpowerlimit">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_pv_inverter_sell_to_grid_limit"><a class="anchor" href="#_pv_inverter_sell_to_grid_limit"></a>4.5.38. PV-Inverter Sell-To-Grid limit</h4>
<div class="paragraph">
<p>Dynamically limits the Sell-To-Grid power of a PV-Inverter to a defined maximum power.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.pvinverter.selltogridlimit">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_symmetric_balancing"><a class="anchor" href="#_symmetric_balancing"></a>4.5.39. Symmetric Balancing</h4>
<div class="paragraph">
<p>Controls a symmetric energy storage system in self-consumption optimization mode.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.symmetric.balancing">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_symmetric_balancing_schedule"><a class="anchor" href="#_symmetric_balancing_schedule"></a>4.5.40. Symmetric Balancing Schedule</h4>
<div class="paragraph">
<p>Controls a symmetric energy storage system in balancing mode. The control algorithm charges or discharges the battery in order to reach a given power target set-point at the grid connection point. If the target set-point is defined as zero, the behaviour is like with self-consumption optimization.</p>
</div>
<div class="paragraph">
<p>This controller allows two ways of controlling the power target set-point:</p>
</div>
<div class="sect4">
<h5 id="_1_definition_of_a_power_target_set_point_schedule"><a class="anchor" href="#_1_definition_of_a_power_target_set_point_schedule"></a>4.5.40.1. 1. Definition of a power target set-point Schedule</h5>
<div class="paragraph">
<p>The static configuration parameter "schedule" takes a Schedule of set-points as a Json-Array. An example schedule looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">[
	{
		"startTimestamp": 1577836800,
		"duration": 900,
		"activePowerSetPoint": 0
	}, {
		"startTimestamp": 1577837700,
		"duration": 900,
		"activePowerSetPoint": -2000
	}
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>This schedule will activate a power target set-point of zero starting at the epoch time 1577836800 (i.e. <strong>seconds</strong> since 1st January 2020 00:00:00 <strong>in timezone UTC</strong>), that lasts for 900 seconds (i.e. 15 minutes).
Afterwards - from 1577837700 - for another 900 seconds a  set-point of -2000 W (i.e. feeding 2000 W to the grid) is targeted.
After the second period passes, no more charging or discharging commands are set on the battery.</p>
</div>
<div class="paragraph">
<p>The schedule configuration parameter may be updated</p>
</div>
<div class="ulist">
<ul>
<li>
<p>via a browser using the OpenEMS user interface</p>
</li>
<li>
<p>using the <a href="https://openems.github.io/openems.io/openems/latest/backend/backend-to-backend.html#_setgridconnschedule"><code>SetGridConnSchedule</code> JSON-RPC Request via OpenEMS Backend</a></p>
</li>
<li>
<p>using a direct <a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.common/src/io/openems/common/jsonrpc/request/SetGridConnScheduleRequest.java">SetGridConnScheduleRequest</a> via <a href="https://openems.github.io/openems.io/openems/latest/component-communication/index.html#_communicate_with_a_specific_edge_component">JsonApi</a></p>
</li>
<li>
<p>or using the <a href="https://github.com/OpenEMS/openems/blob/develop/ui/src/app/shared/jsonrpc/request/updateComponentConfigRequest.ts"><code>UpdateComponentConfigRequest</code> JSON-RPC Request</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Be aware that an <code>UpdateComponentConfigRequest</code> will always result in a actual configuration file being updated by Apache Felix Configuration Admin, so this command should not be used too frequently, e.g. only once per day. The <code>SetGridConnScheduleRequest</code> variant runs only in memory and is not persisted. Downside is, that if OpenEMS Edge gets restarted, the schedule is lost.</p>
</div>
</div>
<div class="sect4">
<h5 id="_2_immediate_control_of_the_power_target_set_point"><a class="anchor" href="#_2_immediate_control_of_the_power_target_set_point"></a>4.5.40.2. 2. Immediate control of the power target set-point</h5>
<div class="paragraph">
<p>The power target set-point may also be controlled directly via the <code>GridActivePowerSetPoint</code> channel. E.g. if the controller component has the Id <code>ctrlBalancingSchedule0</code> one can use e.g. the <a href="https://openems.github.io/openems.io/openems/latest/edge/controller.html#_rest_api_controller">REST-Api Controller</a> and write</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
	"value": 5000
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>to the channel <code>ctrlBalancingSchedule0/GridActivePowerSetPoint</code> (e.g. ` <a href="http://x:user@localhost:8084/rest/channel/ctrlBalancingSchedule0/GridActivePowerSetPoint`" class="bare">http://x:user@localhost:8084/rest/channel/ctrlBalancingSchedule0/GridActivePowerSetPoint`</a>), to set a temporary power target set-point of 5000.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.symmetric.balancingschedule">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_symmetric_fix_reactive_power"><a class="anchor" href="#_symmetric_fix_reactive_power"></a>4.5.41. Symmetric Fix Reactive Power</h4>
<div class="paragraph">
<p>Sets a fixed reactive power for a symmetric energy storage system.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.symmetric.fixreactivepower">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_symmetric_limit_active_power"><a class="anchor" href="#_symmetric_limit_active_power"></a>4.5.42. Symmetric Limit Active Power</h4>
<div class="paragraph">
<p>Limits the allowed active power for charging and discharging of a symmetric energy storage system.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.symmetric.limitactivepower">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_symmetric_peak_shaving"><a class="anchor" href="#_symmetric_peak_shaving"></a>4.5.43. Symmetric Peak-Shaving</h4>
<div class="paragraph">
<p>Applies peak-shaving at the grid using a symmetric energy storage system.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.symmetric.peakshaving">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_symmetric_random_power"><a class="anchor" href="#_symmetric_random_power"></a>4.5.44. Symmetric Random-Power</h4>
<div class="paragraph">
<p>Applies random charging/discharging of a symmetric energy storage system for performance tests.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.symmetric.randompower">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_symmetric_timeslot_peak_shaving"><a class="anchor" href="#_symmetric_timeslot_peak_shaving"></a>4.5.45. Symmetric Timeslot Peak-Shaving</h4>
<div class="paragraph">
<p>Applies peak-shaving within a configured timeslot at the grid using a symmetric energy storage system. Outside of the timeslot the battery recharges.</p>
</div>
<div class="paragraph">
<p>This Controller can be used for "Atypische Netznutzung" applications in Germany, e.g. "Hochlastzeitfenster".</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.controller.symmetric.timeslotpeakshaving">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_bridge"><a class="anchor" href="#_bridge"></a>4.6. Bridge</h3>
<div class="paragraph">
<p>To simplify the implementation of hardware that is connected via certain standardized physical connection layers and protocols, those are implemented as Bridges.</p>
</div>
<div class="sect3">
<h4 id="_m_bus"><a class="anchor" href="#_m_bus"></a>4.6.1. M-Bus</h4>
<div class="paragraph">
<p>M-Bus is a widely used standard for fieldbus communication. It enables connection to M-Bus devices like meters.</p>
</div>
<div class="sect4">
<h5 id="_setup_note"><a class="anchor" href="#_setup_note"></a>4.6.1.1. Setup note</h5>
<div class="paragraph">
<p>This bridge depends on jMbus, a user guide for it can be found at <a href="https://www.openmuc.org/m-bus/user-guide/" class="bare">https://www.openmuc.org/m-bus/user-guide/</a>.</p>
</div>
<div class="paragraph">
<p>Note: For jMbus to work you need to install the native part of RxTx which is a library for serial port
communication jMbus is dependent on. See paragraph 2.5 for further information.</p>
</div>
<div class="paragraph">
<p>For Linux users: In case the RxTx library cannot be found under /usr/lib/jni you can try to move all .so files of that directory to
/usr/lib (see <a href="https://community.openems.io/t/loading-library-from-external-jar/134/3">OpenEMS Community</a>).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_modbus"><a class="anchor" href="#_modbus"></a>4.6.2. Modbus</h4>
<div class="paragraph">
<p>Modbus is a widely used standard for fieldbus connections. It is used by all kinds of hardware devices like photovoltaics inverters, electric meters, and so on.</p>
</div>
<div class="sect4">
<h5 id="_modbustcp"><a class="anchor" href="#_modbustcp"></a>4.6.2.1. Modbus/TCP</h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.edge.bridge.modbus/src/io/openems/edge/bridge/modbus/BridgeModbusTcpImpl.java">Modbus/TCP <span class="icon"><i class="fa fa-code"></i></span></a></dt>
<dd>
<p><a href="https://en.wikipedia.org/wiki/Modbus">Modbus/TCP <span class="icon"><i class="fa fa-external-link"></i></span></a> for fieldbus connections via TCP/IP network.</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_modbusrtu"><a class="anchor" href="#_modbusrtu"></a>4.6.2.2. Modbus/RTU</h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.edge.bridge.modbus/src/io/openems/edge/bridge/modbus/BridgeModbusSerialImpl.java">Modbus/Serial <span class="icon"><i class="fa fa-code"></i></span></a></dt>
<dd>
<p><a href="https://en.wikipedia.org/wiki/Modbus">Modbus/RTU <span class="icon"><i class="fa fa-external-link"></i></span></a> for fieldbus connections via RS485 serial bus.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_onewire"><a class="anchor" href="#_onewire"></a>4.6.3. OneWire</h4>
<div class="paragraph">
<p>OneWire is a widely used protocol for home automation. It is used by sensors like thermometers.</p>
</div>
<div class="sect4">
<h5 id="_setup"><a class="anchor" href="#_setup"></a>4.6.3.1. Setup</h5>
<div class="paragraph">
<p>This implementation directly talks to the OneWire busmaster, e.g. a DS9490R USB dongle, without requiring the OneWire File System (OWFS).
It therefore requires the natively compiled C library by the manufacturer of the OneWire chip Maxim Integrated.
This library is then accessed using Java JNI.</p>
</div>
<div class="paragraph">
<p>To compile the native library follow the guide on <a href="https://www.maximintegrated.com/en/design/technical-documents/app-notes/5/5917.html" class="bare">https://www.maximintegrated.com/en/design/technical-documents/app-notes/5/5917.html</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download the OneWireViewer-Linux.zip file</p>
</li>
<li>
<p>Unzip the file (<code>unzip OneWireViewer-Linux.zip</code>)</p>
</li>
<li>
<p>Prepare compile environment (<code>sudo apt-get install libusb-dev build-essential</code>)</p>
</li>
<li>
<p>Install Java JDK (e.g. <code>sudo apt-get install openjdk-8-jdk</code>)</p>
</li>
<li>
<p>Compile (<code>cd OneWireViewer-Linux/PDKAdapterUSB &amp;&amp; make &amp;&amp; sudo make install</code>)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The library needs exclusive access to the busmaster.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Unload the default Linux driver: <code>rmmod ds2490</code></p>
</li>
<li>
<p>Block the driver from loading on next boot <code>echo blacklist ds2490 &gt; /etc/modprobe.d/ds2490.conf</code></p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_identifying_devices"><a class="anchor" href="#_identifying_devices"></a>4.6.3.2. Identifying devices</h5>
<div class="paragraph">
<p>The OneWire Bridge provides a JSON-RPC Request that reads all devices connected to the OneWire bus.</p>
</div>
<div class="paragraph">
<p>Example: read via OpenEMS Backend</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "method": "edgeRpc",
  "params": {
    "edgeId": "edge0",
    "payload":{
      "method": "componentJsonApi",
      "params": {
        "componentId": "onewire0",
        "payload": {
          "method": "getDevices",
          "params": {}
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example Response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc":"2.0",
  "id":"UUID",
  "result":{
    "payload":{
      "jsonrpc":"2.0",
      "id":"UUID",
      "result":{
        "devices":[
          {
            "address":"4D0000094xxxxxxx",
            "name":"DS18B20",
            "alternateName":"DS1820B, DS18B20X",
            "description":"Digital thermometer measures temperatures from -55C to 125C in 0.75 seconds (max).  +/- 0.5C accuracy between -10C and 85C. Thermometer resolution is programmable at 9, 10, 11, and 12 bits. ",
            "details":{
              "type":"TemperatureContainer",
              "temperature":17.5625
            }
          },
          {
            "address":"6F0000022xxxxxxx",
            "name":"DS2438",
            "alternateName":"Smart Battery Monitor",
            "description":"1-Wire device that integrates the total current charging or discharging through a battery and stores it in a register. It also returns the temperature (accurate to 2 degrees celsius), as well as the instantaneous current and voltage and also provides 40 bytes of EEPROM storage.",
            "details":{
              "type":"TemperatureContainer",
              "temperature":19.3125
            }
          }
        ]
      }
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_controller_5"><a class="anchor" href="#_controller_5"></a>4.7. Controller</h3>
<div class="paragraph">
<p>For the following devices driver implementations are available in OpenEMS Edge.</p>
</div>
<div class="sect3">
<h4 id="_byd_battery_box_commercial"><a class="anchor" href="#_byd_battery_box_commercial"></a>4.7.1. BYD Battery-Box Commercial</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Battery</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.battery.bydcommercial">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_battery_fenecon_home"><a class="anchor" href="#_battery_fenecon_home"></a>4.7.2. Battery FENECON Home</h4>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.battery.fenecon.home">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_soltaro_battery_rack"><a class="anchor" href="#_soltaro_battery_rack"></a>4.7.3. Soltaro Battery Rack</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Battery</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.battery.soltaro">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_kaco_blueplanet_gridsave"><a class="anchor" href="#_kaco_blueplanet_gridsave"></a>4.7.4. KACO blueplanet gridsave</h4>
<div class="ulist">
<ul>
<li>
<p>Applies to</p>
<div class="ulist">
<ul>
<li>
<p>KACO blueplanet gridsave 50.0 TL3</p>
</li>
<li>
<p>KACO blueplanet gridsave 92.0 TL3</p>
</li>
</ul>
</div>
</li>
<li>
<p>Implemented Natures</p>
<div class="ulist">
<ul>
<li>
<p>StartStoppable</p>
</li>
<li>
<p>SymmetricBatteryInverter</p>
</li>
<li>
<p>ManagedSymmetricBatteryInverter</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.batteryinverter.kaco.blueplanetgridsave">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_refustore_88k"><a class="anchor" href="#_refustore_88k"></a>4.7.5. REFUstore 88K</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>SymmetricEss</p>
</li>
<li>
<p>ManagedSymmetricEss</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://www.refu.com/storage-solutions/?L=1">Manufacturer Product Page</a>
<a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.ess.refu88">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_sunspec_pv_inverter"><a class="anchor" href="#_sunspec_pv_inverter"></a>4.7.6. SunSpec PV inverter</h4>
<div class="paragraph">
<p>Generic implementation of SunSpec PV inverters. It is tested with
- KACO blueplanet TL.3 series
- SolarEdge SE12.5K - SE27.6K</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>ManagedSymmetricPvInverter</p>
</li>
<li>
<p>SymmetricMeter</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.pvinverter.sunspec">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_bosch_bpt_s_5_hybrid"><a class="anchor" href="#_bosch_bpt_s_5_hybrid"></a>4.7.7. Bosch BPT-S 5 Hybrid</h4>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.bosch.bpts5hybrid">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_core_services_for_openems_edge"><a class="anchor" href="#_core_services_for_openems_edge"></a>4.7.8. Core services for OpenEMS Edge</h4>
<div class="sect4">
<h5 id="_componentmanager"><a class="anchor" href="#_componentmanager"></a>4.7.8.1. ComponentManager</h5>
<div class="paragraph">
<p>A service that provides easy access to OpenEMS-Components and Channels. It also provides some sub-services:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">DefaultConfigurationWorker</dt>
<dd>
<p>Applies a default configuration, i.e. activates certain OpenEMS Components that are to be enabled by default on deployment, like Modbus-TCP-Slave Api and JSON/REST Api.</p>
</dd>
<dt class="hdlist1">OsgiValidateWorker</dt>
<dd>
<p>Checks if configured Components are actually enabled.</p>
</dd>
<dt class="hdlist1">OutOfMemoryHeapDumpWorker</dt>
<dd>
<p>Checks for heap-dump files which get created if OpenEMS Edge crashed because of an OutOfMemory-Error in a previous run.</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_cycle_2"><a class="anchor" href="#_cycle_2"></a>4.7.8.2. Cycle</h5>
<div class="paragraph">
<p>Provides the core runtime Cycle of OpenEMS Edge</p>
</div>
</div>
<div class="sect4">
<h5 id="_host"><a class="anchor" href="#_host"></a>4.7.8.3. Host</h5>
<div class="paragraph">
<p>A service that provides host and operating system specific commands like configuration of TCP/IP network.</p>
</div>
</div>
<div class="sect4">
<h5 id="_meta"><a class="anchor" href="#_meta"></a>4.7.8.4. Meta</h5>
<div class="paragraph">
<p>A service that provides 'OpenemsConstants' as Channels so that they are available via Apis; example: _meta/Version for the current version of OpenEMS Edge.</p>
</div>
</div>
<div class="sect4">
<h5 id="_sum"><a class="anchor" href="#_sum"></a>4.7.8.5. Sum</h5>
<div class="paragraph">
<p>A service that holds summed up information on the power and energy flows, like aggregated production, consumption and energy storage charge/discharge.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ads_tec_storaxe_energy_storage_system"><a class="anchor" href="#_ads_tec_storaxe_energy_storage_system"></a>4.7.9. ADS-TEC StoraXe Energy Storage System</h4>
<div class="paragraph">
<p>For the moment, this is a read-only implementation. Control of the ESS is not yet supported.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>AsymmetricEss</p>
</li>
<li>
<p>SymmetricEss</p>
</li>
<li>
<p>SymmetricMeter (for Grid and PV)</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.ess.adstec.storaxe">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_fenecon_byd_container"><a class="anchor" href="#_fenecon_byd_container"></a>4.7.10. FENECON BYD Container</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>SymmetricEss</p>
</li>
<li>
<p>ManagedSymmetricEss</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.ess.byd.container">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_ess_cluster"><a class="anchor" href="#_ess_cluster"></a>4.7.11. ESS Cluster</h4>
<div class="paragraph">
<p>Combines multiple energy storage systems (ESS) to one common ESS. This way every Controller can easily work with multiple ESS in parallel. Distribution of power requests to each ESS is controlled via the <a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.ess.core/src/io/openems/edge/ess/core/power">Power-Class <span class="icon"><i class="fa fa-github"></i></span></a>.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.ess.cluster">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_fenecon_commercial_40_acdchybrid"><a class="anchor" href="#_fenecon_commercial_40_acdchybrid"></a>4.7.12. FENECON Commercial 40 AC/DC/Hybrid</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>SymmetricEss</p>
</li>
<li>
<p>ManagedSymmetricEss</p>
</li>
<li>
<p>EssDcCharger</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.ess.fenecon.commercial40">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_generic_energy_storage_system"><a class="anchor" href="#_generic_energy_storage_system"></a>4.7.13. Generic Energy Storage System</h4>
<div class="paragraph">
<p>Represents an Energy Storage System consisting of a Battery-Inverter and a Battery.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.ess.generic">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_kaco_blueplanet_gridsave_50_0_tl3"><a class="anchor" href="#_kaco_blueplanet_gridsave_50_0_tl3"></a>4.7.14. KACO blueplanet gridsave 50.0 TL3</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>SymmetricEss</p>
</li>
<li>
<p>ManagedSymmetricEss</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.ess.kaco.blueplanet.gridsave50">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_maschinenfabrik_rheinhausen_mr_gridcon"><a class="anchor" href="#_maschinenfabrik_rheinhausen_mr_gridcon"></a>4.7.15. Maschinenfabrik Rheinhausen (MR) Gridcon</h4>
<div class="paragraph">
<p>Implemented Natures
- SymmetricEss
- ManagedSymmetricEss</p>
</div>
<div class="paragraph">
<p>Good Settings for PID: 0.3  0.15  0</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.ess.mr.gridcon">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_sinexcel_battery_inverter"><a class="anchor" href="#_sinexcel_battery_inverter"></a>4.7.16. Sinexcel Battery Inverter</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>SymmetricEss</p>
</li>
<li>
<p>ManagedSymmetricEss</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.ess.sinexcel">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_sma_sunnyisland_6_0h"><a class="anchor" href="#_sma_sunnyisland_6_0h"></a>4.7.17. SMA SunnyIsland 6.0H</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>SymmetricEss</p>
</li>
<li>
<p>ManagedSymmetricEss</p>
</li>
<li>
<p>AsymmetricEss</p>
</li>
<li>
<p>ManagedAsymmetricEss</p>
</li>
<li>
<p>SinglePhaseEss</p>
</li>
<li>
<p>ManagedSinglePhaseEss</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.ess.sma">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_evcs_cluster"><a class="anchor" href="#_evcs_cluster"></a>4.7.18. EVCS Cluster</h4>
<div class="paragraph">
<p>Distributes the charging power (Depending on the implementation) to the priorized charging stations.
The implementations calculate the maximum power that can be used by all charging stations.</p>
</div>
<div class="paragraph">
<p>Possible Cluster implementations:</p>
</div>
<div class="paragraph">
<p><strong>Cluster for peak shaving</strong><br>
The peak shaving cluster is calculating the power depending on the grid power that can be used per phase, the maximum allowed storage power and the current values of grid, storage and EVCS consumption.</p>
</div>
<div class="paragraph">
<p><strong>Cluster for self consumption</strong><br>
The self consumption cluster is calculating the power depending on the excess power.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.evcs.cluster">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_evcs_core"><a class="anchor" href="#_evcs_core"></a>4.7.19. EVCS Core</h4>
<div class="paragraph">
<p>Core services for electric vehicle charging.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.evcs.core">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_go_e_charger_home_charging_station"><a class="anchor" href="#_go_e_charger_home_charging_station"></a>4.7.20. Go-e Charger Home Charging Station</h4>
<div class="paragraph">
<p>This component implements the go-e charger home charging station, which is controlled and read out using the Rest-API protocol.
It collects all relevant informations into the given Nature Channels and its own Channels and sends charging commands that have been set by another controllers.</p>
</div>
<div class="paragraph">
<p>Implemented Natures:
* Evcs (Electric Vehicle Charging Station)
* ManagedEvcs</p>
</div>
</div>
<div class="sect3">
<h4 id="_hardy_barth_charging_station_salia"><a class="anchor" href="#_hardy_barth_charging_station_salia"></a>4.7.21. Hardy Barth Charging Station (Salia)</h4>
<div class="paragraph">
<p>This component implements the Salia charging station by the manufacturer Hardy Barth: <a href="https://www.echarge.de/de/home" class="bare">https://www.echarge.de/de/home</a></p>
</div>
<div class="paragraph">
<p>Implemented Natures:
* Evcs (Electric Vehicle Charging Station)
* ManagedEvcs</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.evcs.hardybarth">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_keba_kecontact_c_series_charging_station"><a class="anchor" href="#_keba_kecontact_c_series_charging_station"></a>4.7.22. KEBA KeContact c-series Charging Station</h4>
<div class="paragraph">
<p>This component implements the KEBA c-series charging station, which is controlled and read out using the proprietary UDP protocol.
It collects all relevant information into the given Nature Channels and its own Channels and sends charging commands that have been set by another controllers.</p>
</div>
<div class="paragraph">
<p>Implemented Natures:
* Evcs (Electric Vehicle Charging Station)
* ManagedEvcs</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.evcs.keba.kecontact">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_abl_charging_station"><a class="anchor" href="#_abl_charging_station"></a>4.7.23. ABL Charging Station</h4>
<div class="paragraph">
<p>This component implements the ABL EMH 3 series charging station, which is controlled and read out using the OCPP protocol.
It provides specific information for the AbstractOcppEvcsComponent.</p>
</div>
<div class="paragraph">
<p>Implemented Natures:
* Evcs (Electric Vehicle Charging Station)
* MeasuringEvcs</p>
</div>
<div class="paragraph">
<p>Extended abstract class:
* AbstractOcppEvcsComponent</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.evcs.ocpp.abl">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_electric_vehicle_charging_station_ocpp_common"><a class="anchor" href="#_electric_vehicle_charging_station_ocpp_common"></a>4.7.24. Electric Vehicle Charging Station OCPP Common</h4>
<div class="paragraph">
<p>The Open Charge Point Protocol (OCPP) is an application protocol for communication between
Electric vehicle charging stations (EVCS) and a central management system.</p>
</div>
<div class="paragraph">
<p>The whole bundle contains a library of the OCPP functions.
It also provides a default abstract ocpp EVCS component that can be used by every specific charging station and a OcppServer interface that provides a minimum functionality, to be able to send data to a charging station.</p>
</div>
<div class="paragraph">
<p>Implemented Natures:
* Evcs (Electric Vehicle Charging Station
* MeasuringEvcs (Can get measured information)</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.evcs.ocpp.core">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_ies_keywatt_charging_station"><a class="anchor" href="#_ies_keywatt_charging_station"></a>4.7.25. IES KeyWatt Charging Station</h4>
<div class="paragraph">
<p>This component implements the IES KeyWatt CCS charging station with a single plug, which is controlled and read out using the OCPP protocol.
It provides specific information for the AbstractOcppEvcsComponent.</p>
</div>
<div class="paragraph">
<p>Implemented Natures:
* Evcs (Electric Vehicle Charging Station
* ManagedEvcs
* MeasuringEvcs (Can get measured information)</p>
</div>
<div class="paragraph">
<p>Extended abstract class:
* AbstractOcppEvcsComponent</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.evcs.ocpp.ies.keywatt.singleccs">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_ocpp_server"><a class="anchor" href="#_ocpp_server"></a>4.7.26. OCPP Server</h4>
<div class="paragraph">
<p>The OCPP Server is implementing a central management system.
The server maintains connections to the EVCS&#8217;s, i.e.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>connects to the charging stations</p>
</li>
<li>
<p>distributes their information to each EVCS component</p>
</li>
<li>
<p>send commands to the charging stations</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.evcs.ocpp.server">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_fenecon_dess"><a class="anchor" href="#_fenecon_dess"></a>4.7.27. FENECON DESS</h4>
<div class="paragraph">
<p>Applies to multiple similar products like the FENECON by BYD PRO Hybrid.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>SymmetricEss</p>
</li>
<li>
<p>AsymmetricEss</p>
</li>
<li>
<p>EssDcCharger</p>
</li>
<li>
<p>AsymmetricMeter (for Grid and AC-connected PV)</p>
</li>
<li>
<p>SymmetricMeter (for Grid and AC-connected PV)</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.fenecon.dess">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_fenecon_mini_3_3_3_6"><a class="anchor" href="#_fenecon_mini_3_3_3_6"></a>4.7.28. FENECON Mini 3-3 | 3-6</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>SinglePhaseEss</p>
</li>
<li>
<p>AsymmetricEss</p>
</li>
<li>
<p>SymmetricEss</p>
</li>
<li>
<p>SymmetricMeter (for Grid and PV)</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.fenecon.mini">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_fenecon_pro_9_12"><a class="anchor" href="#_fenecon_pro_9_12"></a>4.7.29. FENECON Pro 9-12</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>SymmetricEss</p>
</li>
<li>
<p>ManagedSymmetricEss</p>
</li>
<li>
<p>AsymmetricEss</p>
</li>
<li>
<p>ManagedAsymmetricEss</p>
</li>
<li>
<p>AsymmetricMeter (for PV)</p>
</li>
<li>
<p>SymmetricMeter (for PV)</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.fenecon.pro">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_goodwe_et_and_bt_series_hybrid_inverters"><a class="anchor" href="#_goodwe_et_and_bt_series_hybrid_inverters"></a>4.7.30. GoodWe ET and BT-Series Hybrid Inverters</h4>
<div class="paragraph">
<p>Ess:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SymmetricEss</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Charger: (ET only)</p>
</div>
<div class="ulist">
<ul>
<li>
<p>EssDcCharger</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Grid-Meter:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SymmetricMeter</p>
</li>
<li>
<p>AsymmetricMeter</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.goodwe">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_kmtronic_modbus_relay_board"><a class="anchor" href="#_kmtronic_modbus_relay_board"></a>4.7.31. KMtronic Modbus Relay Board</h4>
<div class="paragraph">
<p>This bundle implements the Kmtronic Modbus Relay board. Relay outputs can be used to turn ON/OFF lights, motors and signal alarms. Implementations are for 4 and 8 relais.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>DigitalOutput</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.io.kmtronic">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_revolutionpi_digital_io_module"><a class="anchor" href="#_revolutionpi_digital_io_module"></a>4.7.32. RevolutionPi Digital IO Module</h4>
<div class="paragraph">
<p>This bundle implements the Kunbus RevolutionPI DigitalIO enhancement board. It can be used to turn ON/OFF a data output or to read in digital data input. It provides 14 digital input and 14 digital output channels.</p>
</div>
<div class="paragraph">
<p>Implemented Natures:
- DigitalOutput
- DigitalInput</p>
</div>
<div class="sect4">
<h5 id="_dependencies"><a class="anchor" href="#_dependencies"></a>4.7.32.1. Dependencies</h5>
<div class="paragraph">
<p>The RevolutionPi Digital IO OpenEms Bundle depends on the librevpi-dio-java git library project. A binary version of this library is already included in this OpenEMS Bundle. See <a href="https://github.com/clehne/librevpi-dio-java" class="bare">https://github.com/clehne/librevpi-dio-java</a>  for more information.</p>
</div>
</div>
<div class="sect4">
<h5 id="_notes"><a class="anchor" href="#_notes"></a>4.7.32.2. Notes</h5>
<div class="paragraph">
<p><strong>Prepare Kunbus RevPi:</strong></p>
</div>
<div class="paragraph">
<p>The Digital IO hardware enhancement module on your Kunbus RevolutionPi system needs to be enabled before starting OpenEMS (see Kunbus-Website for configuration settings).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_shelly_wifi_relay_switch"><a class="anchor" href="#_shelly_wifi_relay_switch"></a>4.7.33. Shelly WiFi Relay Switch</h4>
<div class="paragraph">
<p>This bundle implements Shelly WiFi Relay Switches.</p>
</div>
<div class="paragraph">
<p>Compatible with
- <a href="https://shelly.cloud/products/shelly-25-smart-home-automation-relay/">Shelly 2.5</a>
- <a href="https://shelly.cloud/products/shelly-plug-s-smart-home-automation-device/">Shelly Plug S</a></p>
</div>
<div class="paragraph">
<p>Implemented Natures
- DigitalOutput</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.io.shelly">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_wago_fieldbus_coupler_750_352"><a class="anchor" href="#_wago_fieldbus_coupler_750_352"></a>4.7.34. WAGO Fieldbus Coupler 750-352</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>DigitalOutput</p>
</li>
<li>
<p>DigitalInput</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>This component reads the current WAGO fieldbus coupler configuration and dynamically creates its Input and Output Channels accordingly.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Make sure to update the WAGO fieldbus coupler configuration before activating this component.
Open the WAGO fieldbus web interface, click <strong>"IO config"</strong> and <strong>"create ea-config.xml"</strong> to update the configuration. Default username is <code>admin</code>, default password is <code>wago</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following examples assume the Component-ID is <code>io0</code> and the addresses are valid for the first WAGO extension.
For extensions 2, 3,&#8230;&#8203; just increase the number behind <code>M</code>.
Channel names follow this logic:</p>
</div>
<div class="sect4">
<h5 id="_wago_750_523_1_channel_relay_output"><a class="anchor" href="#_wago_750_523_1_channel_relay_output"></a>4.7.34.1. WAGO 750-523 "1-channel relay output"</h5>
<div class="paragraph">
<p><a href="https://www.wago.com/global/i-o-systems/1-channel-relay-output/p/750-523">wago.com <span class="icon"><i class="fa fa-external-link"></i></span></a></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>io0/RelayM1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input/Output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the relay</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>io0/RelayM1Hand</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">state of the manual switch</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_wago_750_501_2_channel_digital_output"><a class="anchor" href="#_wago_750_501_2_channel_digital_output"></a>4.7.34.2. WAGO 750-501 "2-channel digital output"</h5>
<div class="paragraph">
<p><a href="https://www.wago.com/global/i-o-systems/2-channel-digital-output/p/750-501">wago.com <span class="icon"><i class="fa fa-external-link"></i></span></a></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>io0/DigitalOutputM1C1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input/Output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the first digital output</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>io0/DigitalOutputM1C2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input/Output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the first digital output</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_wago_750_400_2_channel_digital_input"><a class="anchor" href="#_wago_750_400_2_channel_digital_input"></a>4.7.34.3. WAGO 750-400 "2-channel digital input"</h5>
<div class="paragraph">
<p><a href="https://www.wago.com/global/i-o-systems/2-channel-digital-input/p/750-400">wago.com <span class="icon"><i class="fa fa-external-link"></i></span></a></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>io0/DigitalInputM1C1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the first digital input</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>io0/DigitalInputM1C2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the second digital input</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.io.wago">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_kostal_piko"><a class="anchor" href="#_kostal_piko"></a>4.7.35. KOSTAL PIKO</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>SymmetricEss</p>
</li>
<li>
<p>SymmetricMeter (for Grid meter)</p>
</li>
<li>
<p>EssDcCharger (for PV)</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.kostal.piko">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_abb_b23_meter"><a class="anchor" href="#_abb_b23_meter"></a>4.7.36. ABB B23 Meter</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>SymmetricMeter</p>
</li>
<li>
<p>AsymmetricMeter</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.meter.abb">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_artemes_am_2"><a class="anchor" href="#_artemes_am_2"></a>4.7.37. Artemes AM-2</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>SymmetricMeter</p>
</li>
<li>
<p>AsymmetricMeter</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.meter.artemes.am2">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_b_control_tq_systems_em300_meter"><a class="anchor" href="#_b_control_tq_systems_em300_meter"></a>4.7.38. B-Control | TQ-Systems EM300 Meter</h4>
<div class="paragraph">
<p>Implemented Natures</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SymmetricMeter</p>
</li>
<li>
<p>AsymmetricMeter</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.meter.bcontrol.em300">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_carlo_gavazzi_em300_meter"><a class="anchor" href="#_carlo_gavazzi_em300_meter"></a>4.7.39. Carlo Gavazzi EM300 Meter</h4>
<div class="paragraph">
<p>Applies to
- CARLO GAVAZZI EM330
- CARLO GAVAZZI EM340</p>
</div>
<div class="paragraph">
<p>Implemented Natures
- SymmetricMeter
- AsymmetricMeter</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.meter.carlo.gavazzi.em300">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_discovergy_smart_meter"><a class="anchor" href="#_discovergy_smart_meter"></a>4.7.40. Discovergy Smart-Meter</h4>
<div class="paragraph">
<p>Reads data of a Discovergy Smart-Meter via online REST-Api. See <a href="https://api.discovergy.com" class="bare">https://api.discovergy.com</a> for details.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>SymmetricMeter</p>
</li>
<li>
<p>AsymmetricMeter</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.meter.discovergy">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_janitza_meters_umg_96rm_e_umg_604"><a class="anchor" href="#_janitza_meters_umg_96rm_e_umg_604"></a>4.7.41. Janitza Meters UMG 96RM-E | UMG 604</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>SymmetricMeter</p>
</li>
<li>
<p>AsymmetricMeter</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.meter.janitza">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_microcare_sdm_630_meter"><a class="anchor" href="#_microcare_sdm_630_meter"></a>4.7.42. Microcare SDM 630 Meter</h4>
<div class="paragraph">
<p>This implementation is functionally compatible with a number of energy meters with the name "SDM 630".</p>
</div>
<div class="paragraph">
<p>Implemented Natures</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SymmetricMeter</p>
</li>
<li>
<p>AsymmetricMeter</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.meter.microcare.sdm630">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_pq_plus_umd_97_meter"><a class="anchor" href="#_pq_plus_umd_97_meter"></a>4.7.43. PQ Plus UMD 97 Meter</h4>
<div class="paragraph">
<p>Applies also to UMD 96, UMD 97, UMD 98, UMD 807, UMD 701, UMD 704, UMD 705, UMD 706, UMD 707, UMD 709, UMD 710, UMD 913, UMC 26</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>SymmetricMeter</p>
</li>
<li>
<p>AsymmetricMeter</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.meter.pqplus.umd97">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_schneider_acti9_smartlink_meter"><a class="anchor" href="#_schneider_acti9_smartlink_meter"></a>4.7.44. Schneider Acti9 Smartlink Meter</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>SymmetricMeter</p>
</li>
<li>
<p>AsymmetricMeter</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>To configure the meter, first add a modbus tcp bridge connecting to the correct IP address, then configure this meter to use the configured modbus bridge. The unit ID is by default 1.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.meter.schneider.acti9.smartlink">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_sma_sunny_home_manager_2_0_integrated_meter"><a class="anchor" href="#_sma_sunny_home_manager_2_0_integrated_meter"></a>4.7.45. SMA Sunny Home Manager 2.0 Integrated Meter</h4>
<div class="paragraph">
<p>This implementation uses the integrated energy meter of the SMA Sunny Home Manager 2.0
Data needs to polled through Modbus from an attached SMA inverter as the HM2.0 does not have a local API on the device itself</p>
</div>
<div class="paragraph">
<p>Implemented Natures</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SymmetricMeter</p>
</li>
<li>
<p>AsymmetricMeter</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.meter.sma.shm20">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_socomec_meter"><a class="anchor" href="#_socomec_meter"></a>4.7.46. SOCOMEC Meter</h4>
<div class="paragraph">
<p>Just configure <code>Meter.Socomec.Singlephase</code> or <code>Meter.Socomec.Threephase</code>. The actual type and modbus protocol of the Socomec meter is identified automatically.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Implemented singlephase meters:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.socomec.com/range-single-circuit-energy-meter_en.html?product=/countis-e10-11-12_en.html">Socomec Countis E14</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Implemented threephase meters:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.socomec.com/range-single-circuit-energy-meter_en.html?product=/countis-e20-21_en.html">Socomec Countis E23/E24/E27/E28</a></p>
</li>
<li>
<p><a href="https://www.socomec.com/range-single-circuit-energy-meter_en.html?product=/countis-e30-31-32-33_en.html">Socomec Countis E34</a></p>
</li>
<li>
<p><a href="https://www.socomec.com/range-single-circuit-energy-meter_en.html?product=/countis-e40-41-42-44_en.html">Socomec Countis E44</a></p>
</li>
<li>
<p><a href="https://www.socomec.com/range-single-circuit-multifunction-meters_en.html?product=/diris-a10_en.html">Socomec Diris A10</a></p>
</li>
<li>
<p><a href="https://www.socomec.com/range-single-circuit-multifunction-meters_en.html?product=/diris-a14_en.html">Socomec Diris A14</a></p>
</li>
<li>
<p><a href="https://www.socomec.com/range-single-circuit-multifunction-meters_en.html?product=/diris-b_en.html">Socomec Diris B30</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Implemented Natures:</p>
<div class="ulist">
<ul>
<li>
<p>SymmetricMeter</p>
</li>
<li>
<p>AsymmetricMeter</p>
</li>
<li>
<p>SinglephaseMeter</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.meter.socomec">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_sunspec_meter"><a class="anchor" href="#_sunspec_meter"></a>4.7.47. SunSpec Meter</h4>
<div class="paragraph">
<p>Generic implementation of SunSpec Meters.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>AsymmetricMeter</p>
</li>
<li>
<p>SymmetricMeter</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.meter.sunspec">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_virtual_symmetric_subtract"><a class="anchor" href="#_virtual_symmetric_subtract"></a>4.7.48. Virtual Symmetric Subtract</h4>
<div class="paragraph">
<p>This is a virtual meter built from subtracting other meters or energy storage systems.</p>
</div>
<div class="paragraph">
<p>The logic calculates <code>Minuend - Subtrahend1 - Subtrahend2 - &#8230;&#8203;</code>.</p>
</div>
<div class="paragraph">
<p>Example use-case: create a virtual Grid-Meter from Production-Meter, Consumption-Meter and Energy Storage System (ESS)
- by definition Consumption is defined as `Consumption = ESS + Grid + Production (AC)
- or: `Grid = Consumption - ESS - Production (AC)
- this can be achieved by configuring the Consumption-Meter as Minuend and Production-Meter and ESS as Subtrahends.</p>
</div>
</div>
<div class="sect3">
<h4 id="_virtual_symmetric_add"><a class="anchor" href="#_virtual_symmetric_add"></a>4.7.49. Virtual Symmetric Add</h4>
<div class="paragraph">
<p>This is a virtual meter which is used to sum up the values from multiple symmetric meters. The use case for this feature is, Usually when there are multiple meters reading values from different systems, The average values from the systems make more sense for calculation and statistics.</p>
</div>
<div class="paragraph">
<p>Implemented Natures
- SymmetricMeter</p>
</div>
<div class="sect4">
<h5 id="_example_configuration_3"><a class="anchor" href="#_example_configuration_3"></a>4.7.49.1. Example Configuration</h5>
<div class="ulist">
<ul>
<li>
<p><code>Component-ID</code> : meter0</p>
</li>
<li>
<p><code>Alias</code> : virtualMeter</p>
</li>
<li>
<p><code>Meter-Type</code> : PRODUCTION</p>
</li>
<li>
<p><code>Meter IDs</code> : [meter1, meter2, meter3]</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Meter IDs is a list of the meters which needs summing of the values.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The above example configuration describes, The values from the three meters configured (meter1, meter2, meter3) are summed up and average values is set to the corresponding channel address.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.meter.virtual">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_weidmueller_525_meter"><a class="anchor" href="#_weidmueller_525_meter"></a>4.7.50. Weidmueller 525 Meter</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>SymmetricMeter</p>
</li>
<li>
<p>AsymmetricMeter</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.meter.weidmueller">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_onewire_thermometer"><a class="anchor" href="#_onewire_thermometer"></a>4.7.51. OneWire Thermometer</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Thermometer</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.onewire.thermometer">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_persistence_model_predictor"><a class="anchor" href="#_persistence_model_predictor"></a>4.7.52. Persistence-Model Predictor</h4>
<div class="paragraph">
<p>Predicts values using the 'same-as-last-day' approach.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.predictor.holtwinters">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_similarday_model_predictor"><a class="anchor" href="#_similarday_model_predictor"></a>4.7.53. Similarday-Model Predictor</h4>
<div class="paragraph">
<p>This predictor uses "Similar day technique" for prediction.
This particular implmentation requires mainly two inputs, which are
* Num of past weeks (n)
* The channels address data, which needs to predicted.</p>
</div>
<div class="paragraph">
<p>The similar-day models predicts by calculating the average of a 'n' number of previous period values.</p>
</div>
<div class="paragraph">
<p><em>example</em>: the next monday predictions values is equal to average of past n = 4 monday values.</p>
</div>
<div class="paragraph">
<p>This predictor is mainly used for predicting the Consumption power and energy. And the Accuracy of the model is scientifically verified within <a href="https://openems.io/research/emsig/" target="_blank" rel="noopener">EMSIG project</a>.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.predictor.similardaymodel">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_pv_inverter_cluster"><a class="anchor" href="#_pv_inverter_cluster"></a>4.7.54. PV-Inverter Cluster</h4>
<div class="paragraph">
<p>Combines multiple PV-Inverters to one common PV-Inverter. This way every Controller can easily work with multiple PV-Inverters in parallel.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.pvinverter.cluster">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_kaco_blueplanet_pv_inverter"><a class="anchor" href="#_kaco_blueplanet_pv_inverter"></a>4.7.55. KACO blueplanet PV inverter</h4>
<div class="paragraph">
<p>Implementation of the KACO blueplanet series PV inverters.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>ManagedSymmetricPvInverter</p>
</li>
<li>
<p>SymmetricMeter</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.pvinverter.kaco.blueplanet">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_sma_sunny_tripower_pv_inverter"><a class="anchor" href="#_sma_sunny_tripower_pv_inverter"></a>4.7.56. SMA Sunny Tripower PV inverter</h4>
<div class="paragraph">
<p>Implementation of the SMA Sunny Tripower PV inverters.</p>
</div>
<div class="paragraph">
<p>Tested on
- <a href="https://www.sma.de/produkte/solar-wechselrichter/sunny-tripower-80-100.html">SMA SUNNY TRIPOWER 8.0 / 10.0 </a>
- <a href="https://www.sma.de/produkte/solar-wechselrichter/sunny-tripower-15000tl-20000tl-25000tl.html">SMA SUNNY TRIPOWER 15000TL / 20000TL / 25000TL</a></p>
</div>
<div class="paragraph">
<p>Implemented Natures:
- SymmetricMeter
- ManagedSymmetricPvInverter</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.pvinverter.sma">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_solar_log"><a class="anchor" href="#_solar_log"></a>4.7.57. Solar-Log</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>SymmetricPvInverter</p>
</li>
<li>
<p>SymmetricMeter</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.pvinverter.solarlog">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_sunspec_pv_inverter_2"><a class="anchor" href="#_sunspec_pv_inverter_2"></a>4.7.58. SunSpec PV inverter</h4>
<div class="paragraph">
<p>Generic implementation of SunSpec PV inverters. It is tested with
- KACO blueplanet TL.3 series
- SolarEdge SE12.5K - SE27.6K</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>ManagedSymmetricPvInverter</p>
</li>
<li>
<p>SymmetricMeter</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.pvinverter.sunspec">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_simulated_openems_components"><a class="anchor" href="#_simulated_openems_components"></a>4.7.59. Simulated OpenEMS Components</h4>
<div class="paragraph">
<p>This bundle provides simulated OpenEMS Components for the Natures. They are useful for testing and demoing without real hardware.</p>
</div>
<div class="sect4">
<h5 id="_simulator_app"><a class="anchor" href="#_simulator_app"></a>4.7.59.1. Simulator-App</h5>
<div class="paragraph">
<p>The Simulator-App is a very specific component that needs to be handled with care. It provides a full simulation environment to run an OpenEMS Edge instance in simulated realtime environment. After you ran a Simulation, you will receive the simulation result as a JSON. Also the simulation result can be viewed in OpenEMS UI.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Be aware that the SimulatorApp Component takes control over the complete OpenEMS Edge Application, i.e. if you enable it, it is going to <strong>delete all existing Component configurations</strong>!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To run a simulation:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run OpenEMS Edge using the EdgeApp.bndrun</p>
</li>
<li>
<p>Open up Apache Felix Web Console and</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>activate a "Controller Api REST/JSON Read-Write"</p>
</li>
<li>
<p>activate a "Simulator App"</p>
</li>
</ol>
</div>
</li>
<li>
<p>Send a <a href="https://openems.github.io/openems.io/openems/latest/edge/controller.html#_endpoint_jsonrpc">JSON-RPC Request</a> like the following, providing full configurations for all required OpenEMS Edge Components</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
   "method":"componentJsonApi",
   "params":{
      "componentId":"_simulator",
      "payload":{
         "method":"executeSimulation",
         "params":{
            "components":[
               {
                  "factoryPid":"Scheduler.AllAlphabetically",
                  "properties":[
                     {
                        "name":"id",
                        "value":"scheduler0"
                     }
                  ]
               },
               {
                  "factoryPid":"Simulator.GridMeter.Reacting",
                  "properties":[
                     {
                        "name":"id",
                        "value":"meter0"
                     }
                  ]
               },
               {
                  "factoryPid":"Simulator.NRCMeter.Acting",
                  "properties":[
                     {
                        "name":"id",
                        "value":"meter1"
                     },
                     {
                        "name":"alias",
                        "value":"Consumption"
                     },
                     {
                        "name":"datasource.id",
                        "value":"_simulator"
                     }
                  ]
               },
               {
                  "factoryPid":"Simulator.ProductionMeter.Acting",
                  "properties":[
                     {
                        "name":"id",
                        "value":"meter2"
                     },
                     {
                        "name":"alias",
                        "value":"South Roof"
                     },
                     {
                        "name":"datasource.id",
                        "value":"_simulator"
                     }
                  ]
               },
               {
                  "factoryPid":"Simulator.EssSymmetric.Reacting",
                  "properties":[
                     {
                        "name":"id",
                        "value":"ess0"
                     },
                     {
                        "name":"maxApparentPower",
                        "value":10000
                     },
                     {
                        "name":"capacity",
                        "value":10200
                     },
                     {
                        "name":"initialSoc",
                        "value":50
                     }
                  ]
               },
               {
                  "factoryPid":"Controller.Symmetric.Balancing",
                  "properties":[
                     {
                        "name":"id",
                        "value":"ctrlBalancing0"
                     },
                     {
                        "name":"ess.id",
                        "value":"ess0"
                     },
                     {
                        "name":"meter.id",
                        "value":"meter0"
                     }
                  ]
               }
            ],
            "clock":{
               "start":"2000-01-01T00:00:00.00Z",
               "end":"2000-01-08T00:00:00.00Z",
               "timeleapPerCycle":900000,
               "executeCycleTwice":true
            },
            "profiles":{
               "meter1/ActivePower": [436,404,373,344,316,290,267,248,236,227,220,216,211,207,203,199,196,193,192,191,191,191,193,195,198,201,206,211,219,232,254,290,342,405,474,543,607,666,719,767,810,849,886,924,962,999,1029,1049,1055,1047,1025,990,944,890,833,779,732,692,658,630,607,588,572,555,539,527,524,535,562,602,647,692,731,764,795,825,854,878,892,887,861,820,775,733,704,683,666,646,621,591,556,518,479,440,402,364,436,404,374,345,316,290,267,249,236,227,220,216,211,207,203,199,196,193,192,191,191,191,193,195,198,201,206,211,219,232,255,291,342,405,475,544,608,667,720,768,811,850,888,926,964,1000,1030,1050,1056,1048,1027,992,945,891,834,780,733,693,659,631,608,589,572,556,540,528,525,536,563,603,648,693,732,765,796,826,855,880,893,888,862,821,776,735,705,684,667,647,622,591,556,519,480,441,402,365,338,304,274,249,231,218,209,204,200,198,197,195,194,193,191,191,192,194,196,200,204,215,238,279,340,413,489,557,607,642,663,673,676,673,665,653,638,622,607,594,586,580,578,578,580,584,593,607,626,647,664,673,670,658,639,619,600,583,568,553,539,527,517,511,510,515,527,549,579,618,662,711,761,810,855,893,922,940,943,931,902,862,818,777,744,716,691,665,635,602,566,528,489,450,412,374,338,304,275,250,231,218,210,204,201,198,197,196,194,193,192,192,192,194,197,200,205,216,239,279,340,414,490,558,608,643,664,674,677,674,666,654,639,623,608,595,587,581,579,579,581,585,594,608,627,648,665,674,671,659,640,620,601,584,569,554,540,528,518,512,511,516,528,550,580,619,663,712,762,811,856,895,924,941,945,932,904,864,820,778,745,717,692,666,636,603,567,529,490,451,413,375,338,304,275,250,231,218,210,204,201,198,197,196,194,193,192,192,192,194,197,200,205,216,239,279,340,415,491,558,609,643,664,675,678,675,666,654,639,624,608,596,587,582,579,579,581,586,594,608,628,649,666,675,672,659,641,621,602,585,569,554,540,528,518,513,512,517,529,550,581,619,664,712,763,812,857,896,925,942,946,933,905,865,820,779,745,718,693,667,637,603,567,529,491,452,413,375,339,305,275,250,232,219,210,204,201,198,197,196,194,193,192,192,192,194,197,200,205,216,239,280,341,415,491,559,609,644,665,676,679,676,667,655,640,624,609,596,588,582,580,580,582,586,595,609,628,649,667,676,673,660,641,621,602,585,570,555,541,529,519,513,512,517,529,551,581,620,665,713,764,813,858,897,926,943,947,934,906,865,821,780,746,719,694,668,637,604,568,530,491,452,413,375,339,305,275,250,232,219,210,205,201,199,198,196,195,194,192,192,193,195,197,201,205,216,239,280,341,415,492,559,610,645,666,676,679,676,668,656,641,625,609,597,588,583,580,580,582,587,595,609,629,650,667,676,673,661,642,622,603,586,570,555,541,529,519,514,513,518,530,551,582,621,665,714,764,814,859,897,927,944,948,935,906,866,822,781,747,719,694,668,638,604,568,530,492,452,414,376],
               "meter2/ActivePower": [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,24,100,250,277,345,449,457,535,530,575,770,862,720,779,808,638,552,457,440,574,537,499,356,216,267,180,180,147,102,19,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,23,105,162,223,271,309,370,431,463,514,481,463,516,467,406,375,361,401,387,372,345,334,337,312,275,229,184,141,96,20,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,20,74,134,173,209,254,275,302,331,380,419,437,471,410,441,444,410,394,400,396,384,387,391,350,291,260,208,140,74,20,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,24,130,215,278,378,443,529,534,568,797,726,618,766,703,802,809,755,783,682,633,672,590,629,515,523,403,318,251,171,31,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,26,56,336,1979,945,2897,3580,2510,3097,3499,5616,6327,2631,898,3859,3909,4931,3683,5996,1777,3615,3415,1601,1254,4954,4145,3426,1163,101,457,27,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,21,65,25,48,84,108,125,123,99,84,119,214,202,183,104,151,450,881,1878,3424,5211,4329,3986,1796,1904,1618,1173,646,758,50,13,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13,35,104,163,246,349,329,406,387,379,457,396,488,530,540,591,835,774,740,569,549,542,524,549,471,446,337,234,192,110,30,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
            },
            "collect":[
               "_sum/GridActivePower",
               "_sum/EssActivePower",
               "_sum/ProductionActivePower",
               "_sum/ConsumptionActivePower",
               "_sum/EssSoc"
            ]
         }
      }
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.simulator">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_solaredge_pv_inverter_grid_meter"><a class="anchor" href="#_solaredge_pv_inverter_grid_meter"></a>4.7.60. SolarEdge PV Inverter + Grid-Meter</h4>
<div class="paragraph">
<p>Implementation of the SolarEdge PV inverters.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>SymmetricMeter</p>
</li>
<li>
<p>AsymmetricMeter</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.solaredge">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_tesla_powerwall_2"><a class="anchor" href="#_tesla_powerwall_2"></a>4.7.61. Tesla Powerwall 2</h4>
<div class="paragraph">
<p>Implementation of the Tesla Powerwall 2 energy storage system</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>SymmetricEss</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.tesla.powerwall2">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_influxdb"><a class="anchor" href="#_influxdb"></a>4.7.62. InfluxDB</h4>
<div class="paragraph">
<p>Persists all data of OpenEMS Edge Channels to an InfluxDB timeseries database.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.timedata.influxdb">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_rrd4j"><a class="anchor" href="#_rrd4j"></a>4.7.63. RRD4J</h4>
<div class="paragraph">
<p>Persists data of OpenEMS Edge Channels to RRD4J files.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.timedata.rrd4j">Source Code <span class="icon"><i class="fa fa-github"></i></span></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_kaco_blueplanet_hybrid_10_0_tl3"><a class="anchor" href="#_kaco_blueplanet_hybrid_10_0_tl3"></a>4.7.64. KACO blueplanet hybrid 10.0 TL3</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Implemented Natures</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>SymmetricEss</p>
</li>
<li>
<p>ManagedSymmetricEss</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>(proprietary)</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_implementing_a_device"><a class="anchor" href="#_implementing_a_device"></a>4.8. Implementing a device</h3>
<div class="sect3">
<h4 id="_step_by_step_guide"><a class="anchor" href="#_step_by_step_guide"></a>4.8.1. Step-by-step guide</h4>
<div class="paragraph">
<p>This chapter explains the steps required to implement an electric meter in OpenEMS Edge that is connected via Modbus/TCP. The meter itself is simulated using a small Modbus slave application, so no external hardware is required for this guide.</p>
</div>
<div class="paragraph">
<p>The tutorial is based on the <a href="gettingstarted.html" class="page">Getting Started</a> guide.</p>
</div>
<div class="sect4">
<h5 id="_create_a_new_osgi_bundle"><a class="anchor" href="#_create_a_new_osgi_bundle"></a>4.8.1.1. Create a new OSGi Bundle</h5>
<div class="paragraph">
<p>For more information see <a href="coreconcepts.html#_osgi_bundle" class="page">OSGi Bundle</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the menu choose <b class="button">File</b> &#8594; <b class="button">New</b> &#8594; <b class="button">Other</b></p>
<div class="imageblock">
<div class="content">
<img src="_images/eclipse-file-new-other.png" alt="Creating a new project in Eclipse IDE">
</div>
<div class="title">Figure 37. Creating a new project in Eclipse IDE</div>
</div>
</li>
<li>
<p>Select <b class="button">Bndtools</b> &#8594; <b class="button">Bnd OSGi Project</b> and press <b class="button">Next &gt;</b></p>
<div class="imageblock">
<div class="content">
<img src="_images/eclipse-bndtools-osgi-project.png" alt="Creating a Bnd OSGi Project in Eclipse IDE">
</div>
<div class="title">Figure 38. Creating a Bnd OSGi Project in Eclipse IDE</div>
</div>
</li>
<li>
<p>Select <b class="button">OpenEMS Templates</b> &#8594; <b class="button">OpenEMS Modbus Devices</b> and press <b class="button">Next &gt;</b></p>
<div class="imageblock">
<div class="content">
<img src="_images/eclipse-new-openems-modbus-device.png" alt="Creating an OpenEMS Modbus Devices Bundle in Eclipse IDE">
</div>
<div class="title">Figure 39. Creating an OpenEMS Modbus Devices Bundle in Eclipse IDE</div>
</div>
</li>
<li>
<p>Choose a project name and press <b class="button">Next &gt;</b></p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The project name is used as the folder name in OpenEMS source directory. The naming is up to you, but it is good practice to keep the name lower case and use something like <strong>io.openems.[edge/backend].[purpose/nature].[implementation]</strong>. For the simulated meter <code>io.openems.edge.meter.simulated</code> is a good choice.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/eclipse-new-osgi-provider-simulatedmeter.png" alt="Naming an OpenEMS Modbus Devices Bundle in Eclipse IDE">
</div>
<div class="title">Figure 40. Naming an OpenEMS Modbus Devices Bundle in Eclipse IDE</div>
</div>
</li>
<li>
<p>Accept defaults for the final screen and press <b class="button">Finish</b></p>
<div class="imageblock">
<div class="content">
<img src="_images/eclipse-new-osgi-provider-simulatedmeter-final.png" alt="Java settings for an OpenEMS Modbus Devices Bundle in Eclipse IDE">
</div>
<div class="title">Figure 41. Java settings for an OpenEMS Modbus Devices Bundle in Eclipse IDE</div>
</div>
</li>
<li>
<p>The assistant closes and you can see your new bundle.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_define_bundle_dependencies"><a class="anchor" href="#_define_bundle_dependencies"></a>4.8.1.2. Define Bundle dependencies</h5>
<div class="paragraph">
<p>OSGi Bundles can be dependent on certain other Bundles. This information needs to be set in a <strong>bnd.bnd</strong> file.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select the component directory <b class="button">src</b> &#8594; <b class="button">io.openems.edge.meter.simulated</b></p>
<div class="imageblock">
<div class="content">
<img src="_images/eclipse-new-simulatedmeter-bundle.png" alt="New simulated meter OpenEMS Modbus Devices Bundle in Eclipse IDE">
</div>
<div class="title">Figure 42. New simulated meter OpenEMS Modbus Devices Bundle in Eclipse IDE</div>
</div>
</li>
<li>
<p>Open the <b class="button">bnd.bnd</b> file by double clicking on it.</p>
</li>
<li>
<p>Open the <b class="button">Build</b> tab</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can see, that the Bundle is by default dependent on some core bundles</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">${buildpath}</dt>
<dd>
<p>applies some defaults defined in <code>/cnf/build.bnd</code></p>
</dd>
<dt class="hdlist1">io.openems.common</dt>
<dd>
<p>OpenEMS commons</p>
</dd>
<dt class="hdlist1">io.openems.edge.bridge.modbus</dt>
<dd>
<p>the Modbus Bridge provides the <a href="#bridge.adoc" class="page unresolved">Bridge</a> services for Modbus/RTU and Modbus/TCP protocols</p>
</dd>
<dt class="hdlist1">io.openems.edge.common</dt>
<dd>
<p>OpenEMS Edge commons</p>
</dd>
<dt class="hdlist1">slf4j.api</dt>
<dd>
<p>to be able to use the logger</p>
</dd>
</dl>
</div>
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/eclipse-bnd-file-build.png" alt="Bndtools Build configuration">
</div>
<div class="title">Figure 43. Bndtools Build configuration</div>
</div>
</li>
<li>
<p>Click the <b class="button">+</b> symbol next to <strong>Build Path</strong>.</p>
<div class="imageblock">
<div class="content">
<img src="_images/eclipse-osgi-build-path.png" alt="Bndtools Project Build Path configuration">
</div>
<div class="title">Figure 44. Bndtools Project Build Path configuration</div>
</div>
</li>
<li>
<p>Use the <strong>Project Build Path</strong> assistant to add the following Bundle as dependency:</p>
<div class="dlist">
<dl>
<dt class="hdlist1">io.openems.edge.meter.api</dt>
<dd>
<p>The Meter API Bundle provides the interfaces for OpenEMS Edge Meter Nature.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>It is also a good moment to configure the Bundle meta information. Still inside the <b class="button">bnd.bnd</b> file open the <b class="button">Source</b> tab. Adjust the meta information - it will help the users of your component:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>Bundle-Name: OpenEMS Edge Meter Simulated
Bundle-Vendor: OpenEMS Association e.V.
Bundle-License: https://opensource.org/licenses/EPL-2.0
Bundle-Version: 1.0.0.${tstamp}

-buildpath: \
	${buildpath},\
	io.openems.common,\
	io.openems.edge.bridge.modbus,\
	io.openems.edge.common,\
	io.openems.edge.meter.api,\
	slf4j.api,\

-testpath: \
	${testpath}</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>;version=latest</code> declaration is not required and can be removed. Also it is best practice to sort the buildpath bundles alphabetically.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_define_configuration_parameters"><a class="anchor" href="#_define_configuration_parameters"></a>4.8.1.3. Define configuration parameters</h5>
<div class="paragraph">
<p>OpenEMS Components can have several configuration parameters. They are defined as Java annotations and specific OSGi annotations are used to generate meta information that is used e.g. by Apache Felix Web Console to generate a user interface form (see <a href="gettingstarted.html" class="page">Getting Started</a>).</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the <b class="button">Config.java</b> file inside <code>src/io.openems.edge.meter.simulated</code> by double clicking on it.</p>
</li>
<li>
<p>Adjust the following lines in the template:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In the <code>@ObjectClassDefinition</code> set the <code>name</code> to <code>"Meter Simulated"</code> and the <code>description</code> to <code>"Implements the simulated meter."</code>.</p>
</li>
<li>
<p>Set the default value of the <code>String id()</code> attribute to <code>"meter0"</code>.</p>
</li>
<li>
<p>After the <code>boolean enabled()</code> attribute add a <code>Meter-Type</code> attribute:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@AttributeDefinition(name = "Meter-Type", description = "Grid, Production (=default), Consumption")
MeterType type() default MeterType.PRODUCTION;</code></pre>
</div>
</div>
</li>
<li>
<p>Set the <code>String webconsole_configurationFactory_nameHint()</code> default value to <code>"Meter Simulated [{id}]"</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>The content should now match the following code:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.openems.edge.meter.simulated;

import org.osgi.service.metatype.annotations.AttributeDefinition;
import org.osgi.service.metatype.annotations.ObjectClassDefinition;

import io.openems.edge.meter.api.MeterType;

@ObjectClassDefinition(<i class="conum" data-value="1"></i><b>(1)</b>
		name = "Meter Simulated", //
		description = "Implements the simulated meter.")
@interface Config {

	@AttributeDefinition(name = "Component-ID", description = "Unique ID of this Component")
	String id() default "meter0"; <i class="conum" data-value="2"></i><b>(2)</b>

	@AttributeDefinition(name = "Alias", description = "Human-readable name of this Component; defaults to Component-ID")
	String alias() default ""; <i class="conum" data-value="3"></i><b>(3)</b>

	@AttributeDefinition(name = "Is enabled?", description = "Is this Component enabled?")
	boolean enabled() default true; <i class="conum" data-value="4"></i><b>(4)</b>

	@AttributeDefinition(name = "Meter-Type", description = "Grid, Production (=default), Consumption") <i class="conum" data-value="5"></i><b>(5)</b>
	MeterType type() default MeterType.PRODUCTION; <i class="conum" data-value="6"></i><b>(6)</b>

	@AttributeDefinition(name = "Modbus-ID", description = "ID of Modbus bridge.")
	String modbus_id() default "modbus0"; <i class="conum" data-value="7"></i><b>(7)</b>

	@AttributeDefinition(name = "Modbus Unit-ID", description = "The Unit-ID of the Modbus device.")
	int modbusUnitId() default 1; <i class="conum" data-value="8"></i><b>(8)</b>

	@AttributeDefinition(name = "Modbus target filter", description = "This is auto-generated by 'Modbus-ID'.")
	String Modbus_target() default ""; <i class="conum" data-value="9"></i><b>(9)</b>

	String webconsole_configurationFactory_nameHint() default "Meter Simulated [\{id\}]"; <i class="conum" data-value="10"></i><b>(10)</b>

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <strong>@ObjectClassDefinition</strong> annotation defines this file as a Meta Type Resource for OSGi configuration admin. Use it to set a <em>name</em> and <em>description</em> for this OpenEMS Component.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <strong>id</strong> configuration parameter sets the OpenEMS Component-ID (see <a href="coreconcepts.html" class="page">Channel Address</a>). <em>Note</em>: A <strong>default</strong> ID 'meter0' is defined. It is good practice to define such an ID here, as it simplifies configuration in the UI.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <strong>alias</strong> configuration parameter sets the human-readable name of this OpenEMS Component. If no alias is configured, the Component-ID is used instead.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The <strong>enabled</strong> parameter provides a <em>soft</em> way of deactivating an OpenEMS Component programmatically.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The <strong>@AttributeDefinition</strong> annotation provides meta information about a configuration parameter like <em>name</em> and <em>description</em>.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The 'Meter' nature requires definition of a MeterType that defines the purpose of the Meter. We will let the user define this type by a configuration parameter.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>The 'Modbus-ID' parameter creates the link to a Modbus-Service via its OpenEMS Component-ID. At runtime the user will typically set this configuration parameter to something like 'modbus0'.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>The Modbus service implementation requires us to provide the Modbus <em>Unit-ID</em> (also commonly called <em>Device-ID</em> or <em>Slave-ID</em>) of the Modbus slave device. This is the ID that is configured at the simulated meter.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>The <strong>Modbus_target</strong> will be automatically set by OpenEMS framework and does usually not need to be configured by the user. <em>Note</em>: Linking other OpenEMS Components is implemented using OSGi References. The OpenEMS Edge framework therefor sets the 'target' property of a reference to filter the matched services.</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>The <strong>webconsole_configurationFactory_nameHint</strong> parameter sets a custom name for Apache Felix Web Console, helping the user to find the correct bundle.</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_implement_the_openems_component"><a class="anchor" href="#_implement_the_openems_component"></a>4.8.1.4. Implement the OpenEMS Component</h5>
<div class="paragraph">
<p>The Bndtools assistant created a <code>MyModbusDevice.java</code> file. First step is to set a proper name for this file. To rename the file, select it by clicking on it and choose <b class="button">Refactor</b> &#8594; <b class="button">Rename&#8230;&#8203;</b> in the menu. Write <code>MeterSimulated</code> as 'New name' and press <b class="button">Finish</b>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/eclipse-rename.png" alt="Renaming a Java class in Eclipse IDE">
</div>
<div class="title">Figure 45. Renaming a Java class in Eclipse IDE</div>
</div>
<div class="paragraph">
<p>Afterwards adjust the following content in the template:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <code>@Component</code> annotation set the <code>name</code> to <code>"Meter.Simulated"</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Component(//
		name = "Meter.Simulated", //
		immediate = true, //
		configurationPolicy = ConfigurationPolicy.REQUIRE //
)</code></pre>
</div>
</div>
</li>
<li>
<p>Make the class implement the <code>SymmetricMeter</code> nature:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class MeterSimulated extends AbstractOpenemsModbusComponent implements SymmetricMeter, OpenemsComponent {</code></pre>
</div>
</div>
</li>
<li>
<p>Eclipse will underline <code>SymmetricMeter</code> and show you the error <strong>SymmetricMeter cannot be resolved to a type</strong>. Resolve it by importing adding an <code>import io.openems.edge.meter.api.SymmetricMeter;</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The easiest way to fix these kind of import errors is to to selecto <b class="button">Source</b> → <b class="button">Organize Imports</b> in the menu or simply press <b class="button">Ctrl</b> + <b class="button">Shift</b> + <b class="button">o</b>. Alternatively click the 'error light bulb' next to the line with the error and select <b class="button">Import 'SymmetricMeter' (io.openems.edge.meter.api)</b>.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Eclipse still complains and now underlines the class name <code>MeterSimulated</code> with the error <strong>The type MeterSimulated must implement the inherited abstract method SymmetricMeter.getMeterType()</strong>. Resolve it by adding an implementation of the <code>getMeterType()</code> method:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
public MeterType getMeterType() {
	return this.config.type();
}</code></pre>
</div>
</div>
</li>
<li>
<p>Tell the OpenEMS framework that <code>MeterSimulated</code> provides the SymmetricMeter <strong>Channels</strong>, by adjusting the constructor:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public MeterSimulated() {
	super(//
			OpenemsComponent.ChannelId.values(), //
			SymmetricMeter.ChannelId.values(), //
			ChannelId.values() //
	);
}</code></pre>
</div>
</div>
</li>
<li>
<p>Finally we need to declare the modbus protocol of the simulated meter inside the <code>defineModbusProtocol</code> method. Replace the existing method</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
protected ModbusProtocol defineModbusProtocol() throws OpenemsException {
	// TODO implement ModbusProtocol
	return new ModbusProtocol(this);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>with</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
protected ModbusProtocol defineModbusProtocol() throws OpenemsException {
	return new ModbusProtocol(this, //
			new FC3ReadRegistersTask(1000, Priority.HIGH,
					m(SymmetricMeter.ChannelId.ACTIVE_POWER, new SignedWordElement(1000))));
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and solve the import errors again as described above.</p>
</div>
</li>
<li>
<p>Additionally it is advisable to implement a <code>debugLog()</code> method. This method provides information for the continuous log output of OpenEMS, provided by the <strong>DebugLogController</strong>. Adjust the method to return the ActivePower value of the meter:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
public String debugLog() {
	return "L:" + this.getActivePower().value().asString();
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The content of <code>MeterSimulated.java</code> should now match the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.openems.edge.meter.simulated;

import org.osgi.service.cm.ConfigurationAdmin;
import org.osgi.service.component.ComponentContext;
import org.osgi.service.component.annotations.Activate;
import org.osgi.service.component.annotations.Component;
import org.osgi.service.component.annotations.ConfigurationPolicy;
import org.osgi.service.component.annotations.Deactivate;
import org.osgi.service.component.annotations.Reference;
import org.osgi.service.component.annotations.ReferenceCardinality;
import org.osgi.service.component.annotations.ReferencePolicy;
import org.osgi.service.component.annotations.ReferencePolicyOption;
import org.osgi.service.metatype.annotations.Designate;

import io.openems.edge.bridge.modbus.api.AbstractOpenemsModbusComponent;
import io.openems.edge.bridge.modbus.api.BridgeModbus;
import io.openems.edge.bridge.modbus.api.ModbusProtocol;
import io.openems.edge.bridge.modbus.api.element.SignedWordElement;
import io.openems.edge.bridge.modbus.api.task.FC3ReadRegistersTask;
import io.openems.edge.common.channel.Doc;
import io.openems.edge.common.component.OpenemsComponent;
import io.openems.edge.common.taskmanager.Priority;
import io.openems.edge.meter.api.MeterType;
import io.openems.edge.meter.api.SymmetricMeter;

@Designate(ocd = Config.class, factory = true) <i class="conum" data-value="1"></i><b>(1)</b>
@Component(<i class="conum" data-value="2"></i><b>(2)</b>
		name = "Meter.Simulated", <i class="conum" data-value="3"></i><b>(3)</b>
		immediate = true, <i class="conum" data-value="4"></i><b>(4)</b>
		configurationPolicy = ConfigurationPolicy.REQUIRE <i class="conum" data-value="5"></i><b>(5)</b>
)
public class MeterSimulated extends AbstractOpenemsModbusComponent <i class="conum" data-value="6"></i><b>(6)</b>
	implements SymmetricMeter, OpenemsComponent { <i class="conum" data-value="7"></i><b>(7)</b>

	private Config config = null;

	public enum ChannelId implements io.openems.edge.common.channel.ChannelId { <i class="conum" data-value="8"></i><b>(8)</b>
		;

		private final Doc doc;

		private ChannelId(Doc doc) {
			this.doc = doc;
		}

		@Override
		public Doc doc() {
			return this.doc;
		}
	}

	public MeterSimulated() {
		super(<i class="conum" data-value="9"></i><b>(9)</b>
				OpenemsComponent.ChannelId.values(), //
				SymmetricMeter.ChannelId.values(), //
				ChannelId.values() //
		);
	}

	@Reference
	protected ConfigurationAdmin cm; <i class="conum" data-value="10"></i><b>(10)</b>

	@Reference(policy = ReferencePolicy.STATIC, policyOption = ReferencePolicyOption.GREEDY, cardinality = ReferenceCardinality.MANDATORY)
	protected void setModbus(BridgeModbus modbus) {
		super.setModbus(modbus); <i class="conum" data-value="11"></i><b>(11)</b>
	}

	@Activate
	void activate(ComponentContext context, Config config) { <i class="conum" data-value="12"></i><b>(12)</b>
		super.activate(context, config.id(), config.alias(), config.enabled(), config.modbusUnitId(), this.cm, "Modbus",
				config.modbus_id());
		this.config = config;
	}

	@Deactivate
	protected void deactivate() { <i class="conum" data-value="13"></i><b>(13)</b>
		super.deactivate();
	}

	@Override
	protected ModbusProtocol defineModbusProtocol() throws OpenemsException { <i class="conum" data-value="14"></i><b>(14)</b>
		return new ModbusProtocol(this, <i class="conum" data-value="15"></i><b>(15)</b>
				new FC3ReadRegistersTask(1000, Priority.HIGH, <i class="conum" data-value="16"></i><b>(16)</b>
						m(SymmetricMeter.ChannelId.ACTIVE_POWER, new SignedWordElement(1000)))); <i class="conum" data-value="17"></i><b>(17)</b>
	}

	@Override
	public MeterType getMeterType() { <i class="conum" data-value="18"></i><b>(18)</b>
		return this.config.type();
	}

	@Override
	public String debugLog() { <i class="conum" data-value="19"></i><b>(19)</b>
		return "L:" + this.getActivePower().value().asString();
	}
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <strong>@Designate</strong> annotation is used for OSGi to create a connection to the <em>Config</em> annotation class. It also defines this Component as a <em>factory</em>, i.e. it can produce multiple instances with different configurations.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <strong>@Component</strong> annotation marks this class as an OSGi component.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <strong>name</strong> property sets the unique name of this component. It is used to store configuration in the filesystem, to identify the component inside Apache Felix Web Console, and so on. Configure a human-readable name in the form <strong>[nature].[vendor].[product]</strong>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The <strong>immediate</strong> property defines whether the component should be started immediately. Configure the Component to be started immediately after configuration, i.e. it is not waiting till its service is required by another Component.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The <strong>configurationPolicy</strong> define that the configuration of the Component is required before it gets activated.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>To ease the implementation of a Modbus device we can extend the <strong>AbstractOpenemsModbusComponent</strong> class.
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the device was using another protocol, it is advisable to use the <strong>AbstractOpenemsComponent</strong> class as a convenience layer instead of implementing everything required by the <strong>OpenemsComponent</strong> interface manually.
</td>
</tr>
</table>
</div></td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>The class implements <strong>OpenemsComponent</strong>. This makes it an <a href="coreconcepts.html#<em>openems_component" class="page">OpenEMS Component</a>.
The Device that we are is a <strong>SymmetricMeter</strong>. We already defined the required Channels in the _initializeChannels()</em> method. Additionally the Component also needs to implement the Nature interface.
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In plain Java it is not required to add <code>implements OpenemsComponent</code> if we inherit from 'AbstractOpenemsComponent' or 'AbstractOpenemsModbusComponent'. Be aware that for OSGi dependency injection to function properly, it is still required to mention all implemented interfaces again, as it is not considering the complete inheritance tree.
</td>
</tr>
</table>
</div></td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>The simulated implementation is only going to provide Channels defined by <em>OpenemsComponent</em> and <em>SymmetricMeter</em> natures. It is still good practice to add a skeleton for custom Channels to the Component implementation. We therefor add the <em>Channel Declaration</em> block inside the class.
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>Channel declarations are <strong>enum</strong> types implementing the ChannelId interface.</p>
</li>
<li>
<p>This enum is empty, as we do not have custom Channels here.</p>
</li>
<li>
<p>ChannelId enums require a Doc object that provides meta information about the Channel - e.g. the above ACTIVE_POWER Channel is defined as <code>ACTIVE_POWER(new Doc().type(OpenemsType.INTEGER).unit(Unit.WATT)</code></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div></td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>We call the constructor of the super class (<code>AbstractOpenemsModbusComponent</code>/<code>AbstractOpenemsComponent</code>) to initialize the Channels of the Component. It is important to list all ChannelId-Enums of all implemented Natures. The call takes the <strong>ChannelId</strong> declarations and creates a Channel instance for each of them; e.g. for the <code>SymmetricMeter.ACTIVE_POWER</code> ChannelId, an object instance of <code>IntegerReadChannel</code> is created that represents the Channel.</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>The <code>super.activate()</code> method requires an instance of <strong>ConfigurationAdmin</strong> as a parameter. Using the <strong>@Reference</strong> annotation the OSGi framework is going to provide the ConfigurationAdmin service via dependency injection.</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>The Component utilizes an external Modbus Component (the <em>Modbus Bridge</em>) for the actual Modbus communication. We receive an instance of this service via dependency injection (like we did already for the <em>ConfigurationAdmin</em> service). Most of the magic is handled by the <em>AbstractOpenemsModbusComponent</em> implementation, but the way the OSGi framework works, we need to define the <em>@Reference</em> explicitly here in the actual implementation of the component and call the parent <code>setModbus()</code> method.</td>
</tr>
<tr>
<td><i class="conum" data-value="12"></i><b>12</b></td>
<td>The <strong>activate()</strong> method (marked by the <strong>@Activate</strong> annotation) is called on activation of an object instance of this Component. It comes with a ComponentContext and an instance of a configuration in the form of a Config object. All logic for activating and deactivating the OpenEMS Component is hidden in the super classes and just needs to be called from here.</td>
</tr>
<tr>
<td><i class="conum" data-value="13"></i><b>13</b></td>
<td>The <strong>deactivate()</strong> method (marked by the <strong>@Deactivate</strong> annotation) is called on deactivation of the Component instance.</td>
</tr>
<tr>
<td><i class="conum" data-value="14"></i><b>14</b></td>
<td><em>AbstractOpenemsModbusComponent</em> requires to implement a <strong>defineModbusProtocol()</strong> method that returns an instance of <strong>ModbusProtocol</strong>. The <em>ModbusProtocol</em> class maps Modbus addresses to OpenEMS Channels and provides some conversion utilities. Instantiation of a <em>ModbusProtocol</em> object uses the <a href="https://en.wikipedia.org/wiki/Builder_pattern#Java">Builder pattern <span class="icon"><i class="fa fa-external-link"></i></span></a></td>
</tr>
<tr>
<td><i class="conum" data-value="15"></i><b>15</b></td>
<td>Creates a <strong>new ModbusProtocol</strong> instance. A reference to the component itself is the first parameter, followed by an arbitrary number of 'Tasks' (implemented as a Java varags array).</td>
</tr>
<tr>
<td><i class="conum" data-value="16"></i><b>16</b></td>
<td><strong>FC3ReadRegistersTask</strong> is an implementation of Modbus <a href="http://www.simplymodbus.ca/FC03.htm">function code 3 "Read Holding Registers" <span class="icon"><i class="fa fa-external-link"></i></span></a>. Its first parameter is the start address of the register block. The second parameter is a priority information that defines how often this register block needs to be queried. Following parameters are an arbitrary number of <strong>ModbusElements</strong>.
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Most Modbus function codes are available by their respective <em>FC*</em> implementation classes.
</td>
</tr>
</table>
</div></td>
</tr>
<tr>
<td><i class="conum" data-value="17"></i><b>17</b></td>
<td>Here the internal <strong>m()</strong> method is used to make a simple 1-to-1 mapping between the Modbus element at address <code>1000</code> and the Channel <em>SymmetricMeter.ChannelId.ACTIVE_POWER</em>. The Modbus element is defined as a 16 bit word element with an signed integer value.
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>The <em>m()</em> method also takes an instance of <strong>ElementToChannelConverter</strong> as an additional parameter. It can be used to add implicit unit conversions between Modbus element and OpenEMS Channel - like adding a scale factor that converts a read value of '95' to a channel value of '950'.</p>
</li>
<li>
<p>For Modbus registers that are empty or should be ignored, the <strong>DummyRegisterElement</strong> can be used.</p>
</li>
<li>
<p>For more advanced channel-to-element mapping functionalities the internal <strong>cm()</strong> method can be used - e.g. to map one Modbus element to multiple Channels.</p>
<div class="paragraph">
<p>Using this principle a complete Modbus table consisting of multiple register blocks that need to be read or written with different Modbus function codes can be defined. For details have a look at the existing implementation classes inside the Modbus Bridge source code.
&lt;18&gt; The SymmetricMeter Nature requires us to provide a <strong>MeterType</strong> via a <code>MeterType getMeterType()</code> method. The MeterType is provided by the Config.
&lt;19&gt; Finally it is always a good idea to define a <strong>debugLog()</strong> method. This method is called in each cycle by the <strong>Controller.Debug.Log</strong> and very helpful for continuous debugging.</p>
</div>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div></td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_start_the_device_simulator"><a class="anchor" href="#_start_the_device_simulator"></a>4.8.1.5. Start the device simulator</h5>
<div class="paragraph">
<p>To start the device simulator, open the <b class="button">io.openems.edge.bridge.modbus</b> project and navigate to the <b class="button">test</b> &#8594; <b class="button">io.openems.edge.bridge.modbus</b> folder. There you find the <b class="button">ModbusSlaveSimulator.java</b> file. Right-click that file and select <b class="button">Run As</b> &#8594; <b class="button">Java Application</b>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This <em>ModbusSlaveSimulator</em> runs a small Modbus-TCP <em>Slave</em>-Server, that provides some constant values:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constant value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">123</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In the end of this guide, you will see a production of '500 W' - where '500' comes from register address 1000.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_enable_the_component"><a class="anchor" href="#_enable_the_component"></a>4.8.1.6. Enable the Component</h5>
<div class="paragraph">
<p>To enable the Component for running, open the <b class="button">io.openems.edge.application</b> project and open the <b class="button">EdgeApp.bndrun</b> file.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/eclipse-edgeapp-bndrun.png" alt="Eclipse IDE EdgeApp.bndrun">
</div>
<div class="title">Figure 46. Eclipse IDE EdgeApp.bndrun</div>
</div>
<div class="paragraph">
<p>Select the <code>io.openems.edge.meter.simulated</code> bundle in the left <strong>Repositories</strong> list and drag &amp; drop it to the <strong>Run Requirements</strong> list.</p>
</div>
<div class="paragraph">
<p>Click on <b class="button">Resolve</b> to update the list of bundles that are required to run OpenEMS Edge. After a few seconds the <strong>Resolution Results</strong> window should appear; acknowledge by pressing <b class="button">Finish</b>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/eclipse-edgeapp-resolve.png" alt="Eclipse IDE Resolve EdgeApp.bndrun">
</div>
<div class="title">Figure 47. Eclipse IDE Resolve EdgeApp.bndrun</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>These steps changed the content of the 'EdgeApp.bndrun' file. You can observe the changes inside the <strong>Source</strong> tab:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The drag &amp; drop caused a new line to be added under <code>-runrequires: \</code>:</p>
<div class="paragraph">
<p><code>bnd.identity;id='io.openems.edge.meter.simulated'</code></p>
</div>
</li>
<li>
<p>Resolving updated the <code>-runbundles: \</code> list by adding the line:</p>
<div class="paragraph">
<p><code>io.openems.edge.meter.simulated;version='[1.0.0,1.0.1)'</code></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>\</code> at the end of each line is required to announce bndtools that the definition still continues on the next line.</p>
</div>
<div class="paragraph">
<p>Also you may have found, that the existing entries are sorted alphabetically.</p>
</div>
<div class="paragraph">
<p>Now switch back to <b class="button">Run</b> view.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_run_the_implementation"><a class="anchor" href="#_run_the_implementation"></a>4.8.1.7. Run the implementation</h5>
<div class="paragraph">
<p>Press <b class="button">Run OSGi</b> to run OpenEMS Edge.</p>
</div>
<div class="paragraph">
<p>From then you can configure your component as shown in <a href="gettingstarted.html" class="page">Getting Started</a> guide. Add the following configurations inside Apache Felix Web Console:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Controller Debug Log</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>ID: <code>ctrlDebugLog0</code></p>
</li>
<li>
<p>Enabled: <code>checked</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Scheduler All Alphabetically</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>ID: <code>scheduler0</code></p>
</li>
<li>
<p>Enabled: <code>checked</code></p>
</li>
<li>
<p>Cycle time: <code>1000</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Bridge Modbus/TCP</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>ID: <code>modbus0</code></p>
</li>
<li>
<p>IP-Address: <code>localhost</code></p>
</li>
<li>
<p>Enabled: <code>checked</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Meter Simulated</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>ID: <code>meter0</code></p>
</li>
<li>
<p>Enabled: <code>checked</code></p>
</li>
<li>
<p>Meter-Type: <code>PRODUCTION</code></p>
</li>
<li>
<p>Modbus-ID: <code>modbus0</code></p>
</li>
<li>
<p>Modbus Unit-ID: <code>1</code></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>In the Eclipse IDE console log you should see an output like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>2020-01-20 13:32:12,095 [re.Cycle] INFO  [e.controller.debuglog.DebugLog] [ctrlDebugLog0] _sum[State:Ok Production:500 W Consumption:500 W] meter0[L:500 W]</pre>
</div>
</div>
<div class="paragraph">
<p>It shows a Production of <code>500 W</code> which is what is provided by the simulated meter device. Congrats!</p>
</div>
</div>
<div class="sect4">
<h5 id="_debug_the_implementation"><a class="anchor" href="#_debug_the_implementation"></a>4.8.1.8. Debug the implementation</h5>
<div class="paragraph">
<p>If you experience any errors you can always run OpenEMS Edge using the <b class="button">Debug OSGi</b> button in EdgeApp.bndrun. This allows you to stop code execution at any time using <a href="https://help.eclipse.org/2019-12/index.jsp?topic=%2Forg.eclipse.jdt.doc.user%2Ftasks%2Ftask-add_line_breakpoints.htm">Breakpoints</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_build_openems_edge"><a class="anchor" href="#_build_openems_edge"></a>4.9. Build OpenEMS Edge</h3>
<div class="paragraph">
<p>This chapter explains, how OpenEMS Edge can be compiled to a JAR file that can be executed outside of an IDE.</p>
</div>
<div class="sect3">
<h4 id="_build_using_eclipse_ide"><a class="anchor" href="#_build_using_eclipse_ide"></a>4.9.1. Build using Eclipse IDE</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Inside Eclipse IDE open the <strong>io.openems.edge.application</strong> project and open the <a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.edge.application/EdgeApp.bndrun">EdgeApp.bndrun <span class="icon"><i class="fa fa-code"></i></span></a> file.</p>
<div class="imageblock">
<div class="content">
<img src="_images/eclipse-edgeapp-bndrun.png" alt="Eclipse IDE EdgeApp.bndrun">
</div>
<div class="title">Figure 48. Eclipse IDE EdgeApp.bndrun</div>
</div>
</li>
<li>
<p>Press <b class="button">Export</b> to start the <strong>Export Wizard Selection</strong> assistant.</p>
</li>
<li>
<p>Select <b class="button">Executable JAR</b> and press <b class="button">Next &gt;</b>.</p>
<div class="imageblock">
<div class="content">
<img src="_images/eclipse-bnd-file-export.png" alt="Eclipse Export Wizard Selection assistant">
</div>
<div class="title">Figure 49. Eclipse Export Wizard Selection assistant</div>
</div>
</li>
<li>
<p>Select a <strong>Destination</strong> for <strong>Export to JAR</strong>.</p>
<div class="imageblock">
<div class="content">
<img src="_images/eclipse-bnd-file-export-destination.png" alt="Eclipse Export Destination">
</div>
<div class="title">Figure 50. Eclipse Export Destination</div>
</div>
</li>
<li>
<p>Press <b class="button">Finish</b></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This creates a so called Fat-JAR-file including all bundles. It can be executed by running <code>java -jar openems.jar</code> in a console.</p>
</div>
</div>
<div class="sect3">
<h4 id="_build_using_gradle_from_command_line"><a class="anchor" href="#_build_using_gradle_from_command_line"></a>4.9.2. Build using Gradle from command line</h4>
<div class="paragraph">
<p><a href="https://gradle.org/">Gradle</a> is a build tool that is used in the OpenEMS project to compile the JAR-files and to execute other tasks like building the documentation webpage using <a href="https://antora.org/">Antora</a> and the Javadocs. To build OpenEMS Edge:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open a console and change to your repository directory.</p>
</li>
<li>
<p>Execute <code>gradlew buildEdge</code></p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deploy_openems_edge"><a class="anchor" href="#_deploy_openems_edge"></a>4.10. Deploy OpenEMS Edge</h3>
<div class="paragraph">
<p>This chapter explains how OpenEMS can be deployed on a Debian Linux Internet-of-Things Gateway. Similar techniques will work for other operating systems as well.</p>
</div>
<div class="paragraph">
<p>This guide covers a simple, manual approach. For productive systems it is required to automate deployment to IoT devices. Good approaches include a Debian package repository that provides *.deb-files and third-party tools like <a href="http://www.eclipse.org/hawkbit/">Eclipse Hawkbit</a>. This is out-of-scope for this small guide.</p>
</div>
<div class="paragraph">
<p>Prerequisites:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A target device running Debian Linux like a Raspberry Pi, Beaglebone Black or an IoT gateway. You need the IP address and SSH access.</p>
</li>
<li>
<p>Create a JAR-file that should be deployes. See <a href="edge/build.html" class="page">Build OpenEMS Edge</a> for details.</p>
</li>
<li>
<p>Setup an SSH client to connect to the Linux console, e.g. <a href="http://www.9bis.net/kitty/">KiTTY</a></p>
</li>
<li>
<p>Setup an SCP client to copy the JAR file via SSH, e.g. <a href="https://winscp.net/eng/docs/lang:de">WinSCP</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_connect_via_ssh_and_scp"><a class="anchor" href="#_connect_via_ssh_and_scp"></a>4.10.1. Connect via SSH and SCP</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Connect via SSH using KiTTY</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Open KiTTY and connect to the target device.</p>
<div class="paragraph">
<p>Make sure to select SSH with port 22 and enter the IP address of the target device. Press the <b class="button">Open</b> button.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/deploy-kitty.png" alt="KiTTY Configuration">
</div>
<div class="title">Figure 51. KiTTY Configuration</div>
</div>
</li>
<li>
<p>Gain root permissions either by logging in as user <strong>root</strong> or by login in as a default user and executing <strong>sudo -s</strong>.</p>
<div class="imageblock">
<div class="content">
<img src="_images/deploy-ssh-root.png" alt="KiTTY Configuration">
</div>
<div class="title">Figure 52. KiTTY Configuration</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As an example, for the FENECON Energy Management System (FEMS) it is required to:<br>
<em>login as:</em> <code>fems</code><br>
<em>fems@192.168.178.38&#8217;s password:</em> <code>device specific password</code><br>
&#8230;&#8203;<br>
<em>fems@femsXXX:~$</em> <code>sudo -s</code><br>
<em>[sudo] password for fems:</em> <code>device specific password</code><br>
<em>root@femsXXX:/home/fems#</em>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Connect via SCP using WinSCP</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If you are lucky and have a fully configured system, right-click on the KiTTY window bar and select <b class="button">Start WinSCP</b>.</p>
<div class="imageblock">
<div class="content">
<img src="_images/deploy-kitty-start-winscp.png" alt="Start WinSCP from KiTTY">
</div>
<div class="title">Figure 53. Start WinSCP from KiTTY</div>
</div>
</li>
<li>
<p>Otherwise open WinSCP separately, create a new connection, select <strong>SCP</strong> as protocol and enter again the IP address and port 22. Click <b class="button">Connect</b> once finished.</p>
<div class="imageblock">
<div class="content">
<img src="_images/deploy-winscp.png" alt="Start WinSCP from KiTTY">
</div>
<div class="title">Figure 54. Start WinSCP from KiTTY</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_prepare_operating_system_environment"><a class="anchor" href="#_prepare_operating_system_environment"></a>4.10.1.1. Prepare operating system environment</h5>
<div class="sect5">
<h6 id="_create_an_application_directory"><a class="anchor" href="#_create_an_application_directory"></a>Create an application directory</h6>
<div class="paragraph">
<p>Create the directory <strong>/usr/lib/openems</strong>. This is going to be the place, where we put the JAR file.</p>
</div>
<div class="paragraph">
<p>Execute <code>mkdir /usr/lib/openems</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_create_a_config_directory"><a class="anchor" href="#_create_a_config_directory"></a>Create a config directory</h6>
<div class="paragraph">
<p>Create the directory <strong>/etc/openems.d</strong>. This is going to be the place, where all the bundle configurations are held.</p>
</div>
<div class="paragraph">
<p>Execute <code>mkdir /etc/openems.d</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_create_a_systemd_service_definition"><a class="anchor" href="#_create_a_systemd_service_definition"></a>Create a systemd service definition</h6>
<div class="paragraph">
<p>The systemd 'Service Manager' manages system processes in a Debian Linux. We will create a systemd service definition file, so that systemd takes care of managing (starting/restarting/&#8230;&#8203;) the OpenEMS Edge service.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create and open the service definition file.</p>
<div class="paragraph">
<p>Execute <code>nano /etc/systemd/system/openems.service</code></p>
</div>
</li>
<li>
<p>Paste the following content:</p>
<div class="listingblock">
<div class="content">
<pre>[Unit]
Description=OpenEMS <i class="conum" data-value="1"></i><b>(1)</b>
After=network.target <i class="conum" data-value="2"></i><b>(2)</b>

[Service]
User=root <i class="conum" data-value="3"></i><b>(3)</b>
Group=root
Type=notify <i class="conum" data-value="4"></i><b>(4)</b>
WorkingDirectory=/usr/lib/openems
LimitCORE=infinity
LimitRTPRIO=2
LimitRTTIME=60000000
CPUSchedulingPolicy=rr
CPUSchedulingPriority=1
ExecStart=/usr/bin/java -Dfelix.cm.dir=/etc/openems.d/ -jar /usr/lib/openems/openems.jar <i class="conum" data-value="5"></i><b>(5)</b>
SuccessExitStatus=143 <i class="conum" data-value="6"></i><b>(6)</b>
Restart=always <i class="conum" data-value="7"></i><b>(7)</b>
RestartSec=10 <i class="conum" data-value="8"></i><b>(8)</b>
WatchdogSec=60 <i class="conum" data-value="9"></i><b>(9)</b>

[Install]
WantedBy=multi-user.target</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The name of the service.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The service is allowed to start after network is available (e.g. to be able to access devices via ethernet connection)</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>It is run as user 'root' to have access to all devices. It is recommended to change this for productive systems.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>OpenEMS notifies systemd once it is started up properly.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The start command. It uses Java 8, sets the config directory to <code>/etc/openems.d</code> and runs the jar file at <code>/usr/lib/openems/openems.jar</code></td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>In contrast to what systemd expects, Java exits with status 143 on success.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Systemd <em>always</em> tries to restart OpenEMS once it was quit.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Systemd waits <em>10</em> seconds till the next restart.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>Systemd expects OpenEMS to trigger its watchdog once every 60 seconds. OpenEMS is doing that by default if it detects that it is run by systemd.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Press <b class="button">Ctrl</b> + <b class="button">x</b> to exit and <b class="button">y</b> to save the file.</p>
</li>
<li>
<p>Activate the service definition:</p>
<div class="paragraph">
<p>Execute <code>systemctl daemon-reload</code></p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="_update_openems_edge_jar_file"><a class="anchor" href="#_update_openems_edge_jar_file"></a>Update OpenEMS Edge JAR file</h6>
<div class="paragraph">
<p>To update the OpenEMS JAR file at the target device, it is required to copy the JAR file from your build directory (see <a href="edge/build.html" class="page">Build OpenEMS Edge</a>) to <code>/usr/lib/openems/openems.jar</code> on the target device. Afterwards it is required to restart the systemd service</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Copy JAR file via SCP.</p>
<div class="paragraph">
<p>In WinSCP open your local build directory on the left side and <strong>/usr/lib/openems/</strong> on the right side. Then drag and drop the file from left to right.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/deploy-winscp-copy.png" alt="WinSCP copy file">
</div>
<div class="title">Figure 55. WinSCP copy file</div>
</div>
</li>
<li>
<p>Restart OpenEMS systemd service.</p>
<div class="paragraph">
<p>Execute <code>systemctl restart openems --no-block; journalctl -lfu openems</code></p>
</div>
<div class="paragraph">
<p>The command restarts the service (<em>systemctl restart openems</em>) while not waiting for the OpenEMS startup notification (<em>--no-block</em>). Then it directly prints the OpenEMS system log (<em>journalctl -lfu openems</em>).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/deploy-openems-start.png" alt="OpenEMS Edge start-up">
</div>
<div class="title">Figure 56. OpenEMS Edge start-up</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_openems_ui"><a class="anchor" href="#_openems_ui"></a>5. OpenEMS UI</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_ui_architecture"><a class="anchor" href="#_ui_architecture"></a>5.1. UI Architecture</h3>
<div class="paragraph">
<p>OpenEMS UI is the real-time user interface for web browsers and smartphones.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/ui-live.png" alt="OpenEMS UI Live view">
</div>
<div class="title">Figure 57. OpenEMS UI Live view</div>
</div>
<div class="sect3">
<h4 id="_adaptive_user_interface"><a class="anchor" href="#_adaptive_user_interface"></a>5.1.1. Adaptive User Interface</h4>
<div class="paragraph">
<p>The OpenEMS UI is the standard user interface for OpenEMS.
It uses the <code>EdgeConfig</code> (see Edge &#8594; Configuration) to adapt its visualisation in accordance with the actual configuration.
The screenshot above visualizes the 'Live view' of OpenEMS UI.
It shows Storage System, Production and Grid because corresponding OpenEMS Components are listed in the EdgeConfig.</p>
</div>
</div>
<div class="sect3">
<h4 id="_configuration_of_openems_edge"><a class="anchor" href="#_configuration_of_openems_edge"></a>5.1.2. Configuration of OpenEMS Edge</h4>
<div class="paragraph">
<p>OpenEMS UI provides a way to instantiate an OpenEMS Component from a factory by providing configuration parameters. See Edge &#8594; Configuration for details.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_build_openems_ui"><a class="anchor" href="#_build_openems_ui"></a>5.2. Build OpenEMS UI</h3>
<div class="paragraph">
<p>This chapter explains, how OpenEMS UI can be compiled so that it can be executed outside of an IDE.</p>
</div>
<div class="paragraph">
<p>Open the terminal inside Visual Studio Code (Menu: <b class="button">Terminal</b> &#8594; <b class="button">New Terminal</b>).</p>
</div>
<div class="sect3">
<h4 id="_build_using_angular_cli_from_command_line"><a class="anchor" href="#_build_using_angular_cli_from_command_line"></a>5.2.1. Build using angular-cli from command line</h4>
<div class="paragraph">
<p>Execute the following commands inside the <code>ui</code> directory of your OpenEMS repository. The build artifacts will be stored in a subfolder of the <code>target</code> directory</p>
</div>
<div class="paragraph">
<p>To get more help on <code>angular-cli</code> use <code>ng help</code> or go check out the <a href="https://github.com/angular/angular-cli/blob/master/README.md">Angular-CLI README</a>.</p>
</div>
<div class="paragraph">
<p>Be aware that there is currently a <a href="https://github.com/angular/angular-cli/issues/11208">bug</a>
in how angular-cli generates the service-worker configuration file (ngsw-config.json). After running the above command it is required to fix 'regex' statements in the file, replacing double &#8216;\\&#8217; by single &#8216;\&#8217; to avoid wrong escaping.</p>
</div>
<div class="sect4">
<h5 id="_build_for_openems_backend"><a class="anchor" href="#_build_for_openems_backend"></a>5.2.1.1. Build for OpenEMS Backend</h5>
<div class="paragraph">
<p>Execute</p>
</div>
<div class="paragraph">
<p><code>ng build -c backend</code></p>
</div>
<div class="paragraph">
<p>The build artifacts are created in the directory <code>ui/target/backend</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_build_for_openems_edge"><a class="anchor" href="#_build_for_openems_edge"></a>5.2.1.2. Build for OpenEMS Edge</h5>
<div class="paragraph">
<p>Execute</p>
</div>
<div class="paragraph">
<p><code>ng build -c edge</code></p>
</div>
<div class="paragraph">
<p>The build artifacts are created in the directory <code>ui/target/edge</code>.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_openems_backend"><a class="anchor" href="#_openems_backend"></a>6. OpenEMS Backend</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_backend_architecture"><a class="anchor" href="#_backend_architecture"></a>6.1. Backend Architecture</h3>

</div>
<div class="sect2">
<h3 id="_backend_to_backend_communication"><a class="anchor" href="#_backend_to_backend_communication"></a>6.2. Backend-to-Backend communication</h3>
<div class="paragraph">
<p>OpenEMS Backend provides two "Backend-to-Backend-Api" implementations, that provide a way to communicate with one or more OpenEMS Edge devices via backend connection. They are designed using the JSON-RPC communication protocol via REST/JSON (<em>io.openems.backend.b2brest</em>) or via Websocket (<em>io.openems.backend.b2bwebsocket</em>) connection.</p>
</div>
<div class="sect3">
<h4 id="_authentication"><a class="anchor" href="#_authentication"></a>6.2.1. Authentication</h4>
<div class="paragraph">
<p>BasicAuth on opening of the connection.</p>
</div>
</div>
<div class="sect3">
<h4 id="_error_handling"><a class="anchor" href="#_error_handling"></a>6.2.2. Error Handling</h4>
<div class="paragraph">
<p>Errors are implemented according to the specs of JSON-RPC 2.0 (<a href="https://www.jsonrpc.org/specification#response_object" class="bare">https://www.jsonrpc.org/specification#response_object</a>). Possible error codes are documented here:
<a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.common/src/io/openems/common/exceptions/OpenemsError.java#L13" class="bare">https://github.com/OpenEMS/openems/blob/develop/io.openems.common/src/io/openems/common/exceptions/OpenemsError.java#L13</a></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc": "2.0",
  "id": "UUID",
  "error": {
    "code": 3000,
    "message": "Edge [edge0] is not connected",
    "data: ["edge0"]
  }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Properties <code>id</code> and <code>jsonrpc</code> can be omitted for JSON/REST, as they are not required for HTTP POST calls.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_requests"><a class="anchor" href="#_requests"></a>6.2.3. Requests</h4>
<div class="sect4">
<h5 id="_getedgesstatus"><a class="anchor" href="#_getedgesstatus"></a>6.2.3.1. GetEdgesStatus</h5>
<div class="paragraph">
<p>Lists the current status of all accessible Edges.</p>
</div>
<div class="sect5">
<h6 id="_request"><a class="anchor" href="#_request"></a>Request</h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc":"2.0",
  "id":"UUID",
  "method":"getEdgesStatus",
  "params":{}
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_response"><a class="anchor" href="#_response"></a>Response</h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc":"2.0",
  "id":"UUID",
  "result":{
    "edge0":{
      "online":true
    },
    "edge1":{
      "online":false
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_demo"><a class="anchor" href="#_demo"></a>Demo</h6>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.backend.b2bwebsocket/test/io/openems/backend/b2bwebsocket/B2bWebsocketTest.java" class="bare">https://github.com/OpenEMS/openems/blob/develop/io.openems.backend.b2bwebsocket/test/io/openems/backend/b2bwebsocket/B2bWebsocketTest.java</a>:  <code>testGetEdgesStatusRequest()</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_getedgeschannelsvalues"><a class="anchor" href="#_getedgeschannelsvalues"></a>6.2.3.2. GetEdgesChannelsValues</h5>
<div class="paragraph">
<p>Queries the latest value of certain channels for a number of Edge-Devices. Channels that are not available or do not have a current value are returned as <code>null</code>.</p>
</div>
<div class="sect5">
<h6 id="_request_2"><a class="anchor" href="#_request_2"></a>Request</h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc":"2.0",
  "id":"UUID",
  "method":"getEdgesChannelsValues",
  "params":{
    "ids":[
      "edge0",
      "edge1"
    ],
    "channels":[
      "_sum/EssSoc",
      "_sum/ProductionActivePower"
    ]
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_response_2"><a class="anchor" href="#_response_2"></a>Response</h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc":"2.0",
  "id":"UUID",
  "result":{
    "edge0":{
      "_sum/EssSoc":50,
      "_sum/ProductionActivePower":0
    },
    "edge1":{
      "_sum/EssSoc":99,
      "_sum/ProductionActivePower":null
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_demo_2"><a class="anchor" href="#_demo_2"></a>Demo</h6>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.backend.b2bwebsocket/test/io/openems/backend/b2bwebsocket/B2bWebsocketTest.java" class="bare">https://github.com/OpenEMS/openems/blob/develop/io.openems.backend.b2bwebsocket/test/io/openems/backend/b2bwebsocket/B2bWebsocketTest.java</a>:  <code>testGetEdgesChannelsValuesRequest()</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_subscribetochannels"><a class="anchor" href="#_subscribetochannels"></a>6.2.3.3. SubscribeToChannels</h5>
<div class="paragraph">
<p>Registers a subscription for regular updates of channel values. Request is acknowledged by an empty success Response and followed by regular JSON-RPC Notifications. Du stop the subscription, an empty 'subscribeEdgesChannels' Request needs to be sent.</p>
</div>
<div class="paragraph">
<p>The parameter "count" must be increased with each new Request. Only the Request with the highest "count" value is active.</p>
</div>
<div class="sect5">
<h6 id="_request_3"><a class="anchor" href="#_request_3"></a>Request</h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc":"2.0",
  "id":"UUID",
  "method":"subscribeEdgesChannels",
  "params":{
    "count": 0
    "ids":[
      "edge0",
      "edge1"
    ],
    "channels":[
      "_sum/EssSoc",
      "_sum/ProductionActivePower"
    ]
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_response_3"><a class="anchor" href="#_response_3"></a>Response</h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc":"2.0",
  "id":"UUID",
  "result":{}
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_notifications"><a class="anchor" href="#_notifications"></a>Notifications</h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc":"2.0",
  "method":"edgesCurrentData",
  "params":{
    "edge0":{
      "_sum/EssSoc":50,
      "_sum/ProductionActivePower":1502
    },
    "edge1":{
      "_sum/EssSoc":20,
      "_sum/ProductionActivePower":null
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_unsubscribe_request"><a class="anchor" href="#_unsubscribe_request"></a>Unsubscribe-Request</h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc":"2.0",
  "id":"UUID",
  "method":"subscribeEdgesChannels",
  "params":{
    "ids":[],
    "channels":[]
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_demo_3"><a class="anchor" href="#_demo_3"></a>Demo</h6>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.backend.b2bwebsocket/test/io/openems/backend/b2bwebsocket/B2bWebsocketTest.java" class="bare">https://github.com/OpenEMS/openems/blob/develop/io.openems.backend.b2bwebsocket/test/io/openems/backend/b2bwebsocket/B2bWebsocketTest.java</a>:  <code>testSubscribeEdgesChannelsRequest()</code></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_setgridconnschedule"><a class="anchor" href="#_setgridconnschedule"></a>6.2.3.4. SetGridConnSchedule</h5>
<div class="paragraph">
<p>Each battery storage system in an Edge-Device can be controlled to balance on a specific value at the grid connection point. This Request allows sending such a Schedule to an Edge-Device.</p>
</div>
<div class="sect5">
<h6 id="_request_4"><a class="anchor" href="#_request_4"></a>Request</h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc":"2.0",
  "id":"UUID",
  "method":"setGridConnSchedule",
  "params":{
    "id":"edgeId",
    "schedule":[
      {
        "startTimestamp":1542464697,
        "duration":900,
        "activePowerSetPoint":0
      }
    ]
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_response_4"><a class="anchor" href="#_response_4"></a>Response</h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc":"2.0",
  "id":"UUID",
  "result":{}
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_demo_4"><a class="anchor" href="#_demo_4"></a>Demo</h6>
<div class="paragraph">
<p><a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.backend.b2bwebsocket/test/io/openems/backend/b2bwebsocket/B2bWebsocketTest.java" class="bare">https://github.com/OpenEMS/openems/blob/develop/io.openems.backend.b2bwebsocket/test/io/openems/backend/b2bwebsocket/B2bWebsocketTest.java</a>:  <code>testSubscribeEdgesChannelsRequest()</code></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_build_openems_backend"><a class="anchor" href="#_build_openems_backend"></a>6.3. Build OpenEMS Backend</h3>
<div class="paragraph">
<p>This chapter explains, how OpenEMS Edge can be compiled to a JAR file that can be executed outside of an IDE.</p>
</div>
<div class="sect3">
<h4 id="_build_using_eclipse_ide_2"><a class="anchor" href="#_build_using_eclipse_ide_2"></a>6.3.1. Build using Eclipse IDE</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Inside Eclipse IDE open the <strong>io.openems.backend.application</strong> project and open the <a href="https://github.com/OpenEMS/openems/blob/develop/io.openems.backend.application/BackendApp.bndrun">BackendApp.bndrun <span class="icon"><i class="fa fa-code"></i></span></a> file.</p>
</li>
<li>
<p>Press <b class="button">Export</b> to start the <strong>Export Wizard Selection</strong> assistant.</p>
</li>
<li>
<p>Select <b class="button">Executable JAR</b> and press <b class="button">Next &gt;</b>.</p>
</li>
<li>
<p>Select a <strong>Destination</strong> for <strong>Export to JAR</strong>.</p>
</li>
<li>
<p>Press <b class="button">Finish</b></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This creates a so called Fat-JAR-file including all bundles. It can be executed by running <code>java -jar openems-backend.jar</code> in a console.</p>
</div>
</div>
<div class="sect3">
<h4 id="_build_using_gradle_from_command_line_2"><a class="anchor" href="#_build_using_gradle_from_command_line_2"></a>6.3.2. Build using Gradle from command line</h4>
<div class="paragraph">
<p><a href="https://gradle.org/">Gradle</a> is a build tool that is used in the OpenEMS project to compile the JAR-files and to execute other tasks like building the documentation webpage using <a href="https://antora.org/">Antora</a> and the Javadocs. To build OpenEMS Backend:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open a console and change to your repository directory.</p>
</li>
<li>
<p>Execute <code>gradlew buildBackend</code></p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deploy_openems_backend"><a class="anchor" href="#_deploy_openems_backend"></a>6.4. Deploy OpenEMS Backend</h3>
<div class="paragraph">
<p>This chapter explains how OpenEMS Backend can be deployed on a Debian Linux server. Similar techniques will work for other operating systems as well.</p>
</div>
<div class="sect3">
<h4 id="_prepare_operating_system_environment_2"><a class="anchor" href="#_prepare_operating_system_environment_2"></a>6.4.1. Prepare operating system environment</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It is recommended to run every service on a server with limited permissions. This example runs OpenEMS Backend with user "root" which is a bad idea for a production server!
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_create_an_application_directory_2"><a class="anchor" href="#_create_an_application_directory_2"></a>6.4.1.1. Create an application directory</h5>
<div class="paragraph">
<p>Create the directory <strong>/opt/openems-backend</strong>. This is going to be the place, where we put the JAR file.</p>
</div>
<div class="paragraph">
<p>Execute <code>mkdir /opt/openems-backend</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_create_a_config_directory_2"><a class="anchor" href="#_create_a_config_directory_2"></a>6.4.1.2. Create a config directory</h5>
<div class="paragraph">
<p>Create the directory <strong>/opt/openems-backend/config.d</strong>. This is going to be the place, where all the bundle configurations are held.</p>
</div>
<div class="paragraph">
<p>Execute <code>mkdir /opt/openems-backend/config.d</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_create_a_systemd_service_definition_2"><a class="anchor" href="#_create_a_systemd_service_definition_2"></a>6.4.1.3. Create a systemd service definition</h5>
<div class="paragraph">
<p>The systemd 'Service Manager' manages system processes in a Debian Linux. We will create a systemd service definition file, so that systemd takes care of managing (starting/restarting/&#8230;&#8203;) the OpenEMS Backend service.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create and open the service definition file.</p>
<div class="paragraph">
<p>Execute <code>nano /etc/systemd/system/openems-backend.service</code></p>
</div>
</li>
<li>
<p>Paste the following content:</p>
<div class="listingblock">
<div class="content">
<pre>[Unit]
Description=OpenEMS <i class="conum" data-value="1"></i><b>(1)</b>
After=network.target <i class="conum" data-value="2"></i><b>(2)</b>

[Service]
User=root <i class="conum" data-value="3"></i><b>(3)</b>
Group=root
Type=simple <i class="conum" data-value="4"></i><b>(4)</b>
WorkingDirectory=/opt/openems-backend
ExecStart=/usr/bin/java -XX:+ExitOnOutOfMemoryError -Dfelix.cm.dir=/opt/openems-backend/config.d -Djava.util.concurrent.ForkJoinPool.common.parallelism=100 -jar /opt/openems-backend/openems-backend.jar <i class="conum" data-value="5"></i><b>(5)</b>
SuccessExitStatus=143 <i class="conum" data-value="6"></i><b>(6)</b>
Restart=always <i class="conum" data-value="7"></i><b>(7)</b>
RestartSec=10 <i class="conum" data-value="8"></i><b>(8)</b>

[Install]
WantedBy=multi-user.target</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The name of the service.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The service is allowed to start after network is available (e.g. to be able to access devices via ethernet connection)</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>It is run as user 'root' to have access to all devices. It is recommended to change this for productive systems.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>OpenEMS Backend uses a "simple" process fork.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The start command. It uses the Java JRE, sets the config directory to <code>/opt/openems-backend/config.d</code>, sets a parallelism value for ForkJoinPool - this depends on the number of OpenEMS Edge devices you expect to connect - and runs the jar file at <code>/opt/openems-backend/openems-backend.jar</code></td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>In contrast to what systemd expects, Java exits with status 143 on success.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Systemd <em>always</em> tries to restart OpenEMS Backend once it was quit.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Systemd waits <em>10</em> seconds till the next restart.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Press <b class="button">Ctrl</b> + <b class="button">x</b> to exit and <b class="button">y</b> to save the file.</p>
</li>
<li>
<p>Activate the service definition:</p>
<div class="paragraph">
<p>Execute <code>systemctl daemon-reload</code></p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_start_openems_backend"><a class="anchor" href="#_start_openems_backend"></a>6.4.1.4. Start OpenEMS Backend</h5>
<div class="paragraph">
<p>To update the OpenEMS JAR file at the target device, it is required to copy the JAR file from your build directory to <code>/opt/openems-backend/openems-backend.jar</code> on the server. Afterwards it is required to restart the systemd service</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>(Re)start OpenEMS systemd service.</p>
<div class="paragraph">
<p>Execute <code>systemctl restart openems-backend --no-block; journalctl -lfu openems-backend</code></p>
</div>
<div class="paragraph">
<p>The command restarts the service (<em>systemctl restart openems-backend</em>) while not waiting for the OpenEMS startup notification (<em>--no-block</em>). Then it directly prints the OpenEMS system log (<em>journalctl -lfu openems-backend</em>).</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_internal_component_communication"><a class="anchor" href="#_internal_component_communication"></a>7. Internal Component Communication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This page describes the internal communication protocol between OpenEMS Edge, OpenEMS Backend and OpenEMS UI. The components keep an open <a href="https://de.wikipedia.org/wiki/WebSocket">Websocket</a> connection which is used for bi-directional communication.</p>
</div>
<div class="sect2">
<h3 id="_json_rpc_introduction"><a class="anchor" href="#_json_rpc_introduction"></a>7.1. JSON-RPC introduction</h3>
<div class="paragraph">
<p>The protocol is based on <a href="https://www.jsonrpc.org/specification">JSON-RPC</a>. For details about JSON-RPC please refer to the specification. As a rough summary, the protocol is divided into</p>
</div>
<div class="sect3">
<h4 id="_json_rpc_request"><a class="anchor" href="#_json_rpc_request"></a>7.1.1. JSON-RPC Request</h4>
<div class="paragraph">
<p>Identified by a unique ID and method name with specific params. Expects a Response.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc": "2.0",
  "id": UUID,
  "method": "method",
  "params": {}
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_json_rpc_success_response"><a class="anchor" href="#_json_rpc_success_response"></a>7.1.2. JSON-RPC Success Response</h4>
<div class="paragraph">
<p>Referring to the ID of the Request, providing a result which can be empty or hold specific data.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc": "2.0",
  "id": UUID,
  "result": {}
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_json_rpc_error_response"><a class="anchor" href="#_json_rpc_error_response"></a>7.1.3. JSON-RPC Error Response</h4>
<div class="paragraph">
<p>Referring to the ID of the Request, providing error code, message and optionally data.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc": "2.0",
  "id": UUID,
  "result": {
    "code": number,
    "message": string,
    "data"?: {}
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_json_rpc_notification"><a class="anchor" href="#_json_rpc_notification"></a>7.1.4. JSON-RPC Notification</h4>
<div class="paragraph">
<p>Identified by a unique method name with specific params. Does not expect a Response.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc": "2.0",
  "method": "method",
  "params": {}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_example_communication_messages"><a class="anchor" href="#_example_communication_messages"></a>7.2. Example communication messages</h3>
<div class="paragraph">
<p>The information on this page is useful to understand the internal communication structure and can help if your plan is to replace one component by a custom implementation, e.g. implementing your own frontend application, or if you plan to extend the provided feature-set.</p>
</div>
<div class="sect3">
<h4 id="_subscribe_channels"><a class="anchor" href="#_subscribe_channels"></a>7.2.1. Subscribe Channels</h4>
<div class="paragraph">
<p>Real-time channel data may change at a high rate. Instead of requiring the consumer to constantly pull the data, the OpenEMS API provides a publish-subscribe schema that notifies the consumer about updated values. It is initiated via a JSON-RPC request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc": "2.0",
  "id": UUID,
  "method": "subscribeChannels",
  "params": {
    "count": number,
    "channels": string[]
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The parameters for subscribing to channel data are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>count</code>: a request count value that needs to be increased on each request to avoid concurrency problems</p>
</li>
<li>
<p><code>channels</code>: a list of channel addresses as strings, e.g. "ess0/Soc", "ess0/ActivePower"</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>From then on, the API constantly keeps sending <code>currentData</code> JSON-RPC notifications, containing the data for all subscribed channels:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc": "2.0",
  "method": "currentData",
  "params": {
    [channelAddress]: string | number
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To unsubscribe from channels, a new <code>subscribeChannels</code> request has to be sent with an empty list of channels.</p>
</div>
</div>
<div class="sect3">
<h4 id="_edge_rpc"><a class="anchor" href="#_edge_rpc"></a>7.2.2. Edge-RPC</h4>
<div class="paragraph">
<p>When using the API via OpenEMS Backend, it is possible to transparently target a specific OpenEMS Edge, that is connected to the Backend by wrapping the JSON-RPC request into an <code>Edge-RPC</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc": "2.0",
  "id": UUID,
  "method": "edgeRpc",
  "params": {
    "edgeId": string,
    "payload": JSON-RPC-Request
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The parameters for an “edgeRpc” request are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>edgeId</code>: the unique ID of the Edge at the Backend</p>
</li>
<li>
<p><code>payload</code>: the JSON-RPC Request that should be forwarded to the Edge, e.g. <code>getEdgeConfig</code> or <code>updateComponentConfig</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The JSON-RPC response then also wraps the original result as a payload:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc": "2.0",
  "id": UUID,
  "result": {
    "payload": JSON-RPC-Response
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_jsonapi_component"><a class="anchor" href="#_jsonapi_component"></a>7.2.3. JsonApi Component</h4>
<div class="paragraph">
<p>To directly send a JSON-RPC request to one specific OpenEMS Component, that component has to implement the <code>JsonApi</code> interface.
Then the <code>componentJsonApi</code> request can be used to wrap a JSON-RPC request as payload:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc": "2.0",
  "id": "UUID",
  "method": "componentJsonApi",
  "params": {
    "componentId": string,
    "payload": JSON-RPC-Request
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_edge_config_2"><a class="anchor" href="#_edge_config_2"></a>7.2.4. Edge-Config</h4>
<div class="paragraph">
<p>The EdgeConfig may be retrieved using the following JSON-RPC method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "jsonrpc": "2.0",
  "id": "UUID",
  "method": "getEdgeConfig",
  "params": {}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="edge/configuration.html" class="page">Edge &#8594; Configuration</a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_communication_schema"><a class="anchor" href="#_communication_schema"></a>7.3. Communication schema</h3>
<div class="sect3">
<h4 id="_authenticate_ui_to_edgebackend_using_token"><a class="anchor" href="#_authenticate_ui_to_edgebackend_using_token"></a>7.3.1. Authenticate UI to Edge/Backend using token</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
On opening of the websocket connection to Edge/Backend, the UI is authenticated using an existing token.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/authenticateWithSessionId.png" alt="authenticateWithSessionId">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_authenticate_ui_to_edge_using_password"><a class="anchor" href="#_authenticate_ui_to_edge_using_password"></a>7.3.2. Authenticate UI to Edge using password</h4>
<div class="imageblock">
<div class="content">
<img src="_images/authenticateWithPassword.png" alt="authenticateWithPassword">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_subscribe_to_channels"><a class="anchor" href="#_subscribe_to_channels"></a>7.3.3. Subscribe to Channels</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Allows a Component to subscribe on certain Channel values. The latest Channel values are then periodically sent.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/subscribeChannels+currentData.png" alt="subscribeChannels+currentData"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_subscribe_to_system_log"><a class="anchor" href="#_subscribe_to_system_log"></a>7.3.4. Subscribe to System-Log</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Sends the log output of Edge to UI via Backend.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/subscribeSystemLog.png" alt="subscribeSystemLog"></span></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_real_time_simulation"><a class="anchor" href="#_real_time_simulation"></a>8. Real-Time Simulation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OpenEMS provides several virtual devices for testing and development. To set up the simulation-environment follow the setup guide in <a href="gettingstarted.html" class="page">Getting Started</a>. The Apache Felix Web Console Configuration lists all OpenEMS component, but those which rely on external hardware can&#8217;t be used for simulation. These are replaced by more generic components tagged with the "Simulator" prefix. Still, not all non-simulator devices rely on real hardware. Other components used in production, like Loggers, Controllers and Schedulers can be combined with the virtual devices to build a "living" system.</p>
</div>
<div class="sect2">
<h3 id="_types_of_simulated_components"><a class="anchor" href="#_types_of_simulated_components"></a>Types of Simulated Components</h3>
<div class="ulist">
<ul>
<li>
<p><strong>DataSource</strong>: A data-source generates lists of data and provides them as a channel to other components. The data can be generated by different means, which could be an augmented random-generator or a reader for a specific data-format like the "Simulator Datasource: CSV Reader".</p>
</li>
<li>
<p><strong>Devices</strong>: Devices replace a hardware-component like a meter or an ess. There are two kinds of devices:</p>
<div class="ulist">
<ul>
<li>
<p><strong>acting</strong>: These devices act on their own. Their actions do not depend on other device&#8217;s actions, but on data-sources.</p>
</li>
<li>
<p><strong>reacting</strong>: These devices analyse other device&#8217;s channels/properties to deduce their own behavior.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_simulator_components"><a class="anchor" href="#_simulator_components"></a>Simulator Components</h3>
<div class="ulist">
<ul>
<li>
<p><code>Simulator DataSource: CSV Reader</code>: Reads .csv files and provides their content according to the <code>io.openems.edge.simulator.datasource.api.SimulatorDatasource</code> interface. Its package contains several sample csv-files for different devices and situations.</p>
</li>
<li>
<p><code>Simulator EssSymmetric Reacting</code>: Simulates the State of Charge of a ess device. Its behavior depends on configured controllers.</p>
</li>
<li>
<p><code>Simulator GridMeter Acting</code>: Intended to represent grid consumption/production. Portrays a datasource' values. It requests those tagged with the "ActivePower" key. The values are portrayed in the <code>SimulatedActivePower</code>, <code>ActivePower</code> and - divided by three - in the <code>ActivePowerL1</code>, <code>ActivePowerL2</code> and <code>ActivePowerL3</code> channels.</p>
</li>
<li>
<p><code>Simulator ProductionMeter Acting</code>: Intended to represent fixed production like photovoltaic arrays. To date the functionality equals the one of <code>Simulator GridMeter Acting</code>.</p>
</li>
<li>
<p><code>Simulator NRCMeter Acting</code>: Intended to represent non-regulated-consumption. To date the functionality equals the one of <code>Simulator GridMeter Acting</code>.</p>
</li>
<li>
<p><code>Simulator GridMeter Reacting</code>: Intended to represent grid consumption/production. Takes all meters (but grid-meters) and esss, sums up their ActivePowers and divides this value by the number of grid-meters in the system. The negative of this result is then portrayed in the <code>SimulatedActivePower</code>, <code>ActivePower</code> and - divided by three - in the <code>ActivePowerL1</code>, <code>ActivePowerL2</code> and <code>ActivePowerL3</code> channels. This equals the physical reaction of the real grid.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_possible_combinations"><a class="anchor" href="#_possible_combinations"></a>Possible Combinations</h3>
<div class="paragraph">
<p>In reality the OpenEMS can not measure the non-regulated-consumers, as they are spread all over the building. However, it can measure the power at the mains connection, which can be used to calculate the non-regulated-consumption. This approach can be simulated using the <code>Simulator GridMeter Acting</code> combined with a <code>Simulator EssSymmetric Reacting</code>.</p>
</div>
<div class="paragraph">
<p>For intelligent systems going beyond real-time-regulation, however, having a - even in production - virtual meter measuring the non-regulated-consumers can be a major advantage. In order to test algorithms depending on such an environment, the simulator provides the <code>Simulator ProductionMeter Acting</code>, the <code>Simulator NRCMeter Acting</code> and the <code>Simulator GridMeter Reacting</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ui_history_simulation"><a class="anchor" href="#_ui_history_simulation"></a>UI History Simulation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sometimes it can be useful to mock historic data in OpenEMS UI in order to take consistent screenshots or to visualize how a certain Controller would have behaved during a day.</p>
</div>
<div class="paragraph">
<p>Prepare the mock for the historic view:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>first copy the example <a href="https://github.com/OpenEMS/openems/tree/develop/io.openems.edge.simulator/src/io/openems/edge/simulator/timedata/timedata.csv">CSV file <span class="icon"><i class="fa fa-github"></i></span></a> to your home directory, e.g. <code>C:\Users\username\</code> on windows.</p>
</li>
<li>
<p>adjust the file to mock all required channel values.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The CSV file is read on every data query by the UI. So in order to update the values, just save the CSV file and click again on 'Today' or 'Yesterday' in the history view to refresh.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To provide data for one day, that file should have 288 lines with values.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/ui-mock-csv.png" alt="The mocked data in the CSV file">
</div>
<div class="title">Figure 58. The mocked data in the CSV file</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>OpenEMS UI creates charts dynamically according to which OpenEMS Components are enabled. To mock the historic view, it is required to activate OpenEMS Component via Apache Felix (see <a href="gettingstarted.html" class="page">Getting Started</a>) or directly in the UI OpenEMS Settings screen.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>configure the OpenEMS Components that should be simulated, e.g. a meter, PV inverter,&#8230;&#8203;</p>
</li>
<li>
<p>configure the <code>Simulator Timedata</code> service.</p>
</li>
<li>
<p>open the OpenEMS UI (see <a href="gettingstarted.html" class="page">Getting Started</a>), login and open the 'History' view. You should be presented the mocked data.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/ui-mock-history.png" alt="The mocked data in the UI 'History' view">
</div>
<div class="title">Figure 59. The mocked data in the UI 'History' view</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_documentation"><a class="anchor" href="#_documentation"></a>Documentation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_concept"><a class="anchor" href="#_concept"></a>10.1. Concept</h3>
<div class="paragraph">
<p>The OpenEMS Documentation is built with <a href="https://antora.org/">Antora <span class="icon"><i class="fa fa-external-link"></i></span></a>.</p>
</div>
<div class="paragraph">
<p>OpenEMS <a href="https://github.com/OpenEMS/openems">Files <span class="icon"><i class="fa fa-external-link"></i></span></a> and <a href="https://github.com/OpenEMS/openems.io">Documentation <span class="icon"><i class="fa fa-external-link"></i></span></a> are separated on two different repositories.</p>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/OpenEMS/openems/blob/develop/doc/build/uibundle_openems.zip?raw=true">UI <span class="icon"><i class="fa fa-external-link"></i></span></a> was slightly modified to fit our needs.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For more Information regarding <a href="https://asciidoctor.org/docs/asciidoc-writers-guide/">AsciiDoc <span class="icon"><i class="fa fa-external-link"></i></span></a> and <a href="https://docs.antora.org/antora/1.1/">Antora <span class="icon"><i class="fa fa-external-link"></i></span></a> see their Docs.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_edit_a_page"><a class="anchor" href="#_edit_a_page"></a>10.2. Edit a page</h3>
<div class="paragraph">
<p>If you want to edit a Docs - Page just click on 'Edit this Page' in the upper right corner to edit the page you are currently visiting.</p>
</div>
<div class="paragraph">
<p>Edit the Page according to your ideas and commit your changes.</p>
</div>
<div class="paragraph">
<p>You will see the changes you have made after our frequent Docs - Update.</p>
</div>
</div>
<div class="sect2">
<h3 id="_add_a_page"><a class="anchor" href="#_add_a_page"></a>10.3. Add a page</h3>
<div class="paragraph">
<p>To add a page, clone the OpenEMS Repository (preferably <a href="gettingstarted.html#_download_the_source_code" class="page">Source Tree</a>) and open it with a Code Editor (preferably <a href="gettingstarted.html#_setup_visual_studio_code_for_openems_ui" class="page">Visual Studio Code</a>).</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to <a href="https://github.com/OpenEMS/openems/tree/develop/doc/modules/ROOT/pages">doc/modules/ROOT/pages <span class="icon"><i class="fa fa-external-link"></i></span></a> and create a .adoc file with the desired name.</p>
</li>
<li>
<p>Go to <a href="https://github.com/OpenEMS/openems/blob/develop/doc/modules/ROOT/nav.adoc">doc/modules/ROOT/nav.adoc <span class="icon"><i class="fa fa-external-link"></i></span></a> and add your page with the correct filename to the nav file.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_build_docs"><a class="anchor" href="#_build_docs"></a>10.4. Build Docs</h3>
<div class="paragraph">
<p>To build the docs, clone the OpenEMS Repository (preferably <a href="gettingstarted.html#_download_the_source_code" class="page">Source Tree</a>) and open it with a Code Editor (preferably <a href="gettingstarted.html#_setup_visual_studio_code_for_openems_ui" class="page">Visual Studio Code</a>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>NodeJS has to be installed</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Build the documents:</div>
<p>Open the integrated terminal, change to the <a href="https://github.com/OpenEMS/openems/tree/develop/">root directory <span class="icon"><i class="fa fa-external-link"></i></span></a> and type</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><code>gradlew buildAntoraDocs</code></p>
</div>
</div>
</div>
<div class="paragraph">
<p>Docs should be building.. the finished HTML Folder can be found in your local 'build' folder (inside your <a href="https://github.com/OpenEMS/openems/tree/develop/doc/build">repository build folder <span class="icon"><i class="fa fa-external-link"></i></span></a>)</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you want to build your own docs with Antora see <a href="https://fabianfnc.github.io/bocs/">this guide <span class="icon"><i class="fa fa-external-link"></i></span></a>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_research_and_development"><a class="anchor" href="#_research_and_development"></a>11. Research and Development</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_easy_res"><a class="anchor" href="#_easy_res"></a>EASY-RES</h3>
<div class="sect3">
<h4 id="_enable_ancillary_services_by_renewable_energy_sources"><a class="anchor" href="#_enable_ancillary_services_by_renewable_energy_sources"></a>Enable Ancillary Services by Renewable Energy Sources</h4>
<div class="imageblock">
<div class="content">
<img src="_images/ezrs.png" alt="EASY-RES">
</div>
</div>
<div class="paragraph">
<p>Im Rahmen des EASY-RES-Projekts soll erforscht werden, wie die Versorgungssicherheit mit elektrischer Energie erhalten werden kann, während sich die Energieerzeugung von konventionellen Kraftwerken hin zu 100 % erneuerbaren Energien wendet. Dieser Wandel wird auch große Auswirkungen auf die Umwelt haben und zur Lösung der globalen Herausforderungen im Bereich Klima und Energie beitragen.</p>
</div>
<div class="paragraph">
<p>Am EASY-RES-Projekt beteiligen sich ausgewählte Partner aus sechs EU-Ländern. Zum Konsortium zählen neben FENECON fünf Universitäten (<a href="https://www.uni-passau.de/">Passau <span class="icon"><i class="fa fa-external-link"></i></span></a>
, <a href="https://www.auth.gr/en">Thessaloniki <span class="icon"><i class="fa fa-external-link"></i></span></a>, <a href="http://www.us.es/eng">Sevilla <span class="icon"><i class="fa fa-external-link"></i></span></a>, <a href="https://www.tudelft.nl/">Delft <span class="icon"><i class="fa fa-external-link"></i></span></a> und <a href="https://www.lancaster.ac.uk/">Lancaster <span class="icon"><i class="fa fa-external-link"></i></span></a>), drei Energieversorger (<a href="https://www.swlandau.de/">Stadtwerke Landau a. d. Isar <span class="icon"><i class="fa fa-external-link"></i></span></a>, <a href="http://www.stadtwerkhassfurt.de/">Stadtwerk Haßfurt <span class="icon"><i class="fa fa-external-link"></i></span></a> und <a href="https://www.elektro-gorenjska.si/">Elektro Gorenjska <span class="icon"><i class="fa fa-external-link"></i></span></a> aus der Slowakei), der <a href="http://www.admie.gr/nc/en/home/">Netzbetreiber ADMIE <span class="icon"><i class="fa fa-external-link"></i></span></a> aus Griechenland und das <a href="https://zentrum-digitalisierung.bayern/">Zentrum Digitalisierung.Bayern <span class="icon"><i class="fa fa-external-link"></i></span></a>.</p>
</div>
<div class="paragraph">
<p>FENECON wird technisches Fachwissen über das Batterieverhalten unter stationären und transienten Bedingungen sowie zu den Regelungsalgorithmen beitragen. Darüber hinaus werden wir uns an der Entwicklung von neuen Systemdienstleistungen durch Speichersysteme beteiligen und die erforderlichen Speichergeräte in den Labortests bereitstellen. Als Basis für das Energiemanagement dient das von FENECON initiierte Open Source Energiemanagement <a href="https://openems.io">OpenEMS <span class="icon"><i class="fa fa-external-link"></i></span></a>, das im Rahmen des Projektes weiterentwickelt wird.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Mehr Informationen: <a href="http://www.easyres-project.eu/" class="bare">http://www.easyres-project.eu/</a>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_emsig"><a class="anchor" href="#_emsig"></a>EMSIG</h3>
<div class="sect3">
<h4 id="_energiemanagementsystem_für_integrierte_geschäftsmodelle"><a class="anchor" href="#_energiemanagementsystem_für_integrierte_geschäftsmodelle"></a>Energiemanagementsystem für integrierte Geschäftsmodelle</h4>
<div class="imageblock">
<div class="content">
<img src="_images/emsig.png" alt="EMSIG">
</div>
</div>
<div class="paragraph">
<p>Verteilte Stromspeichersysteme können einen großen Beitrag zur Energiewende leisten. Die derzeit verwendeten Betriebsweisen bieten aber meist nur naive Strategien, die ausschließlich die momentane Situation hinter dem Stromzähler berücksichtigen.</p>
</div>
<div class="paragraph">
<p>Ziel des Projektes ist es, durch integrierte Geschäftsmodelle das große Potential von Speichern sowohl für den Endnutzer als auch den Verteilnetzbetreiber (VNB) zu erschließen. Dazu werden innovative Be- und Entladealgorithmen entwickelt, die die Eigennnutzung von Solarenergie und die Steuerung variabler Lasten optimieren.</p>
</div>
<div class="paragraph">
<p>Durch "Pooling" der verteilten Speicherflexibilität wird außerdem die Teilnahme am Energiemarkt ermöglicht. Zudem wird eine Open-Data-Plattform für anonymisierte Energiedaten erstellt, um diese für Forschungszwecke öffentlich zugänglich zu machen. Basis des Projektes ist das Open-Source Energiemanagementsystem <a href="https://openems.io">OpenEMS <span class="icon"><i class="fa fa-external-link"></i></span></a>, das im Rahmen des Projektes weiterentwickelt wird.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_blogpv"><a class="anchor" href="#_blogpv"></a>BloGPV</h3>
<div class="sect3">
<h4 id="_blockchainbasierter_verteiter_großspeicher_für_pv_anlagenbetreiber"><a class="anchor" href="#_blockchainbasierter_verteiter_großspeicher_für_pv_anlagenbetreiber"></a>Blockchainbasierter, verteiter Großspeicher für PV-Anlagenbetreiber</h4>
<div class="imageblock">
<div class="content">
<img src="_images/blogpv.png" alt="BlogPV">
</div>
</div>
<div class="paragraph">
<p>BloGPV hat sich zum Ziel gesetzt einen wirtschaftlichen Betrieb von Photovoltaikanlagen in einer Post-EEG Situation zu ermöglichen. Als Teil der Smart Service Welt II sollen viele dezentrale Batteriespeicher durch die Blockchain-Technologie zu einem virtuellen Großspeicher vereint werden.</p>
</div>
<div class="paragraph">
<p>Ein dezentrales Speichermanagement mit der Anbindung von Mehrwertdiensten sowie der Schaffung geeigneter Bilanzierungs- und Abrechnungsmodelle soll ein einen wirtschaftlichen Betrieb der PV-Anlagen ohne Einspeisevergütung zu ermöglichen und somit einen wesentlichen Beitrag zur Energiewende leisten.</p>
</div>
<div class="paragraph">
<p>Fenecon arbeitet hierzu mit den Projektpartnern <a href="https://www.dfki.de/web/">Deutsches Forschungszentrum für künstliche Intelligenz <span class="icon"><i class="fa fa-external-link"></i></span></a>, <a href="https://discovergy.com/">Discovergy <span class="icon"><i class="fa fa-external-link"></i></span></a>, <a href="https://www.enercity.de/privatkunden/index.html">enercity <span class="icon"><i class="fa fa-external-link"></i></span></a> und der <a href="https://www.tu-berlin.de/menue/home/">TU Berlin <span class="icon"><i class="fa fa-external-link"></i></span></a> zusammen.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Mehr Informationen: <a href="https://blogpv.net/" class="bare">https://blogpv.net/</a>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_memap"><a class="anchor" href="#_memap"></a>MEMAP</h3>
<div class="sect3">
<h4 id="_multi_energie_management_und_aggregations_plattform"><a class="anchor" href="#_multi_energie_management_und_aggregations_plattform"></a>Multi-Energie Management und Aggregations-Plattform</h4>
<div class="imageblock">
<div class="content">
<img src="_images/BMWi_Fz_2017_Office_Farbe_de.png" alt="MEMAP">
</div>
</div>
<div class="paragraph">
<p>Das Kernziel des MEMAP-Projekts ist die Entwicklung und Erprobung einer offenen Aggregationsplattform. Die Plattform soll mehrere Gebäude bzw. deren lokale EMS zusammenschließen, um Synergieeffekte der verschiedenen Bedarfs- und Produktionsprofile auszunutzen. Benutzer sollen mit Hilfe von intuitiven Benutzeroberflächen in diesen Prozess eingebunden werden. Ein Simulationsframework zum Testen der Plattform soll erweitert werden, um den komplexen Planungsprozess zu unterstützen. Das MEMAP Projekt setzt dabei auf den Einsatz des etablierten Building Information Model (BIM) Standards.</p>
</div>
<div class="paragraph">
<p>Am <a href="https://memap-projekt.de">MEMAP Projekt <span class="icon"><i class="fa fa-external-link"></i></span></a> sind neben der FENECON die Firmen <a href="https://holsten.io/">Holsten Systems GmbH <span class="icon"><i class="fa fa-external-link"></i></span></a>, <a href="https://www.sauter-cumulus.de/">Sauter-Cumulus GmbH  <span class="icon"><i class="fa fa-external-link"></i></span></a> , <a href="https://www.ibdm.de/">IBDM GmbH <span class="icon"><i class="fa fa-external-link"></i></span></a> sowie die Forschungseinrichtungen  <a href="https://www.mse.tum.de/en/tumenergy-research-projects/">TUM MSE Energy Efficient and Smart Cities <span class="icon"><i class="fa fa-external-link"></i></span></a> und das <a href="https://zentrum-digitalisierung.bayern/">Zentrum Digitalisierung.Bayern <span class="icon"><i class="fa fa-external-link"></i></span></a> beteiligt.</p>
</div>
<div class="paragraph">
<p>FENECON bringt Erfahrungen im Bereich Projektentwicklung und –realisierung sowie Virtuelle Kraftwerke ein. FENECON beteiligt sich bei der Erarbeitung der Anforderung, Entwicklung und Bewertung von Geschäftsmodellen, der Systemanalyse und der Entwicklung der Softwareplattform.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Mehr Informationen: <a href="http://memap.fortiss.org" class="bare">http://memap.fortiss.org</a>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</article>
  </main>
</div>
<script src="../../_/js/site.js"></script>
<script src="../../_/js/vendor/highlight.js"></script>
<script>hljs.initHighlighting()</script>
  </body>
</html>
